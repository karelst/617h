///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
Const COLOR_ORANGE 			As Long		:= &HCCe59d2b
Const COLOR_GREYDARK 			As Long		:= &HCC282828
Const COLOR_WHITE 			As Long		:= &HCCffffff
Global GraphicClass LongPressButton Inherits Namespace "CUE.GraphicCollection.GenericObjectsBase.3".BaseLongPressButton WithAttributes {defaultwidth := 120, defaultheight := 80,ObjectCode := "OB0080-001", DesignName := "Multicolor", GroupName := "Buttons"}

	Public Const BUTTON_STYLE_ROUNDED_CORNER		As Long	:= 1	
	Public Const BUTTON_STYLE_SHARP_CORNER			As Long	:= 2
	
	Global Const ICON_ALIGNLEFT As Long := &H00000001	// Horizontal align left
	Global Const ICON_ALIGNHCENTER As Long := &H00000002	// Horizontal align center
	Global Const ICON_ALIGNRIGHT As Long :=	&H00000004	// Horizontal align right
	Global Const ICON_ALIGNTOP As Long := &H00000008	// Vertical align top
	Global Const ICON_ALIGNVCENTER As Long := &H00000010	// Vertical align center
	Global Const ICON_ALIGNBOTTOM As Long := &H00000020	// Vertical align bottom

	// Behavior Property Group
	Protected Property Enabled 							As Boolean := True WithAttributes {PropertyGroup := "Behavior", EditMode := "Boolean; 'Yes' := True, 'No' := False"}
	Protected Property ButtonCorner						As Long := BUTTON_STYLE_ROUNDED_CORNER WithAttributes {PropertyGroup := "Appearance",DisplayName := "ButtonStyle", EditMode:= "Enum; 'Sharp Corner' := BUTTON_STYLE_SHARP_CORNER, 'Rounded Corner' := BUTTON_STYLE_ROUNDED_CORNER"}
	Protected Property LongPressTime 					As Time := :.4 WithAttributes {PropertyGroup := "Behavior",	EditMode := "TimeInterval"}

	Protected Var		ButtonFont						As AddressOf _Font := GetButtonFont(GetPrimaryDisplay().GetWidth(),GetPrimaryDisplay().GetHeight()) 
	Protected Var		RectangleEdge					As Long := 2
	Protected Var		DownButtonColor					As Long 
	Protected Var		UpButtonColor					As Long 
	
	// Up Property Group
	Protected Property UpColor As Long := ColorUp() WithAttributes {PropertyGroup := "Up", EditMode := "color"}		
	
	Protected Var UpColorOpacity As Byte := 204	
	Protected Property UpFont As AddressOf _Font := ButtonFont WithAttributes {PropertyGroup := "Up", EditMode := "font"}
	Protected Property UpFontColor As Long := FontColorUp() WithAttributes {PropertyGroup := "Up", EditMode := "color"}
	Protected Property UpIcon As AddressOf _Picture := Nothing WithAttributes {PropertyGroup := "Up"}
	Protected Property UpIconAlign As Long := ICON_ALIGNHCENTER BitOr ICON_ALIGNVCENTER WithAttributes {PropertyGroup := "Up", EditMode := "ENUM; 'Left-Top' := &H09, 'Left-Middle' := &H11, 'Left-Bottom' := &H21, 'Center-Top' := &H0A, 'Center-Middle' := &H12, 'Center-Bottom' := &H22, 'Right-Top' := &H0C, 'Right-Middle' := &H14, 'Right-Bottom' := &H24"}
	Protected Property UpIconOffsetX As Long := 0 WithAttributes {PropertyGroup := "Up"}
	Protected Property UpIconOffsetY As Long := 0 WithAttributes {PropertyGroup := "Up"}
	Protected Property UpLineSpacing As Double := 1.2 WithAttributes {PropertyGroup := "Up"}
	Protected Property UpText As AddressOf Text := txtCaption WithAttributes {PropertyGroup := "Up"}
	Protected Property UpTextAlign As Long := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNVCENTER WithAttributes {PropertyGroup := "Up", EditMode := "ENUM; 'Left-Top' := _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNTOP, 'Left-Middle' := _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNVCENTER, 'Left-Bottom' := _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNBOTTOM, 'Center-Top' := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNTOP, 'Center-Middle' := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNVCENTER, 'Center-Bottom' := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNBOTTOM, 'Right-Top' := _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNTOP, 'Right-Middle' := _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNVCENTER, 'Right-Bottom' := _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNBOTTOM"}
	Protected Property UpTextOffsetX As Long := 0 WithAttributes {PropertyGroup := "Up"}
	Protected Property UpTextOffsetY As Long := 0 WithAttributes {PropertyGroup := "Up"}

	// Down Property Group
	Protected Property DownColor As Long := ColorDown() WithAttributes {PropertyGroup := "Down", EditMode := "color"}

	Protected Var DownColorOpacity As Byte := UpColorOpacity
	Protected Property DownFont As AddressOf _Font := UpFont WithAttributes {PropertyGroup := "Down", EditMode := "font"}
	Protected Property DownFontColor As Long := _COLOR_BLACK WithAttributes {PropertyGroup := "Down", EditMode := "color"}
	Protected Property DownIcon As AddressOf _Picture := UpIcon WithAttributes {PropertyGroup := "Down"}
	Protected Property DownIconAlign As Long := UpIconAlign WithAttributes {PropertyGroup := "Down", EditMode := "ENUM; 'Left-Top' := &H09, 'Left-Middle' := &H11, 'Left-Bottom' := &H21, 'Center-Top' := &H0A, 'Center-Middle' := &H12, 'Center-Bottom' := &H22, 'Right-Top' := &H0C, 'Right-Middle' := &H14, 'Right-Bottom' := &H24"}
	Protected Property DownIconOffsetX As Long := UpIconOffsetX WithAttributes {PropertyGroup := "Down"}
	Protected Property DownIconOffsetY As Long := UpIconOffsetY WithAttributes {PropertyGroup := "Down"}
	Protected Property DownLineSpacing As Double := UpLineSpacing WithAttributes {PropertyGroup := "Down"}
	Protected Property DownText As AddressOf Text := UpText WithAttributes {PropertyGroup := "Down"}
	Protected Property DownTextAlign As Long := UpTextAlign WithAttributes {PropertyGroup := "Down", EditMode := "ENUM; 'Left-Top' := _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNTOP, 'Left-Middle' := _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNVCENTER, 'Left-Bottom' := _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNBOTTOM, 'Center-Top' := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNTOP, 'Center-Middle' := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNVCENTER, 'Center-Bottom' := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNBOTTOM, 'Right-Top' := _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNTOP, 'Right-Middle' := _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNVCENTER, 'Right-Bottom' := _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNBOTTOM"}
	Protected Property DownTextOffsetX As Long := UpTextOffsetX WithAttributes {PropertyGroup := "Down"}
	Protected Property DownTextOffsetY As Long := UpTextOffsetY WithAttributes {PropertyGroup := "Down"}

	Protected Var		Picture_Active_Up_Centre 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LUp 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RUp 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LDown 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RDown 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineDown 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineUp 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineRight 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineLeft 		As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Down_Centre	 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LUp			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RUp			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LDown		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RDown 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineDown 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineUp		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineRight 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineLeft	As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Up_Centre2 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LUp2 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RUp2 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LDown2 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RDown2 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineDown2 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineUp2 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineRight2 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineLeft2		As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Down_Centre2	 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LUp2		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RUp2		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LDown2		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RDown2 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineDown2 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineUp2		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineRight2 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineLeft2	As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Up_Centre3 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LUp3 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RUp3 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LDown3 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RDown3 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineDown3 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineUp3 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineRight3 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineLeft3		As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Down_Centre3	 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LUp3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RUp3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LDown3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RDown3 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineDown3 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineUp3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineRight3 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineLeft3	As AddressOf _Picture := Nothing

	Protected Var		Picture_Active_Color_Centre3	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LUp3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_RUp3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LDown3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_RDown3 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineDown3 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineUp3	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineRight3 As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineLeft3	As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Up_Centre4 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LUp4 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RUp4 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LDown4 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RDown4 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineDown4 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineUp4 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineRight4 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineLeft4		As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Down_Centre4	 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LUp4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RUp4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LDown4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RDown4 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineDown4 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineUp4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineRight4 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineLeft4	As AddressOf _Picture := Nothing

	Protected Var		Picture_Active_Color_Centre4	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LUp4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_RUp4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LDown4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_RDown4 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineDown4 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineUp4	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineRight4 As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineLeft4	As AddressOf _Picture := Nothing
	
	Protected Var		Up_Centre 		As AddressOf _Picture := Nothing
	Protected Var		Up_LUp 			As AddressOf _Picture := Nothing
	Protected Var		Up_RUp 			As AddressOf _Picture := Nothing
	Protected Var		Up_LDown 		As AddressOf _Picture := Nothing
	Protected Var		Up_RDown 		As AddressOf _Picture := Nothing
	Protected Var		Up_LineDown 	As AddressOf _Picture := Nothing
	Protected Var		Up_LineUp 		As AddressOf _Picture := Nothing
	Protected Var		Up_LineRight 	As AddressOf _Picture := Nothing
	Protected Var		Up_LineLeft 	As AddressOf _Picture := Nothing
	
	Protected Var		Down_Centre	 	As AddressOf _Picture := Nothing
	Protected Var		Down_LUp		As AddressOf _Picture := Nothing
	Protected Var		Down_RUp		As AddressOf _Picture := Nothing
	Protected Var		Down_LDown		As AddressOf _Picture := Nothing
	Protected Var		Down_RDown 		As AddressOf _Picture := Nothing
	Protected Var		Down_LineDown 	As AddressOf _Picture := Nothing
	Protected Var		Down_LineUp		As AddressOf _Picture := Nothing
	Protected Var		Down_LineRight 	As AddressOf _Picture := Nothing
	Protected Var		Down_LineLeft	As AddressOf _Picture := Nothing

	Protected Var		Centre 			As AddressOf _Picture := Nothing
	Protected Var		LUp   			As AddressOf _Picture := Nothing 		
	Protected Var		RUp 			As AddressOf _Picture := Nothing 	 	
	Protected Var		LDown  	 		As AddressOf _Picture := Nothing		
	Protected Var		RDown 	 		As AddressOf _Picture := Nothing		
	Protected Var		LineDown 		As AddressOf _Picture := Nothing	
	Protected Var		LineUp  		As AddressOf _Picture := Nothing 		
	Protected Var		LineRight  		As AddressOf _Picture := Nothing	
	Protected Var		LineLeft 		As AddressOf _Picture := Nothing	
	

	Protected Function InitObject()
		Picture_Active_Up_Centre			:= Nothing
		Picture_Active_Up_LUp 				:= picButton_LeftUp_Corner
		Picture_Active_Up_RUp 				:= picButton_RightUp_Corner
		Picture_Active_Up_LDown 			:= picButton_LeftDown_Corner
		Picture_Active_Up_RDown 			:= picButton_RightDown_Corner
		Picture_Active_Up_LineDown 			:= picButton_Down_Line
		Picture_Active_Up_LineUp 			:= picButton_Up_Line
		Picture_Active_Up_LineRight 		:= picButton_Right_Line
		Picture_Active_Up_LineLeft 			:= picButton_Left_Line
	
		Picture_Active_Down_LUp				:= picButton_LeftUp_Corner
		Picture_Active_Down_RUp				:= picButton_RightUp_Corner
		Picture_Active_Down_LDown			:= picButton_LeftDown_Corner
		Picture_Active_Down_RDown 			:= picButton_RightDown_Corner
		Picture_Active_Down_LineDown 		:= picButton_Down_Line
		Picture_Active_Down_LineUp			:= picButton_Up_Line
		Picture_Active_Down_LineRight 		:= picButton_Right_Line
		Picture_Active_Down_LineLeft		:= picButton_Left_Line
		
		Picture_Active_Up_Centre2			:= Nothing		
		Picture_Active_Up_LUp2 				:= picButton_LeftUp_Corner1
		Picture_Active_Up_RUp2 				:= picButton_RightUp_Corner1
		Picture_Active_Up_LDown2 			:= picButton_LeftDown_Corner1
		Picture_Active_Up_RDown2 			:= picButton_RightDown_Corner1
		Picture_Active_Up_LineDown2 		:= picButton_Down_Line1
		Picture_Active_Up_LineUp2 			:= picButton_Up_Line1
		Picture_Active_Up_LineRight2 		:= picButton_Right_Line1
		Picture_Active_Up_LineLeft2 		:= picButton_Left_Line1
	
		Picture_Active_Down_LUp2			:= picButton_LeftUp_Corner1
		Picture_Active_Down_RUp2			:= picButton_RightUp_Corner1
		Picture_Active_Down_LDown2			:= picButton_LeftDown_Corner1
		Picture_Active_Down_RDown2 			:= picButton_RightDown_Corner1
		Picture_Active_Down_LineDown2 		:= picButton_Down_Line1
		Picture_Active_Down_LineUp2			:= picButton_Up_Line1
		Picture_Active_Down_LineRight2 		:= picButton_Right_Line1
		Picture_Active_Down_LineLeft2		:= picButton_Left_Line1	
		
		Picture_Active_Up_Centre3			:= picButton_Centre3
		Picture_Active_Up_LUp3 				:= picButton_LeftUp_Corner3
		Picture_Active_Up_RUp3 				:= picButton_RightUp_Corner3
		Picture_Active_Up_LDown3 			:= picButton_LeftDown_Corner3
		Picture_Active_Up_RDown3 			:= picButton_RightDown_Corner3
		Picture_Active_Up_LineDown3 		:= picButton_Down_Line3
		Picture_Active_Up_LineUp3 			:= picButton_Up_Line3
		Picture_Active_Up_LineRight3 		:= picButton_Right_Line3
		Picture_Active_Up_LineLeft3 		:= picButton_Left_Line3

		Picture_Active_Down_Centre3			:= picButton_Centre_down3	
		Picture_Active_Down_LUp3			:= picButton_LeftUp_Corner_down3
		Picture_Active_Down_RUp3			:= picButton_RightUp_Corner_down3
		Picture_Active_Down_LDown3			:= picButton_LeftDown_Corner_down3
		Picture_Active_Down_RDown3 			:= picButton_RightDown_Corner_down3
		Picture_Active_Down_LineDown3 		:= picButton_Down_Line_down3
		Picture_Active_Down_LineUp3			:= picButton_Up_Line_down3
		Picture_Active_Down_LineRight3 		:= picButton_Right_Line_down3
		Picture_Active_Down_LineLeft3		:= picButton_Left_Line_down3
		
		Picture_Active_Color_Centre3		:= picButton_Centre_color3
		Picture_Active_Color_LUp3			:= picButton_LeftUp_Corner_color3
		Picture_Active_Color_RUp3			:= picButton_RightUp_Corner_color3
		Picture_Active_Color_LDown3			:= picButton_LeftDown_Corner_color3
		Picture_Active_Color_RDown3 		:= picButton_RightDown_Corner_color3
		Picture_Active_Color_LineDown3 		:= picButton_Down_Line_color3
		Picture_Active_Color_LineUp3		:= picButton_Up_Line_color3
		Picture_Active_Color_LineRight3 	:= picButton_Right_Line_color3
		Picture_Active_Color_LineLeft3		:= picButton_Left_Line_color3
		
		Picture_Active_Up_Centre4			:= picButton_Centre2
		Picture_Active_Up_LUp4 				:= picButton_LeftUp_Corner2
		Picture_Active_Up_RUp4 				:= picButton_RightUp_Corner2
		Picture_Active_Up_LDown4 			:= picButton_LeftDown_Corner2
		Picture_Active_Up_RDown4 			:= picButton_RightDown_Corner2
		Picture_Active_Up_LineDown4 		:= picButton_Down_Line2
		Picture_Active_Up_LineUp4 			:= picButton_Up_Line2
		Picture_Active_Up_LineRight4 		:= picButton_Right_Line2
		Picture_Active_Up_LineLeft4 		:= picButton_Left_Line2

		Picture_Active_Down_Centre4			:= picButton_Centre_down2	
		Picture_Active_Down_LUp4			:= picButton_LeftUp_Corner_down2
		Picture_Active_Down_RUp4			:= picButton_RightUp_Corner_down2
		Picture_Active_Down_LDown4			:= picButton_LeftDown_Corner_down2
		Picture_Active_Down_RDown4 			:= picButton_RightDown_Corner_down2
		Picture_Active_Down_LineDown4 		:= picButton_Down_Line_down2
		Picture_Active_Down_LineUp4			:= picButton_Up_Line_down2
		Picture_Active_Down_LineRight4 		:= picButton_Right_Line_down2
		Picture_Active_Down_LineLeft4		:= picButton_Left_Line_down2
		
		Picture_Active_Color_Centre4		:= picButton_Centre_color2
		Picture_Active_Color_LUp4			:= picButton_LeftUp_Corner_color2
		Picture_Active_Color_RUp4			:= picButton_RightUp_Corner_color2
		Picture_Active_Color_LDown4			:= picButton_LeftDown_Corner_color2
		Picture_Active_Color_RDown4 		:= picButton_RightDown_Corner_color2
		Picture_Active_Color_LineDown4 		:= picButton_Down_Line_color2
		Picture_Active_Color_LineUp4		:= picButton_Up_Line_color2
		Picture_Active_Color_LineRight4 	:= picButton_Right_Line_color2
		Picture_Active_Color_LineLeft4		:= picButton_Left_Line_color2	
	End Function

	Protected Function Init()
		GetProperty()
		InitObject()
		SetComponentColorUp(UpColor)
		SetComponentColorDown(DownColor)
		SelButtonPic(GetPrimaryDisplay().GetWidth(),GetPrimaryDisplay().GetHeight(),ButtonCorner)
		UpFormatFlags := MUpTextAlign BitOr _TEXT_WORDWRAP
		DownFormatFlags := MDownTextAlign BitOr _TEXT_WORDWRAP
		UpdateDimensions()
		UpdateDrawColors()
		If ButtonCorner = BUTTON_STYLE_ROUNDED_CORNER Then
			DownOffset := 1
		Else
			DownOffset := 0
		End If
		RedrawCompoundObject()
	End Function
	
	Protected Function ColorUp()As Long
		If ButtonCorner = BUTTON_STYLE_ROUNDED_CORNER Then
			Return Value COLOR_ORANGE
		Else
			Return Value COLOR_GREYDARK
		End If
	End Function
	
	Protected Function ColorDown()As Long
		If ButtonCorner = BUTTON_STYLE_ROUNDED_CORNER Then
			Return Value COLOR_ORANGE
		Else
			Return Value COLOR_WHITE
		End If
	End Function
	
	Protected Function FontColorUp() As Long
		If ButtonCorner = BUTTON_STYLE_ROUNDED_CORNER Then
			Return Value _COLOR_BLACK
		Else
			Return Value _COLOR_WHITE
		End If	
	End Function
	
	Protected Function GetProperty()
	// Předání hodnot proměnným v bázové třídě	
		MEnabled				:= Enabled
		MLongPressTime			:= LongPressTime
		MUpFont					:= UpFont
		MUpFontColor			:= UpFontColor
		MUpIcon					:= UpIcon
		MUpIconAlign			:= UpIconAlign
		MUpIconOffsetX			:= UpIconOffsetX
		MUpIconOffsetY			:= UpIconOffsetY
		MUpLineSpacing			:= UpLineSpacing
		MUpText					:= UpText
		MUpTextAlign			:= UpTextAlign
		MUpTextOffsetX			:= UpTextOffsetX
		MUpTextOffsetY			:= UpTextOffsetY
		MDownFont				:= DownFont
		MDownFontColor			:= DownFontColor
		MDownIcon				:= DownIcon
		MDownIconAlign			:= DownIconAlign
		MDownIconOffsetX		:= DownIconOffsetX
		MDownIconOffsetY		:= DownIconOffsetY
		MDownLineSpacing		:= DownLineSpacing
		MDownText				:= DownText
		MDownTextAlign			:= DownTextAlign
		MDownTextOffsetX		:= DownTextOffsetX
		MDownTextOffsetY		:= DownTextOffsetY
	End Function
	
	Protected Function GetButtonFont(DisplayWidth As Long,DisplayHeight As Long) As AddressOf _Font
//	 přednastavený font podle rozlišení
		If DisplayWidth >= 1500 And DisplayHeight >= 900 Then
			Return Value fntSegoeUI50
		Else
			Return Value fntSegoeUI23 
		End If
	End Function
	
	Protected Function SelButtonPic(DisplayWidth As Long,DisplayHeight As Long, Corner As Long)
	// výběr vhodné velikosti obrázku tlačítka podle rozlišení
		Var i As Long := 1
		
		If Corner = BUTTON_STYLE_ROUNDED_CORNER Then
			If DisplayWidth >= 1500 And DisplayHeight >= 900 Then
				Up_Centre 		:= Picture_Active_Up_Centre4
				Up_LUp   	 	:= Picture_Active_Up_LUp4	
				Up_RUp 	 	 	:= Picture_Active_Up_RUp4	
				Up_LDown  	 	:= Picture_Active_Up_LDown4	
				Up_RDown 	 	:= Picture_Active_Up_RDown4		
				Up_LineDown 	:= Picture_Active_Up_LineDown4	
				Up_LineUp  	 	:= Picture_Active_Up_LineUp4	
				Up_LineRight  	:= Picture_Active_Up_LineRight4
				Up_LineLeft 	:= Picture_Active_Up_LineLeft4	
				
				Down_Centre	 	:= Picture_Active_Down_Centre4 
				Down_LUp 	 	:= Picture_Active_Down_LUp4	
				Down_RUp 	 	:= Picture_Active_Down_RUp4
				Down_LDown 	 	:= Picture_Active_Down_LDown4
				Down_RDown 	 	:= Picture_Active_Down_RDown4
				Down_LineDown 	:= Picture_Active_Down_LineDown4
				Down_LineUp 	:= Picture_Active_Down_LineUp4
				Down_LineRight 	:= Picture_Active_Down_LineRight4
				Down_LineLeft 	:= Picture_Active_Down_LineLeft4
				
				Centre 			:= Picture_Active_Color_Centre4
				LUp   	 		:= Picture_Active_Color_LUp4	
				RUp 	 	 	:= Picture_Active_Color_RUp4	
				LDown  	 		:= Picture_Active_Color_LDown4	
				RDown 	 		:= Picture_Active_Color_RDown4		
				LineDown 		:= Picture_Active_Color_LineDown4	
				LineUp  	 	:= Picture_Active_Color_LineUp4	
				LineRight  		:= Picture_Active_Color_LineRight4
				LineLeft 		:= Picture_Active_Color_LineLeft4						
			Else
				Up_Centre 		:= Picture_Active_Up_Centre3
				Up_LUp   	 	:= Picture_Active_Up_LUp3	
				Up_RUp 	 	 	:= Picture_Active_Up_RUp3	
				Up_LDown  	 	:= Picture_Active_Up_LDown3	
				Up_RDown 	 	:= Picture_Active_Up_RDown3		
				Up_LineDown 	:= Picture_Active_Up_LineDown3	
				Up_LineUp  	 	:= Picture_Active_Up_LineUp3	
				Up_LineRight  	:= Picture_Active_Up_LineRight3
				Up_LineLeft 	:= Picture_Active_Up_LineLeft3	
				
				Down_Centre	 	:= Picture_Active_Down_Centre3 
				Down_LUp 	 	:= Picture_Active_Down_LUp3	
				Down_RUp 	 	:= Picture_Active_Down_RUp3
				Down_LDown 	 	:= Picture_Active_Down_LDown3
				Down_RDown 	 	:= Picture_Active_Down_RDown3
				Down_LineDown 	:= Picture_Active_Down_LineDown3
				Down_LineUp 	:= Picture_Active_Down_LineUp3
				Down_LineRight 	:= Picture_Active_Down_LineRight3
				Down_LineLeft 	:= Picture_Active_Down_LineLeft3
				
				Centre 			:= Picture_Active_Color_Centre3
				LUp   	 		:= Picture_Active_Color_LUp3	
				RUp 	 	 	:= Picture_Active_Color_RUp3	
				LDown  	 		:= Picture_Active_Color_LDown3	
				RDown 	 		:= Picture_Active_Color_RDown3		
				LineDown 		:= Picture_Active_Color_LineDown3	
				LineUp  	 	:= Picture_Active_Color_LineUp3	
				LineRight  		:= Picture_Active_Color_LineRight3
				LineLeft 		:= Picture_Active_Color_LineLeft3
			End If
		
		Else

			If DisplayWidth >= 1500 And DisplayHeight >= 900 Then
				RectangleEdge	:= 3
				Up_Centre 		:= Picture_Active_Up_Centre2
				Up_LUp   	 	:= Picture_Active_Up_LUp2	
				Up_RUp 	 	 	:= Picture_Active_Up_RUp2	
				Up_LDown  	 	:= Picture_Active_Up_LDown2	
				Up_RDown 	 	:= Picture_Active_Up_RDown2		
				Up_LineDown 	:= Picture_Active_Up_LineDown2	
				Up_LineUp  	 	:= Picture_Active_Up_LineUp2	
				Up_LineRight  	:= Picture_Active_Up_LineRight2
				Up_LineLeft 	:= Picture_Active_Up_LineLeft2	
				
				Down_Centre	 	:= Picture_Active_Down_Centre2 
				Down_LUp 	 	:= Picture_Active_Down_LUp2	
				Down_RUp 	 	:= Picture_Active_Down_RUp2
				Down_LDown 	 	:= Picture_Active_Down_LDown2
				Down_RDown 	 	:= Picture_Active_Down_RDown2
				Down_LineDown 	:= Picture_Active_Down_LineDown2
				Down_LineUp 	:= Picture_Active_Down_LineUp2
				Down_LineRight 	:= Picture_Active_Down_LineRight2
				Down_LineLeft 	:= Picture_Active_Down_LineLeft2
				
			Else
				RectangleEdge	:= 2
				Up_Centre 		:= Picture_Active_Up_Centre
				Up_LUp   	 	:= Picture_Active_Up_LUp	
				Up_RUp 	 	 	:= Picture_Active_Up_RUp	
				Up_LDown  	 	:= Picture_Active_Up_LDown	
				Up_RDown 	 	:= Picture_Active_Up_RDown		
				Up_LineDown 	:= Picture_Active_Up_LineDown	
				Up_LineUp  	 	:= Picture_Active_Up_LineUp	
				Up_LineRight  	:= Picture_Active_Up_LineRight
				Up_LineLeft 	:= Picture_Active_Up_LineLeft	
				
				Down_Centre	 	:= Picture_Active_Down_Centre 
				Down_LUp 	 	:= Picture_Active_Down_LUp	
				Down_RUp 	 	:= Picture_Active_Down_RUp
				Down_LDown 	 	:= Picture_Active_Down_LDown
				Down_RDown 	 	:= Picture_Active_Down_RDown
				Down_LineDown 	:= Picture_Active_Down_LineDown
				Down_LineUp 	:= Picture_Active_Down_LineUp
				Down_LineRight 	:= Picture_Active_Down_LineRight
				Down_LineLeft 	:= Picture_Active_Down_LineLeft	
						
			End If
		End If
	End Function
	
	Protected Function SetComponentColorUp(Upcolor As Long)
		UpColorOpacity := GetColorComponentOpacity(Upcolor)	
		UpButtonColor := SetColorComponentOpacity(Upcolor,255)
	End Function
	
	Protected Function SetComponentColorDown(downColor As Long)
		DownColorOpacity := GetColorComponentOpacity(downColor)	
		DownButtonColor := SetColorComponentOpacity(downColor,255)
	End Function
	
	Protected Function RedrawCompoundObject()
	
		LockRedraw()
	
		If IsPressed Then
			PictureLayer1.Hide()
			PictureLayer2.Hide()
			Redraw()
	
			PictureLayer3.SetPicture(MDownIcon)
			PictureLayer3.SetOpacity(DrawOpacity)
			PictureLayer3.SetFitting(FITTING_FIT_OBJECT_TO_CONTENT)
			PictureLayer3.SetObjectPosition(DownIconX + DownOffset, DownIconY + DownOffset)
	
			TextLayer.SetFont(MDownFont)
			TextLayer.SetText(MDownText)
			TextLayer.SetColor(DownDrawFontColor)
			TextLayer.SetAlign(DownFormatFlags)
			TextLayer.SetTextOffsetX(MDownTextOffsetX+ DownOffset)
			TextLayer.SetTextOffsetY(MDownTextOffsetY+ DownOffset)
			TextLayer.SetLineSpacing(MDownLineSpacing)
			TextLayer.SetObjectPosition(0, 0)
			TextLayer.SetObjectDimensions(ObjectWidth, ObjectHeight)
			
		Else
			PictureLayer1.Hide()
			PictureLayer2.Hide()
			Redraw()
			
			PictureLayer3.SetPicture(MUpIcon)
			PictureLayer3.SetOpacity(DrawOpacity)
			PictureLayer3.SetFitting(FITTING_FIT_OBJECT_TO_CONTENT)
			PictureLayer3.SetObjectPosition(UpIconX , UpIconY )
			
			TextLayer.SetFont(MUpFont)
			TextLayer.SetText(MUpText)
			TextLayer.SetColor(UpDrawFontColor)
			TextLayer.SetAlign(UpFormatFlags)
			TextLayer.SetTextOffsetX(MUpTextOffsetX)
			TextLayer.SetTextOffsetY(MUpTextOffsetY)
			TextLayer.SetLineSpacing(MUpLineSpacing)
			TextLayer.SetObjectPosition(0, 0)
			TextLayer.SetObjectDimensions(ObjectWidth, ObjectHeight)
		End If

		UnlockRedraw()
	
	End Function
	
	Private Function Draw3DButton(state As Boolean)
		Var Width As Long
		Var Height As Long

		Me.GetSize(Width,Height)
		If ButtonCorner = BUTTON_STYLE_ROUNDED_CORNER Then
			If 	state Then
				DrawStretchedTintedPicture(LineUp,DownButtonColor,Down_RUp.GetWidth(),0,Width-2*Down_RUp.GetWidth(),Down_RUp.GetHeight(),0,0,-1,-1,DownColorOpacity)
				DrawStretchedTintedPicture(LineRight,DownButtonColor,Width-Down_RUp.GetWidth(),Down_RUp.GetHeight(),Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight(),0,0,-1,-1,DownColorOpacity)
				DrawStretchedTintedPicture(LineDown,DownButtonColor,Down_RUp.GetWidth(),Height-Down_RUp.GetHeight(),Width-2*Down_RUp.GetWidth(),Down_RUp.GetHeight(),0,0,-1,-1,DownColorOpacity)
				DrawStretchedTintedPicture(LineLeft,DownButtonColor,0,Down_RUp.GetHeight(),Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight(),0,0,-1,-1,DownColorOpacity)			
				DrawStretchedTintedPicture(Centre,DownButtonColor,Down_RUp.GetWidth(),Down_RUp.GetHeight(),Width-2*Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight(),0,0,-1,-1,DownColorOpacity)

				DrawTintedPicture(LUp,DownButtonColor,0,0,-1,-1,0,0,DownColorOpacity)
				DrawTintedPicture(RUp,DownButtonColor,Width-Down_RUp.GetWidth(),0,-1,-1,0,0,DownColorOpacity)
				DrawTintedPicture(LDown,DownButtonColor,0,Height-Down_RUp.GetHeight(),-1,-1,0,0,DownColorOpacity)
				DrawTintedPicture(RDown,DownButtonColor,Width-Down_RUp.GetWidth(),Height-Down_RUp.GetHeight(),-1,-1,0,0,DownColorOpacity)	
			Else
				DrawStretchedTintedPicture(LineUp,UpButtonColor,Down_RUp.GetWidth(),0,Width-2*Down_RUp.GetWidth(),Down_RUp.GetHeight(),0,0,-1,-1,UpColorOpacity)
				DrawStretchedTintedPicture(LineRight,UpButtonColor,Width-Down_RUp.GetWidth(),Down_RUp.GetHeight(),Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight(),0,0,-1,-1,UpColorOpacity)
				DrawStretchedTintedPicture(LineDown,UpButtonColor,Down_RUp.GetWidth(),Height-Down_RUp.GetHeight(),Width-2*Down_RUp.GetWidth(),Down_RUp.GetHeight(),0,0,-1,-1,UpColorOpacity)
				DrawStretchedTintedPicture(LineLeft,UpButtonColor,0,Down_RUp.GetHeight(),Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight(),0,0,-1,-1,UpColorOpacity)			
				DrawStretchedTintedPicture(Centre,UpButtonColor,Down_RUp.GetWidth(),Down_RUp.GetHeight(),Width-2*Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight(),0,0,-1,-1,UpColorOpacity)
			
				DrawTintedPicture(LUp,UpButtonColor,0,0,-1,-1,0,0,UpColorOpacity)
				DrawTintedPicture(RUp,UpButtonColor,Width-Down_RUp.GetWidth(),0,-1,-1,0,0,UpColorOpacity)
				DrawTintedPicture(LDown,UpButtonColor,0,Height-Down_RUp.GetHeight(),-1,-1,0,0,UpColorOpacity)
				DrawTintedPicture(RDown,UpButtonColor,Width-Down_RUp.GetWidth(),Height-Down_RUp.GetHeight(),-1,-1,0,0,UpColorOpacity)
			End If	
		Else	
			If 	state Then
				DrawRectangle(DownColor,RectangleEdge,RectangleEdge,Width-2*RectangleEdge,Height-2*RectangleEdge)
			Else
				DrawRectangle(UpColor,RectangleEdge,RectangleEdge,Width-2*RectangleEdge,Height-2*RectangleEdge)
			End If
		End If
		
			If 	state Then
				DrawStretchedPicture(Down_LineUp,Down_RUp.GetWidth(),0,Width-2*Down_RUp.GetWidth(),Down_RUp.GetHeight())
				DrawStretchedPicture(Down_LineRight,Width-Down_RUp.GetWidth(),Down_RUp.GetHeight(),Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight())
				DrawStretchedPicture(Down_LineDown,Down_RUp.GetWidth(),Height-Down_RUp.GetHeight(),Width-2*Down_RUp.GetWidth(),Down_RUp.GetHeight())
				DrawStretchedPicture(Down_LineLeft,0,Down_RUp.GetHeight(),Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight())			
				DrawStretchedPicture(Down_Centre,Down_RUp.GetWidth(),Down_RUp.GetHeight(),Width-2*Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight())
			
				DrawPicture(Down_LUp,0,0)
				DrawPicture(Down_RUp,Width-Down_RUp.GetWidth(),0)
				DrawPicture(Down_LDown,0,Height-Down_RUp.GetHeight())
				DrawPicture(Down_RDown,Width-Down_RUp.GetWidth(),Height-Down_RUp.GetHeight())			
			Else						
				DrawStretchedPicture(Up_LineUp,Up_RUp.GetWidth(),0,Width-2*Up_RUp.GetWidth(),Up_RUp.GetHeight())
				DrawStretchedPicture(Up_LineRight,Width-Up_RUp.GetWidth(),Up_RUp.GetHeight(),Up_RUp.GetWidth(),Height-2*Up_RUp.GetHeight())
				DrawStretchedPicture(Up_LineDown,Up_RUp.GetWidth(),Height-Up_RUp.GetHeight(),Width-2*Up_RUp.GetWidth(),Up_RUp.GetHeight())
				DrawStretchedPicture(Up_LineLeft,0,Up_RUp.GetHeight(),Up_RUp.GetWidth(),Height-2*Up_RUp.GetHeight())
				DrawStretchedPicture(Up_Centre,Up_RUp.GetWidth(),Up_RUp.GetHeight(),Width-2*Up_RUp.GetWidth(),Height-2*Up_RUp.GetHeight())
			
				DrawPicture(Up_LUp,0,0)
				DrawPicture(Up_RUp,Width-Up_RUp.GetWidth(),0)
				DrawPicture(Up_LDown,0,Height-Up_RUp.GetHeight())
				DrawPicture(Up_RDown,Width-Up_RUp.GetWidth(),Height-Up_RUp.GetHeight())
			End If
		
	End Function	

	Public Function SetButtonStyle(newbuttonstyle As Long) As Boolean
		If newbuttonstyle  = BUTTON_STYLE_ROUNDED_CORNER Then
			DownOffset := 1
		Else
			DownOffset := 0
		End If
		ButtonCorner := newbuttonstyle
		SelButtonPic(GetPrimaryDisplay().GetWidth(),GetPrimaryDisplay().GetHeight(),ButtonCorner)
		UpdateDimensions()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetButtonStyle() As Long
		Return Value ButtonCorner
	End Function
	
//colors button
	Public Function SetDownColor(newdowncolor As Long) As Boolean
		DownColor := newdowncolor
		SetComponentColorDown(newdowncolor)
		RedrawCompoundObject()
		Return Value True
	End Function
	
	Public Function SetUpColor(newupcolor As Long) As Boolean
		UpColor := newupcolor
		SetComponentColorUp(newupcolor)
		RedrawCompoundObject()
		Return Value True	
	End Function
		
	Public Function GetDownColor() As Long
		Return Value DownColor
	End Function
	
	Public Function GetUpColor() As Long
		Return Value UpColor
	End Function
	
//text	
//up
	Public Function SetUpFont(newupfont As AddressOf _Font) As Boolean
		MUpFont := newupfont
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpFont() As AddressOf _Font
		Return Value MUpFont	
	End Function
		
	Public Function SetUpFontColor(newupfontcolor As Long) As Boolean
		MUpFontColor := newupfontcolor
		UpdateDrawColors()
		RedrawCompoundObject()
		Return Value True	
	End Function
		
	Public Function GetUpFontColor() As Long
		Return Value MUpFontColor
	End Function

	Public Function SetUpLineSpacing(newuplinespacing As Double) As Boolean	
		If newuplinespacing >= 0 Then
			MUpLineSpacing := newuplinespacing
			RedrawCompoundObject()
			Return Value True
		Else
			Return Value False
		End If
	End Function
	
	Public Function GetUpLineSpacing() As Double
		Return Value MUpLineSpacing	
	End Function
	
	Public Function SetUpText(newuptext As Text) As Boolean
		If GetMemorySegment(newuptext) = _MSEG_RESOURCEDATA Then
			MUpText := newuptext
		Else
			TextBuffer := newuptext
			MUpText := TextBuffer
		End If
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpText() As AddressOf Text
		Return Value MUpText	
	End Function
	
	Public Function SetUpTextAlign(newuptextalign As Long) As Boolean
		Select newuptextalign
			Case _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNTOP, _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNVCENTER, _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNBOTTOM, _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNTOP, _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNVCENTER, _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNBOTTOM, _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNTOP, _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNVCENTER, _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNBOTTOM
				MUpTextAlign := newuptextalign
				UpFormatFlags := MUpTextAlign BitOr _TEXT_WORDWRAP
				RedrawCompoundObject()
				Return Value True
	
			Case Else
				Return Value False
		End Select
	End Function
	
	Public Function GetUpTextAlign() As Long
		Return Value MUpTextAlign
	End Function
	
	Public Function SetUpTextOffsetX(newuptextoffsetx As Long) As Boolean	
		MUpTextOffsetX := newuptextoffsetx 
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpTextOffsetX() As Long
		Return Value MUpTextOffsetX	
	End Function
	
	Public Function SetUpTextOffsetY(newuptextoffsety As Long) As Boolean
		MUpTextOffsetY := newuptextoffsety 
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpTextOffsetY() As Long
		Return Value MUpTextOffsetY	
	End Function
//down	
	Public Function SetDownFont(newdownfont As AddressOf _Font) As Boolean
		MDownFont := newdownfont
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownFont() As AddressOf _Font
		Return Value MDownFont	
	End Function
		
	Public Function SetDownFontColor(newdownfontcolor As Long) As Boolean
		MDownFontColor := newdownfontcolor
		UpdateDrawColors()
		RedrawCompoundObject()
		Return Value True	
	End Function
		
	Public Function GetDownFontColor() As Long
		Return Value MDownFontColor
	End Function

	Public Function SetDownLineSpacing(newdownlinespacing As Double) As Boolean	
		If newdownlinespacing >= 0 Then
			MDownLineSpacing := newdownlinespacing
			RedrawCompoundObject()
			Return Value True
		Else
			Return Value False
		End If
	End Function
	
	Public Function GetDownLineSpacing() As Double
		Return Value MDownLineSpacing	
	End Function
	
	Public Function SetDownText(newdowntext As Text) As Boolean
		If GetMemorySegment(newdowntext) = _MSEG_RESOURCEDATA Then
			MDownText := newdowntext
		Else
			TextBuffer := newdowntext
			MDownText := TextBuffer
		End If
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownText() As AddressOf Text
		Return Value MDownText	
	End Function
	
	Public Function SetDownTextAlign(newdowntextalign As Long) As Boolean
		Select newdowntextalign
			Case _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNTOP, _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNVCENTER, _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNBOTTOM, _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNTOP, _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNVCENTER, _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNBOTTOM, _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNTOP, _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNVCENTER, _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNBOTTOM
				MDownTextAlign := newdowntextalign
				DownFormatFlags := MDownTextAlign BitOr _TEXT_WORDWRAP
				RedrawCompoundObject()
				Return Value True
	
			Case Else
				Return Value False
		End Select
	End Function
	
	Public Function GetDownTextAlign() As Long
		Return Value MDownTextAlign
	End Function
	
	Public Function SetDownTextOffsetX(newdowntextoffsetx As Long) As Boolean	
		MDownTextOffsetX := newdowntextoffsetx 
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownTextOffsetX() As Long
		Return Value MDownTextOffsetX	
	End Function
	
	Public Function SetDownTextOffsetY(newdowntextoffsety As Long) As Boolean
		MDownTextOffsetY := newdowntextoffsety 
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownTextOffsetY() As Long
		Return Value MDownTextOffsetY	
	End Function
// icon
// up 
	Public Function SetUpIcon(newupicon As AddressOf _Picture) As Boolean
		MUpIcon := newupicon
		UpdateIconPosition()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpIcon() As AddressOf _Picture
		Return Value MUpIcon	
	End Function
	
	Public Function SetUpIconAlign(newupiconalign As Long) As Boolean
		Select newupiconalign
			Case ICON_ALIGNLEFT BitOr ICON_ALIGNTOP, ICON_ALIGNLEFT BitOr ICON_ALIGNVCENTER, ICON_ALIGNLEFT BitOr ICON_ALIGNBOTTOM, ICON_ALIGNHCENTER BitOr ICON_ALIGNTOP, ICON_ALIGNHCENTER BitOr ICON_ALIGNVCENTER, ICON_ALIGNHCENTER BitOr ICON_ALIGNBOTTOM, ICON_ALIGNRIGHT BitOr ICON_ALIGNTOP, ICON_ALIGNRIGHT BitOr ICON_ALIGNVCENTER, ICON_ALIGNRIGHT BitOr ICON_ALIGNBOTTOM
				MUpIconAlign := newupiconalign
				UpdateIconPosition()
				RedrawCompoundObject()
				Return Value True
	
			Case Else
				Return Value False
		End Select
	End Function
	
	Public Function GetUpIconAlign() As Long
		Return Value MUpIconAlign
	End Function
	
	Public Function SetUpIconOffsetX(newupiconoffsetx As Long) As Boolean	
		MUpIconOffsetX := newupiconoffsetx
		UpdateIconPosition() 
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpIconOffsetX() As Long
		Return Value MUpIconOffsetX	
	End Function
	
	Public Function SetUpIconOffsetY(newupiconoffsety As Long) As Boolean	
		MUpIconOffsetY := newupiconoffsety 
		UpdateIconPosition()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpIconOffsetY() As Long
		Return Value MUpIconOffsetY	
	End Function
// down
	Public Function SetDownIcon(newdownicon As AddressOf _Picture) As Boolean
		MDownIcon := newdownicon
		UpdateIconPosition()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownIcon() As AddressOf _Picture
		Return Value MDownIcon	
	End Function
	
	Public Function SetDownIconAlign(newdowniconalign As Long) As Boolean
		Select newdowniconalign
			Case ICON_ALIGNLEFT BitOr ICON_ALIGNTOP, ICON_ALIGNLEFT BitOr ICON_ALIGNVCENTER, ICON_ALIGNLEFT BitOr ICON_ALIGNBOTTOM, ICON_ALIGNHCENTER BitOr ICON_ALIGNTOP, ICON_ALIGNHCENTER BitOr ICON_ALIGNVCENTER, ICON_ALIGNHCENTER BitOr ICON_ALIGNBOTTOM, ICON_ALIGNRIGHT BitOr ICON_ALIGNTOP, ICON_ALIGNRIGHT BitOr ICON_ALIGNVCENTER, ICON_ALIGNRIGHT BitOr ICON_ALIGNBOTTOM
				MDownIconAlign := newdowniconalign
				UpdateIconPosition()
				RedrawCompoundObject()
				Return Value True
	
			Case Else
				Return Value False
		End Select
	End Function
	
	Public Function GetDownIconAlign() As Long
		Return Value MDownIconAlign
	End Function
	
	Public Function SetDownIconOffsetX(newdowniconoffsetx As Long) As Boolean	
		MDownIconOffsetX := newdowniconoffsetx 
		UpdateIconPosition()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownIconOffsetX() As Long
		Return Value MDownIconOffsetX	
	End Function
	
	Public Function SetDownIconOffsetY(newdowniconoffsety As Long) As Boolean	
		MDownIconOffsetY := newdowniconoffsety 
		UpdateIconPosition()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownIconOffsetY() As Long
		Return Value MDownIconOffsetY	
	End Function
	
	Public Function SetObjectDimensions(newwidth As Long, newheight As Long) As Boolean
		SetSize(newwidth, newheight)
		UpdateDimensions()
		RedrawCompoundObject()
		Return Value True
	End Function

	Public Function GetObjectDimensions(ByRef currentwidth As Long, ByRef currentheight As Long)
		GetSize(currentwidth, currentheight)
	End Function

	Public Function SetObjectPosition(newx As Long, newy As Long) As Boolean
		Var Response As Boolean
		Response := SetPosition(newx, newy)
		RedrawCompoundObject()
		Return Value Response
	End Function
	
	Public Function GetObjectPosition(ByRef currentx As Long, ByRef currenty As Long)
		GetPosition(currentx, currenty)
	End Function

End GraphicClass



///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

Global GraphicClass PushButton Inherits Namespace "CUE.GraphicCollection.GenericObjectsBase.3".BasePushButton WithAttributes {defaultwidth := 120, defaultheight := 80,ObjectCode := "OB0076-001", DesignName := "Multicolor", GroupName := "Buttons"}

	Public Const BUTTON_STYLE_ROUNDED_CORNER				As Long	:= 1	
	Public Const BUTTON_STYLE_SHARP_CORNER				As Long	:= 2

	Global Const ICON_ALIGNLEFT As Long := &H00000001	// Horizontal align left
	Global Const ICON_ALIGNHCENTER As Long := &H00000002	// Horizontal align center
	Global Const ICON_ALIGNRIGHT As Long :=	&H00000004	// Horizontal align right
	Global Const ICON_ALIGNTOP As Long := &H00000008	// Vertical align top
	Global Const ICON_ALIGNVCENTER As Long := &H00000010	// Vertical align center
	Global Const ICON_ALIGNBOTTOM As Long := &H00000020	// Vertical align bottom

	
	// Behavior Property Group
	Protected Property Enabled 							As Boolean := True WithAttributes {PropertyGroup := "Behavior", EditMode := "Boolean; 'Yes' := True, 'No' := False"}
	Protected Property ButtonCorner						As Long := BUTTON_STYLE_ROUNDED_CORNER WithAttributes {PropertyGroup := "Appearance",DisplayName := "ButtonStyle", EditMode:= "Enum; 'Sharp Corner' := BUTTON_STYLE_SHARP_CORNER, 'Rounded Corner' := BUTTON_STYLE_ROUNDED_CORNER"}
	
	Protected Var		ButtonFont						As AddressOf _Font := GetButtonFont(GetPrimaryDisplay().GetWidth(),GetPrimaryDisplay().GetHeight()) 
	Protected Var		RectangleEdge					As Long := 2
	Protected Var		DownButtonColor					As Long := Namespace "CUE.GraphicCollection.MulticolorPalette.1".COLOR_ORANGE
	Protected Var		UpButtonColor					As Long := Namespace "CUE.GraphicCollection.MulticolorPalette.1".COLOR_ORANGE
	
	// Up Property Group
	Protected Property UpColor As Long := ColorUp() WithAttributes {PropertyGroup := "Up", EditMode := "color"}		
	
	Protected Var UpColorOpacity As Byte := 204 	
	Protected Property UpFont As AddressOf _Font := ButtonFont WithAttributes {PropertyGroup := "Up", EditMode := "font"}
	Protected Property UpFontColor As Long := FontColorUp() WithAttributes {PropertyGroup := "Up", EditMode := "color"}
	Protected Property UpIcon As AddressOf _Picture := Nothing WithAttributes {PropertyGroup := "Up"}
	Protected Property UpIconAlign As Long := ICON_ALIGNHCENTER BitOr ICON_ALIGNVCENTER WithAttributes {PropertyGroup := "Up", EditMode := "ENUM; 'Left-Top' := &H09, 'Left-Middle' := &H11, 'Left-Bottom' := &H21, 'Center-Top' := &H0A, 'Center-Middle' := &H12, 'Center-Bottom' := &H22, 'Right-Top' := &H0C, 'Right-Middle' := &H14, 'Right-Bottom' := &H24"}
	Protected Property UpIconOffsetX As Long := 0 WithAttributes {PropertyGroup := "Up"}
	Protected Property UpIconOffsetY As Long := 0 WithAttributes {PropertyGroup := "Up"}
	Protected Property UpLineSpacing As Double := 1.2 WithAttributes {PropertyGroup := "Up"}
	Protected Property UpText As AddressOf Text := txtCaption WithAttributes {PropertyGroup := "Up"}
	Protected Property UpTextAlign As Long := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNVCENTER WithAttributes {PropertyGroup := "Up", EditMode := "ENUM; 'Left-Top' := _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNTOP, 'Left-Middle' := _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNVCENTER, 'Left-Bottom' := _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNBOTTOM, 'Center-Top' := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNTOP, 'Center-Middle' := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNVCENTER, 'Center-Bottom' := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNBOTTOM, 'Right-Top' := _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNTOP, 'Right-Middle' := _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNVCENTER, 'Right-Bottom' := _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNBOTTOM"}
	Protected Property UpTextOffsetX As Long := 0 WithAttributes {PropertyGroup := "Up"}
	Protected Property UpTextOffsetY As Long := 0 WithAttributes {PropertyGroup := "Up"}

	// Down Property Group
	Protected Property DownColor As Long := ColorDown() WithAttributes {PropertyGroup := "Down", EditMode := "color"}

	Protected Var DownColorOpacity As Byte := UpColorOpacity
	Protected Property DownFont As AddressOf _Font := UpFont WithAttributes {PropertyGroup := "Down", EditMode := "font"}
	Protected Property DownFontColor As Long := _COLOR_BLACK WithAttributes {PropertyGroup := "Down", EditMode := "color"}
	Protected Property DownIcon As AddressOf _Picture := UpIcon WithAttributes {PropertyGroup := "Down"}
	Protected Property DownIconAlign As Long := UpIconAlign WithAttributes {PropertyGroup := "Down", EditMode := "ENUM; 'Left-Top' := &H09, 'Left-Middle' := &H11, 'Left-Bottom' := &H21, 'Center-Top' := &H0A, 'Center-Middle' := &H12, 'Center-Bottom' := &H22, 'Right-Top' := &H0C, 'Right-Middle' := &H14, 'Right-Bottom' := &H24"}
	Protected Property DownIconOffsetX As Long := UpIconOffsetX WithAttributes {PropertyGroup := "Down"}
	Protected Property DownIconOffsetY As Long := UpIconOffsetY WithAttributes {PropertyGroup := "Down"}
	Protected Property DownLineSpacing As Double := UpLineSpacing WithAttributes {PropertyGroup := "Down"}
	Protected Property DownText As AddressOf Text := UpText WithAttributes {PropertyGroup := "Down"}
	Protected Property DownTextAlign As Long := UpTextAlign WithAttributes {PropertyGroup := "Down", EditMode := "ENUM; 'Left-Top' := _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNTOP, 'Left-Middle' := _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNVCENTER, 'Left-Bottom' := _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNBOTTOM, 'Center-Top' := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNTOP, 'Center-Middle' := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNVCENTER, 'Center-Bottom' := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNBOTTOM, 'Right-Top' := _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNTOP, 'Right-Middle' := _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNVCENTER, 'Right-Bottom' := _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNBOTTOM"}
	Protected Property DownTextOffsetX As Long := UpTextOffsetX WithAttributes {PropertyGroup := "Down"}
	Protected Property DownTextOffsetY As Long := UpTextOffsetY WithAttributes {PropertyGroup := "Down"}

	Protected Var		Picture_Active_Up_Centre 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LUp 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RUp 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LDown 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RDown 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineDown 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineUp 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineRight 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineLeft 		As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Down_Centre	 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LUp			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RUp			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LDown		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RDown 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineDown 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineUp		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineRight 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineLeft	As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Up_Centre2 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LUp2 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RUp2 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LDown2 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RDown2 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineDown2 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineUp2 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineRight2 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineLeft2		As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Down_Centre2	 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LUp2		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RUp2		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LDown2		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RDown2 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineDown2 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineUp2		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineRight2 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineLeft2	As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Up_Centre3 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LUp3 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RUp3 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LDown3 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RDown3 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineDown3 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineUp3 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineRight3 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineLeft3		As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Down_Centre3	 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LUp3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RUp3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LDown3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RDown3 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineDown3 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineUp3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineRight3 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineLeft3	As AddressOf _Picture := Nothing

	Protected Var		Picture_Active_Color_Centre3	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LUp3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_RUp3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LDown3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_RDown3 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineDown3 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineUp3	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineRight3 As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineLeft3	As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Up_Centre4 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LUp4 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RUp4 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LDown4 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RDown4 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineDown4 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineUp4 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineRight4 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineLeft4		As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Down_Centre4	 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LUp4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RUp4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LDown4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RDown4 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineDown4 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineUp4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineRight4 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineLeft4	As AddressOf _Picture := Nothing

	Protected Var		Picture_Active_Color_Centre4	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LUp4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_RUp4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LDown4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_RDown4 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineDown4 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineUp4	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineRight4 As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineLeft4	As AddressOf _Picture := Nothing
	
	Protected Var		Up_Centre 		As AddressOf _Picture := Nothing
	Protected Var		Up_LUp 			As AddressOf _Picture := Nothing
	Protected Var		Up_RUp 			As AddressOf _Picture := Nothing
	Protected Var		Up_LDown 		As AddressOf _Picture := Nothing
	Protected Var		Up_RDown 		As AddressOf _Picture := Nothing
	Protected Var		Up_LineDown 	As AddressOf _Picture := Nothing
	Protected Var		Up_LineUp 		As AddressOf _Picture := Nothing
	Protected Var		Up_LineRight 	As AddressOf _Picture := Nothing
	Protected Var		Up_LineLeft 	As AddressOf _Picture := Nothing
	
	Protected Var		Down_Centre	 	As AddressOf _Picture := Nothing
	Protected Var		Down_LUp		As AddressOf _Picture := Nothing
	Protected Var		Down_RUp		As AddressOf _Picture := Nothing
	Protected Var		Down_LDown		As AddressOf _Picture := Nothing
	Protected Var		Down_RDown 		As AddressOf _Picture := Nothing
	Protected Var		Down_LineDown 	As AddressOf _Picture := Nothing
	Protected Var		Down_LineUp		As AddressOf _Picture := Nothing
	Protected Var		Down_LineRight 	As AddressOf _Picture := Nothing
	Protected Var		Down_LineLeft	As AddressOf _Picture := Nothing

	Protected Var		Centre 			As AddressOf _Picture := Nothing
	Protected Var		LUp   			As AddressOf _Picture := Nothing 		
	Protected Var		RUp 			As AddressOf _Picture := Nothing 	 	
	Protected Var		LDown  	 		As AddressOf _Picture := Nothing		
	Protected Var		RDown 	 		As AddressOf _Picture := Nothing		
	Protected Var		LineDown 		As AddressOf _Picture := Nothing	
	Protected Var		LineUp  		As AddressOf _Picture := Nothing 		
	Protected Var		LineRight  		As AddressOf _Picture := Nothing	
	Protected Var		LineLeft 		As AddressOf _Picture := Nothing	

	
	Protected Function InitObject()
		Picture_Active_Up_Centre			:= Nothing
		Picture_Active_Up_LUp 				:= picButton_LeftUp_Corner
		Picture_Active_Up_RUp 				:= picButton_RightUp_Corner
		Picture_Active_Up_LDown 			:= picButton_LeftDown_Corner
		Picture_Active_Up_RDown 			:= picButton_RightDown_Corner
		Picture_Active_Up_LineDown 			:= picButton_Down_Line
		Picture_Active_Up_LineUp 			:= picButton_Up_Line
		Picture_Active_Up_LineRight 		:= picButton_Right_Line
		Picture_Active_Up_LineLeft 			:= picButton_Left_Line
	
		Picture_Active_Down_LUp				:= picButton_LeftUp_Corner
		Picture_Active_Down_RUp				:= picButton_RightUp_Corner
		Picture_Active_Down_LDown			:= picButton_LeftDown_Corner
		Picture_Active_Down_RDown 			:= picButton_RightDown_Corner
		Picture_Active_Down_LineDown 		:= picButton_Down_Line
		Picture_Active_Down_LineUp			:= picButton_Up_Line
		Picture_Active_Down_LineRight 		:= picButton_Right_Line
		Picture_Active_Down_LineLeft		:= picButton_Left_Line
		
		Picture_Active_Up_Centre2			:= Nothing		
		Picture_Active_Up_LUp2 				:= picButton_LeftUp_Corner1
		Picture_Active_Up_RUp2 				:= picButton_RightUp_Corner1
		Picture_Active_Up_LDown2 			:= picButton_LeftDown_Corner1
		Picture_Active_Up_RDown2 			:= picButton_RightDown_Corner1
		Picture_Active_Up_LineDown2 		:= picButton_Down_Line1
		Picture_Active_Up_LineUp2 			:= picButton_Up_Line1
		Picture_Active_Up_LineRight2 		:= picButton_Right_Line1
		Picture_Active_Up_LineLeft2 		:= picButton_Left_Line1
	
		Picture_Active_Down_LUp2			:= picButton_LeftUp_Corner1
		Picture_Active_Down_RUp2			:= picButton_RightUp_Corner1
		Picture_Active_Down_LDown2			:= picButton_LeftDown_Corner1
		Picture_Active_Down_RDown2 			:= picButton_RightDown_Corner1
		Picture_Active_Down_LineDown2 		:= picButton_Down_Line1
		Picture_Active_Down_LineUp2			:= picButton_Up_Line1
		Picture_Active_Down_LineRight2 		:= picButton_Right_Line1
		Picture_Active_Down_LineLeft2		:= picButton_Left_Line1	
		
		Picture_Active_Up_Centre3			:= picButton_Centre3
		Picture_Active_Up_LUp3 				:= picButton_LeftUp_Corner3
		Picture_Active_Up_RUp3 				:= picButton_RightUp_Corner3
		Picture_Active_Up_LDown3 			:= picButton_LeftDown_Corner3
		Picture_Active_Up_RDown3 			:= picButton_RightDown_Corner3
		Picture_Active_Up_LineDown3 		:= picButton_Down_Line3
		Picture_Active_Up_LineUp3 			:= picButton_Up_Line3
		Picture_Active_Up_LineRight3 		:= picButton_Right_Line3
		Picture_Active_Up_LineLeft3 		:= picButton_Left_Line3

		Picture_Active_Down_Centre3			:= picButton_Centre_down3	
		Picture_Active_Down_LUp3			:= picButton_LeftUp_Corner_down3
		Picture_Active_Down_RUp3			:= picButton_RightUp_Corner_down3
		Picture_Active_Down_LDown3			:= picButton_LeftDown_Corner_down3
		Picture_Active_Down_RDown3 			:= picButton_RightDown_Corner_down3
		Picture_Active_Down_LineDown3 		:= picButton_Down_Line_down3
		Picture_Active_Down_LineUp3			:= picButton_Up_Line_down3
		Picture_Active_Down_LineRight3 		:= picButton_Right_Line_down3
		Picture_Active_Down_LineLeft3		:= picButton_Left_Line_down3
		
		Picture_Active_Color_Centre3		:= picButton_Centre_color3
		Picture_Active_Color_LUp3			:= picButton_LeftUp_Corner_color3
		Picture_Active_Color_RUp3			:= picButton_RightUp_Corner_color3
		Picture_Active_Color_LDown3			:= picButton_LeftDown_Corner_color3
		Picture_Active_Color_RDown3 		:= picButton_RightDown_Corner_color3
		Picture_Active_Color_LineDown3 		:= picButton_Down_Line_color3
		Picture_Active_Color_LineUp3		:= picButton_Up_Line_color3
		Picture_Active_Color_LineRight3 	:= picButton_Right_Line_color3
		Picture_Active_Color_LineLeft3		:= picButton_Left_Line_color3
		
		Picture_Active_Up_Centre4			:= picButton_Centre2
		Picture_Active_Up_LUp4 				:= picButton_LeftUp_Corner2
		Picture_Active_Up_RUp4 				:= picButton_RightUp_Corner2
		Picture_Active_Up_LDown4 			:= picButton_LeftDown_Corner2
		Picture_Active_Up_RDown4 			:= picButton_RightDown_Corner2
		Picture_Active_Up_LineDown4 		:= picButton_Down_Line2
		Picture_Active_Up_LineUp4 			:= picButton_Up_Line2
		Picture_Active_Up_LineRight4 		:= picButton_Right_Line2
		Picture_Active_Up_LineLeft4 		:= picButton_Left_Line2

		Picture_Active_Down_Centre4			:= picButton_Centre_down2	
		Picture_Active_Down_LUp4			:= picButton_LeftUp_Corner_down2
		Picture_Active_Down_RUp4			:= picButton_RightUp_Corner_down2
		Picture_Active_Down_LDown4			:= picButton_LeftDown_Corner_down2
		Picture_Active_Down_RDown4 			:= picButton_RightDown_Corner_down2
		Picture_Active_Down_LineDown4 		:= picButton_Down_Line_down2
		Picture_Active_Down_LineUp4			:= picButton_Up_Line_down2
		Picture_Active_Down_LineRight4 		:= picButton_Right_Line_down2
		Picture_Active_Down_LineLeft4		:= picButton_Left_Line_down2
		
		Picture_Active_Color_Centre4		:= picButton_Centre_color2
		Picture_Active_Color_LUp4			:= picButton_LeftUp_Corner_color2
		Picture_Active_Color_RUp4			:= picButton_RightUp_Corner_color2
		Picture_Active_Color_LDown4			:= picButton_LeftDown_Corner_color2
		Picture_Active_Color_RDown4 		:= picButton_RightDown_Corner_color2
		Picture_Active_Color_LineDown4 		:= picButton_Down_Line_color2
		Picture_Active_Color_LineUp4		:= picButton_Up_Line_color2
		Picture_Active_Color_LineRight4 	:= picButton_Right_Line_color2
		Picture_Active_Color_LineLeft4		:= picButton_Left_Line_color2	
	End Function

	Protected Function Init()
		GetProperty()
		InitObject()
		SetComponentColorUp(UpColor)
		SetComponentColorDown(DownColor)
		SelButtonPic(GetPrimaryDisplay().GetWidth(),GetPrimaryDisplay().GetHeight(),ButtonCorner)
		UpFormatFlags := MUpTextAlign BitOr _TEXT_WORDWRAP
		DownFormatFlags := MDownTextAlign BitOr _TEXT_WORDWRAP
		UpdateDimensions()
		UpdateDrawColors()
		If ButtonCorner = BUTTON_STYLE_ROUNDED_CORNER Then
			DownOffset := 1
		Else
			DownOffset := 0
		End If
		RedrawCompoundObject()
	End Function
	
	Protected Function ColorUp()As Long
		If ButtonCorner = BUTTON_STYLE_ROUNDED_CORNER Then
			Return Value COLOR_ORANGE
		Else
			Return Value COLOR_GREYDARK
		End If
	End Function
	
	Protected Function ColorDown()As Long
		If ButtonCorner = BUTTON_STYLE_ROUNDED_CORNER Then
			Return Value COLOR_ORANGE
		Else
			Return Value COLOR_WHITE
		End If
	End Function
	
	Protected Function FontColorUp() As Long
		If ButtonCorner = BUTTON_STYLE_ROUNDED_CORNER Then
			Return Value _COLOR_BLACK
		Else
			Return Value _COLOR_WHITE
		End If	
	End Function
				
	Protected Function GetProperty()
	// Předání hodnot proměnným v bázové třídě
		MEnabled				:= Enabled
		MUpFont					:= UpFont
		MUpFontColor			:= UpFontColor
		MUpIcon					:= UpIcon
		MUpIconAlign			:= UpIconAlign
		MUpIconOffsetX			:= UpIconOffsetX
		MUpIconOffsetY			:= UpIconOffsetY
		MUpLineSpacing			:= UpLineSpacing
		MUpText					:= UpText
		MUpTextAlign			:= UpTextAlign
		MUpTextOffsetX			:= UpTextOffsetX
		MUpTextOffsetY			:= UpTextOffsetY
		MDownFont				:= DownFont
		MDownFontColor			:= DownFontColor
		MDownIcon				:= DownIcon
		MDownIconAlign			:= DownIconAlign
		MDownIconOffsetX		:= DownIconOffsetX
		MDownIconOffsetY		:= DownIconOffsetY
		MDownLineSpacing		:= DownLineSpacing
		MDownText				:= DownText
		MDownTextAlign			:= DownTextAlign
		MDownTextOffsetX		:= DownTextOffsetX
		MDownTextOffsetY		:= DownTextOffsetY
	End Function
	
	Protected Function GetButtonFont(DisplayWidth As Long,DisplayHeight As Long) As AddressOf _Font
//	 přednastavený font podle rozlišení
		If DisplayWidth >= 1500 And DisplayHeight >= 900 Then
			Return Value fntSegoeUI50
		Else
			Return Value fntSegoeUI23 
		End If
	End Function
	
	Protected Function SelButtonPic(DisplayWidth As Long,DisplayHeight As Long, Corner As Long)
	// výběr vhodné velikosti obrázku tlačítka podle rozlišení
		Var i As Long := 1
		
		If Corner = BUTTON_STYLE_ROUNDED_CORNER Then
			If DisplayWidth >= 1500 And DisplayHeight >= 900 Then
				Up_Centre 		:= Picture_Active_Up_Centre4
				Up_LUp   	 	:= Picture_Active_Up_LUp4	
				Up_RUp 	 	 	:= Picture_Active_Up_RUp4	
				Up_LDown  	 	:= Picture_Active_Up_LDown4	
				Up_RDown 	 	:= Picture_Active_Up_RDown4		
				Up_LineDown 	:= Picture_Active_Up_LineDown4	
				Up_LineUp  	 	:= Picture_Active_Up_LineUp4	
				Up_LineRight  	:= Picture_Active_Up_LineRight4
				Up_LineLeft 	:= Picture_Active_Up_LineLeft4	
				
				Down_Centre	 	:= Picture_Active_Down_Centre4 
				Down_LUp 	 	:= Picture_Active_Down_LUp4	
				Down_RUp 	 	:= Picture_Active_Down_RUp4
				Down_LDown 	 	:= Picture_Active_Down_LDown4
				Down_RDown 	 	:= Picture_Active_Down_RDown4
				Down_LineDown 	:= Picture_Active_Down_LineDown4
				Down_LineUp 	:= Picture_Active_Down_LineUp4
				Down_LineRight 	:= Picture_Active_Down_LineRight4
				Down_LineLeft 	:= Picture_Active_Down_LineLeft4
				
				Centre 			:= Picture_Active_Color_Centre4
				LUp   	 		:= Picture_Active_Color_LUp4	
				RUp 	 	 	:= Picture_Active_Color_RUp4	
				LDown  	 		:= Picture_Active_Color_LDown4	
				RDown 	 		:= Picture_Active_Color_RDown4		
				LineDown 		:= Picture_Active_Color_LineDown4	
				LineUp  	 	:= Picture_Active_Color_LineUp4	
				LineRight  		:= Picture_Active_Color_LineRight4
				LineLeft 		:= Picture_Active_Color_LineLeft4						
			Else
				Up_Centre 		:= Picture_Active_Up_Centre3
				Up_LUp   	 	:= Picture_Active_Up_LUp3	
				Up_RUp 	 	 	:= Picture_Active_Up_RUp3	
				Up_LDown  	 	:= Picture_Active_Up_LDown3	
				Up_RDown 	 	:= Picture_Active_Up_RDown3		
				Up_LineDown 	:= Picture_Active_Up_LineDown3	
				Up_LineUp  	 	:= Picture_Active_Up_LineUp3	
				Up_LineRight  	:= Picture_Active_Up_LineRight3
				Up_LineLeft 	:= Picture_Active_Up_LineLeft3	
				
				Down_Centre	 	:= Picture_Active_Down_Centre3 
				Down_LUp 	 	:= Picture_Active_Down_LUp3	
				Down_RUp 	 	:= Picture_Active_Down_RUp3
				Down_LDown 	 	:= Picture_Active_Down_LDown3
				Down_RDown 	 	:= Picture_Active_Down_RDown3
				Down_LineDown 	:= Picture_Active_Down_LineDown3
				Down_LineUp 	:= Picture_Active_Down_LineUp3
				Down_LineRight 	:= Picture_Active_Down_LineRight3
				Down_LineLeft 	:= Picture_Active_Down_LineLeft3
				
				Centre 			:= Picture_Active_Color_Centre3
				LUp   	 		:= Picture_Active_Color_LUp3	
				RUp 	 	 	:= Picture_Active_Color_RUp3	
				LDown  	 		:= Picture_Active_Color_LDown3	
				RDown 	 		:= Picture_Active_Color_RDown3		
				LineDown 		:= Picture_Active_Color_LineDown3	
				LineUp  	 	:= Picture_Active_Color_LineUp3	
				LineRight  		:= Picture_Active_Color_LineRight3
				LineLeft 		:= Picture_Active_Color_LineLeft3
			End If
		
		Else

			If DisplayWidth >= 1500 And DisplayHeight >= 900 Then
				RectangleEdge	:= 3
				Up_Centre 		:= Picture_Active_Up_Centre2
				Up_LUp   	 	:= Picture_Active_Up_LUp2	
				Up_RUp 	 	 	:= Picture_Active_Up_RUp2	
				Up_LDown  	 	:= Picture_Active_Up_LDown2	
				Up_RDown 	 	:= Picture_Active_Up_RDown2		
				Up_LineDown 	:= Picture_Active_Up_LineDown2	
				Up_LineUp  	 	:= Picture_Active_Up_LineUp2	
				Up_LineRight  	:= Picture_Active_Up_LineRight2
				Up_LineLeft 	:= Picture_Active_Up_LineLeft2	
				
				Down_Centre	 	:= Picture_Active_Down_Centre2 
				Down_LUp 	 	:= Picture_Active_Down_LUp2	
				Down_RUp 	 	:= Picture_Active_Down_RUp2
				Down_LDown 	 	:= Picture_Active_Down_LDown2
				Down_RDown 	 	:= Picture_Active_Down_RDown2
				Down_LineDown 	:= Picture_Active_Down_LineDown2
				Down_LineUp 	:= Picture_Active_Down_LineUp2
				Down_LineRight 	:= Picture_Active_Down_LineRight2
				Down_LineLeft 	:= Picture_Active_Down_LineLeft2
				
			Else
				RectangleEdge	:= 2
				Up_Centre 		:= Picture_Active_Up_Centre
				Up_LUp   	 	:= Picture_Active_Up_LUp	
				Up_RUp 	 	 	:= Picture_Active_Up_RUp	
				Up_LDown  	 	:= Picture_Active_Up_LDown	
				Up_RDown 	 	:= Picture_Active_Up_RDown		
				Up_LineDown 	:= Picture_Active_Up_LineDown	
				Up_LineUp  	 	:= Picture_Active_Up_LineUp	
				Up_LineRight  	:= Picture_Active_Up_LineRight
				Up_LineLeft 	:= Picture_Active_Up_LineLeft	
				
				Down_Centre	 	:= Picture_Active_Down_Centre 
				Down_LUp 	 	:= Picture_Active_Down_LUp	
				Down_RUp 	 	:= Picture_Active_Down_RUp
				Down_LDown 	 	:= Picture_Active_Down_LDown
				Down_RDown 	 	:= Picture_Active_Down_RDown
				Down_LineDown 	:= Picture_Active_Down_LineDown
				Down_LineUp 	:= Picture_Active_Down_LineUp
				Down_LineRight 	:= Picture_Active_Down_LineRight
				Down_LineLeft 	:= Picture_Active_Down_LineLeft	
						
			End If
		End If
	End Function
	
	Protected Function SetComponentColorUp(Upcolor As Long)
		UpColorOpacity := GetColorComponentOpacity(Upcolor)	
		UpButtonColor := SetColorComponentOpacity(Upcolor,255)
	End Function
	
	Protected Function SetComponentColorDown(downColor As Long)
		DownColorOpacity := GetColorComponentOpacity(downColor)	
		DownButtonColor := SetColorComponentOpacity(downColor,255)
	End Function
	
	Protected Function RedrawCompoundObject()
	
		LockRedraw()
	
		If IsPressed Then
			PictureLayer1.Hide()
			PictureLayer2.Hide()
			Redraw()
	
			PictureLayer3.SetPicture(MDownIcon)
			PictureLayer3.SetOpacity(DrawOpacity)
			PictureLayer3.SetFitting(FITTING_FIT_OBJECT_TO_CONTENT)
			PictureLayer3.SetObjectPosition(DownIconX + DownOffset, DownIconY + DownOffset)
	
			TextLayer.SetFont(MDownFont)
			TextLayer.SetText(MDownText)
			TextLayer.SetColor(DownDrawFontColor)
			TextLayer.SetAlign(DownFormatFlags)
			TextLayer.SetTextOffsetX(MDownTextOffsetX+ DownOffset)
			TextLayer.SetTextOffsetY(MDownTextOffsetY+ DownOffset)
			TextLayer.SetLineSpacing(MDownLineSpacing)
			TextLayer.SetObjectPosition(0, 0)
			TextLayer.SetObjectDimensions(ObjectWidth, ObjectHeight)
			
		Else
			PictureLayer1.Hide()
			PictureLayer2.Hide()
			Redraw()
			
			PictureLayer3.SetPicture(MUpIcon)
			PictureLayer3.SetOpacity(DrawOpacity)
			PictureLayer3.SetFitting(FITTING_FIT_OBJECT_TO_CONTENT)
			PictureLayer3.SetObjectPosition(UpIconX , UpIconY )
			
			TextLayer.SetFont(MUpFont)
			TextLayer.SetText(MUpText)
			TextLayer.SetColor(UpDrawFontColor)
			TextLayer.SetAlign(UpFormatFlags)
			TextLayer.SetTextOffsetX(MUpTextOffsetX)
			TextLayer.SetTextOffsetY(MUpTextOffsetY)
			TextLayer.SetLineSpacing(MUpLineSpacing)
			TextLayer.SetObjectPosition(0, 0)
			TextLayer.SetObjectDimensions(ObjectWidth, ObjectHeight)
		End If

		UnlockRedraw()
	
	End Function
	
	Private Function Draw3DButton(state As Boolean)
		Var Width As Long
		Var Height As Long

		Me.GetSize(Width,Height)
		If ButtonCorner = BUTTON_STYLE_ROUNDED_CORNER Then
			If 	state Then
				DrawStretchedTintedPicture(LineUp,DownButtonColor,Down_RUp.GetWidth(),0,Width-2*Down_RUp.GetWidth(),Down_RUp.GetHeight(),0,0,-1,-1,DownColorOpacity)
				DrawStretchedTintedPicture(LineRight,DownButtonColor,Width-Down_RUp.GetWidth(),Down_RUp.GetHeight(),Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight(),0,0,-1,-1,DownColorOpacity)
				DrawStretchedTintedPicture(LineDown,DownButtonColor,Down_RUp.GetWidth(),Height-Down_RUp.GetHeight(),Width-2*Down_RUp.GetWidth(),Down_RUp.GetHeight(),0,0,-1,-1,DownColorOpacity)
				DrawStretchedTintedPicture(LineLeft,DownButtonColor,0,Down_RUp.GetHeight(),Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight(),0,0,-1,-1,DownColorOpacity)			
				DrawStretchedTintedPicture(Centre,DownButtonColor,Down_RUp.GetWidth(),Down_RUp.GetHeight(),Width-2*Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight(),0,0,-1,-1,DownColorOpacity)

				DrawTintedPicture(LUp,DownButtonColor,0,0,-1,-1,0,0,DownColorOpacity)
				DrawTintedPicture(RUp,DownButtonColor,Width-Down_RUp.GetWidth(),0,-1,-1,0,0,DownColorOpacity)
				DrawTintedPicture(LDown,DownButtonColor,0,Height-Down_RUp.GetHeight(),-1,-1,0,0,DownColorOpacity)
				DrawTintedPicture(RDown,DownButtonColor,Width-Down_RUp.GetWidth(),Height-Down_RUp.GetHeight(),-1,-1,0,0,DownColorOpacity)	
			Else
				DrawStretchedTintedPicture(LineUp,UpButtonColor,Down_RUp.GetWidth(),0,Width-2*Down_RUp.GetWidth(),Down_RUp.GetHeight(),0,0,-1,-1,UpColorOpacity)
				DrawStretchedTintedPicture(LineRight,UpButtonColor,Width-Down_RUp.GetWidth(),Down_RUp.GetHeight(),Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight(),0,0,-1,-1,UpColorOpacity)
				DrawStretchedTintedPicture(LineDown,UpButtonColor,Down_RUp.GetWidth(),Height-Down_RUp.GetHeight(),Width-2*Down_RUp.GetWidth(),Down_RUp.GetHeight(),0,0,-1,-1,UpColorOpacity)
				DrawStretchedTintedPicture(LineLeft,UpButtonColor,0,Down_RUp.GetHeight(),Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight(),0,0,-1,-1,UpColorOpacity)			
				DrawStretchedTintedPicture(Centre,UpButtonColor,Down_RUp.GetWidth(),Down_RUp.GetHeight(),Width-2*Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight(),0,0,-1,-1,UpColorOpacity)
			
				DrawTintedPicture(LUp,UpButtonColor,0,0,-1,-1,0,0,UpColorOpacity)
				DrawTintedPicture(RUp,UpButtonColor,Width-Down_RUp.GetWidth(),0,-1,-1,0,0,UpColorOpacity)
				DrawTintedPicture(LDown,UpButtonColor,0,Height-Down_RUp.GetHeight(),-1,-1,0,0,UpColorOpacity)
				DrawTintedPicture(RDown,UpButtonColor,Width-Down_RUp.GetWidth(),Height-Down_RUp.GetHeight(),-1,-1,0,0,UpColorOpacity)
			End If	
		Else	
			If 	state Then
				DrawRectangle(DownColor,RectangleEdge,RectangleEdge,Width-2*RectangleEdge,Height-2*RectangleEdge)
			Else
				DrawRectangle(UpColor,RectangleEdge,RectangleEdge,Width-2*RectangleEdge,Height-2*RectangleEdge)
			End If
		End If
		
			If 	state Then
				DrawStretchedPicture(Down_LineUp,Down_RUp.GetWidth(),0,Width-2*Down_RUp.GetWidth(),Down_RUp.GetHeight())
				DrawStretchedPicture(Down_LineRight,Width-Down_RUp.GetWidth(),Down_RUp.GetHeight(),Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight())
				DrawStretchedPicture(Down_LineDown,Down_RUp.GetWidth(),Height-Down_RUp.GetHeight(),Width-2*Down_RUp.GetWidth(),Down_RUp.GetHeight())
				DrawStretchedPicture(Down_LineLeft,0,Down_RUp.GetHeight(),Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight())			
				DrawStretchedPicture(Down_Centre,Down_RUp.GetWidth(),Down_RUp.GetHeight(),Width-2*Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight())
			
				DrawPicture(Down_LUp,0,0)
				DrawPicture(Down_RUp,Width-Down_RUp.GetWidth(),0)
				DrawPicture(Down_LDown,0,Height-Down_RUp.GetHeight())
				DrawPicture(Down_RDown,Width-Down_RUp.GetWidth(),Height-Down_RUp.GetHeight())			
			Else						
				DrawStretchedPicture(Up_LineUp,Up_RUp.GetWidth(),0,Width-2*Up_RUp.GetWidth(),Up_RUp.GetHeight())
				DrawStretchedPicture(Up_LineRight,Width-Up_RUp.GetWidth(),Up_RUp.GetHeight(),Up_RUp.GetWidth(),Height-2*Up_RUp.GetHeight())
				DrawStretchedPicture(Up_LineDown,Up_RUp.GetWidth(),Height-Up_RUp.GetHeight(),Width-2*Up_RUp.GetWidth(),Up_RUp.GetHeight())
				DrawStretchedPicture(Up_LineLeft,0,Up_RUp.GetHeight(),Up_RUp.GetWidth(),Height-2*Up_RUp.GetHeight())
				DrawStretchedPicture(Up_Centre,Up_RUp.GetWidth(),Up_RUp.GetHeight(),Width-2*Up_RUp.GetWidth(),Height-2*Up_RUp.GetHeight())
			
				DrawPicture(Up_LUp,0,0)
				DrawPicture(Up_RUp,Width-Up_RUp.GetWidth(),0)
				DrawPicture(Up_LDown,0,Height-Up_RUp.GetHeight())
				DrawPicture(Up_RDown,Width-Up_RUp.GetWidth(),Height-Up_RUp.GetHeight())
			End If
		
	End Function	

	Public Function SetButtonStyle(newbuttonstyle As Long) As Boolean
		If newbuttonstyle  = BUTTON_STYLE_ROUNDED_CORNER Then
			DownOffset := 1
		Else
			DownOffset := 0
		End If
		ButtonCorner := newbuttonstyle
		SelButtonPic(GetPrimaryDisplay().GetWidth(),GetPrimaryDisplay().GetHeight(),ButtonCorner)
		UpdateDimensions()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetButtonStyle() As Long
		Return Value ButtonCorner
	End Function
	
//colors button
	Public Function SetDownColor(newdowncolor As Long) As Boolean
		DownColor := newdowncolor
		SetComponentColorDown(newdowncolor)
		RedrawCompoundObject()
		Return Value True
	End Function
	
	Public Function SetUpColor(newupcolor As Long) As Boolean
		UpColor := newupcolor
		SetComponentColorUp(newupcolor)
		RedrawCompoundObject()
		Return Value True	
	End Function
		
	Public Function GetDownColor() As Long
		Return Value DownColor
	End Function
	
	Public Function GetUpColor() As Long
		Return Value UpColor
	End Function
	
// text
//up
	Public Function SetUpFont(newupfont As AddressOf _Font) As Boolean
		MUpFont := newupfont
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpFont() As AddressOf _Font
		Return Value MUpFont	
	End Function
		
	Public Function SetUpFontColor(newupfontcolor As Long) As Boolean
		MUpFontColor := newupfontcolor
		UpdateDrawColors()
		RedrawCompoundObject()
		Return Value True	
	End Function
		
	Public Function GetUpFontColor() As Long
		Return Value MUpFontColor
	End Function

	Public Function SetUpLineSpacing(newuplinespacing As Double) As Boolean	
		If newuplinespacing >= 0 Then
			MUpLineSpacing := newuplinespacing
			RedrawCompoundObject()
			Return Value True
		Else
			Return Value False
		End If
	End Function
	
	Public Function GetUpLineSpacing() As Double
		Return Value MUpLineSpacing	
	End Function
	
	Public Function SetUpText(newuptext As Text) As Boolean
		If GetMemorySegment(newuptext) = _MSEG_RESOURCEDATA Then
			MUpText := newuptext
		Else
			TextBuffer := newuptext
			MUpText := TextBuffer
		End If
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpText() As AddressOf Text
		Return Value MUpText	
	End Function
	
	Public Function SetUpTextAlign(newuptextalign As Long) As Boolean
		Select newuptextalign
			Case _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNTOP, _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNVCENTER, _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNBOTTOM, _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNTOP, _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNVCENTER, _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNBOTTOM, _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNTOP, _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNVCENTER, _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNBOTTOM
				MUpTextAlign := newuptextalign
				UpFormatFlags := MUpTextAlign BitOr _TEXT_WORDWRAP
				RedrawCompoundObject()
				Return Value True
	
			Case Else
				Return Value False
		End Select
	End Function
	
	Public Function GetUpTextAlign() As Long
		Return Value MUpTextAlign
	End Function
	
	Public Function SetUpTextOffsetX(newuptextoffsetx As Long) As Boolean	
		MUpTextOffsetX := newuptextoffsetx 
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpTextOffsetX() As Long
		Return Value MUpTextOffsetX	
	End Function
	
	Public Function SetUpTextOffsetY(newuptextoffsety As Long) As Boolean
		MUpTextOffsetY := newuptextoffsety 
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpTextOffsetY() As Long
		Return Value MUpTextOffsetY	
	End Function
//down	
	Public Function SetDownFont(newdownfont As AddressOf _Font) As Boolean
		MDownFont := newdownfont
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownFont() As AddressOf _Font
		Return Value MDownFont	
	End Function
		
	Public Function SetDownFontColor(newdownfontcolor As Long) As Boolean
		MDownFontColor := newdownfontcolor
		UpdateDrawColors()
		RedrawCompoundObject()
		Return Value True	
	End Function
		
	Public Function GetDownFontColor() As Long
		Return Value MDownFontColor
	End Function

	Public Function SetDownLineSpacing(newdownlinespacing As Double) As Boolean	
		If newdownlinespacing >= 0 Then
			MDownLineSpacing := newdownlinespacing
			RedrawCompoundObject()
			Return Value True
		Else
			Return Value False
		End If
	End Function
	
	Public Function GetDownLineSpacing() As Double
		Return Value MDownLineSpacing	
	End Function
	
	Public Function SetDownText(newdowntext As Text) As Boolean
		If GetMemorySegment(newdowntext) = _MSEG_RESOURCEDATA Then
			MDownText := newdowntext
		Else
			TextBuffer := newdowntext
			MDownText := TextBuffer
		End If
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownText() As AddressOf Text
		Return Value MDownText	
	End Function
	
	Public Function SetDownTextAlign(newdowntextalign As Long) As Boolean
		Select newdowntextalign
			Case _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNTOP, _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNVCENTER, _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNBOTTOM, _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNTOP, _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNVCENTER, _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNBOTTOM, _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNTOP, _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNVCENTER, _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNBOTTOM
				MDownTextAlign := newdowntextalign
				DownFormatFlags := MDownTextAlign BitOr _TEXT_WORDWRAP
				RedrawCompoundObject()
				Return Value True
	
			Case Else
				Return Value False
		End Select
	End Function
	
	Public Function GetDownTextAlign() As Long
		Return Value MDownTextAlign
	End Function
	
	Public Function SetDownTextOffsetX(newdowntextoffsetx As Long) As Boolean	
		MDownTextOffsetX := newdowntextoffsetx 
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownTextOffsetX() As Long
		Return Value MDownTextOffsetX	
	End Function
	
	Public Function SetDownTextOffsetY(newdowntextoffsety As Long) As Boolean
		MDownTextOffsetY := newdowntextoffsety 
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownTextOffsetY() As Long
		Return Value MDownTextOffsetY	
	End Function
// icon
// up 
	Public Function SetUpIcon(newupicon As AddressOf _Picture) As Boolean
		MUpIcon := newupicon
		UpdateIconPosition()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpIcon() As AddressOf _Picture
		Return Value MUpIcon	
	End Function
	
	Public Function SetUpIconAlign(newupiconalign As Long) As Boolean
		Select newupiconalign
			Case ICON_ALIGNLEFT BitOr ICON_ALIGNTOP, ICON_ALIGNLEFT BitOr ICON_ALIGNVCENTER, ICON_ALIGNLEFT BitOr ICON_ALIGNBOTTOM, ICON_ALIGNHCENTER BitOr ICON_ALIGNTOP, ICON_ALIGNHCENTER BitOr ICON_ALIGNVCENTER, ICON_ALIGNHCENTER BitOr ICON_ALIGNBOTTOM, ICON_ALIGNRIGHT BitOr ICON_ALIGNTOP, ICON_ALIGNRIGHT BitOr ICON_ALIGNVCENTER, ICON_ALIGNRIGHT BitOr ICON_ALIGNBOTTOM
				MUpIconAlign := newupiconalign
				UpdateIconPosition()
				RedrawCompoundObject()
				Return Value True
	
			Case Else
				Return Value False
		End Select
	End Function
	
	Public Function GetUpIconAlign() As Long
		Return Value MUpIconAlign
	End Function
	
	Public Function SetUpIconOffsetX(newupiconoffsetx As Long) As Boolean	
		MUpIconOffsetX := newupiconoffsetx 
		UpdateIconPosition()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpIconOffsetX() As Long
		Return Value MUpIconOffsetX	
	End Function
	
	Public Function SetUpIconOffsetY(newupiconoffsety As Long) As Boolean	
		MUpIconOffsetY := newupiconoffsety 
		UpdateIconPosition()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpIconOffsetY() As Long
		Return Value MUpIconOffsetY	
	End Function
// down
	Public Function SetDownIcon(newdownicon As AddressOf _Picture) As Boolean
		MDownIcon := newdownicon
		UpdateIconPosition()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownIcon() As AddressOf _Picture
		Return Value MDownIcon	
	End Function
	
	Public Function SetDownIconAlign(newdowniconalign As Long) As Boolean
		Select newdowniconalign
			Case ICON_ALIGNLEFT BitOr ICON_ALIGNTOP, ICON_ALIGNLEFT BitOr ICON_ALIGNVCENTER, ICON_ALIGNLEFT BitOr ICON_ALIGNBOTTOM, ICON_ALIGNHCENTER BitOr ICON_ALIGNTOP, ICON_ALIGNHCENTER BitOr ICON_ALIGNVCENTER, ICON_ALIGNHCENTER BitOr ICON_ALIGNBOTTOM, ICON_ALIGNRIGHT BitOr ICON_ALIGNTOP, ICON_ALIGNRIGHT BitOr ICON_ALIGNVCENTER, ICON_ALIGNRIGHT BitOr ICON_ALIGNBOTTOM
				MDownIconAlign := newdowniconalign
				UpdateIconPosition()
				RedrawCompoundObject()
				Return Value True
	
			Case Else
				Return Value False
		End Select
	End Function
	
	Public Function GetDownIconAlign() As Long
		Return Value MDownIconAlign
	End Function
	
	Public Function SetDownIconOffsetX(newdowniconoffsetx As Long) As Boolean	
		MDownIconOffsetX := newdowniconoffsetx 
		UpdateIconPosition()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownIconOffsetX() As Long
		Return Value MDownIconOffsetX	
	End Function
	
	Public Function SetDownIconOffsetY(newdowniconoffsety As Long) As Boolean	
		MDownIconOffsetY := newdowniconoffsety 
		UpdateIconPosition()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownIconOffsetY() As Long
		Return Value MDownIconOffsetY	
	End Function

	Public Function SetObjectDimensions(newwidth As Long, newheight As Long) As Boolean
		SetSize(newwidth, newheight)
		UpdateDimensions()
		RedrawCompoundObject()
		Return Value True
	End Function

	Public Function GetObjectDimensions(ByRef currentwidth As Long, ByRef currentheight As Long)
		GetSize(currentwidth, currentheight)
	End Function

	Public Function SetObjectPosition(newx As Long, newy As Long) As Boolean
		Var Response As Boolean
		Response := SetPosition(newx, newy)
		RedrawCompoundObject()
		Return Value Response
	End Function
	
	Public Function GetObjectPosition(ByRef currentx As Long, ByRef currenty As Long)
		GetPosition(currentx, currenty)
	End Function
	
End GraphicClass

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

Global GraphicClass RadioButton Inherits Namespace "CUE.GraphicCollection.GenericObjectsBase.3".BaseRadioButton WithAttributes {defaultwidth := 120, defaultheight := 80,ObjectCode := "OB0078-001", DesignName := "Multicolor", GroupName := "Buttons"}
	Public Const BUTTON_STYLE_ROUNDED_CORNER				As Long	:= 1	
	Public Const BUTTON_STYLE_SHARP_CORNER				As Long	:= 2
	
	Global Const ICON_ALIGNLEFT As Long := &H00000001	// Horizontal align left
	Global Const ICON_ALIGNHCENTER As Long := &H00000002	// Horizontal align center
	Global Const ICON_ALIGNRIGHT As Long :=	&H00000004	// Horizontal align right
	Global Const ICON_ALIGNTOP As Long := &H00000008	// Vertical align top
	Global Const ICON_ALIGNVCENTER As Long := &H00000010	// Vertical align center
	Global Const ICON_ALIGNBOTTOM As Long := &H00000020	// Vertical align bottom

	
	// Behavior Property Group
	Protected Property Enabled 							As Boolean := True WithAttributes {PropertyGroup := "Behavior", EditMode := "Boolean; 'Yes' := True, 'No' := False"}
	Protected Property DefaultState 					As Boolean := False WithAttributes {PropertyGroup := "Behavior", EditMode := "Enum; 'Down' := True, 'Up' := False"}
	Protected Property ButtonCorner						As Long := BUTTON_STYLE_ROUNDED_CORNER WithAttributes {PropertyGroup := "Appearance",DisplayName := "ButtonStyle", EditMode:= "Enum; 'Sharp Corner' := BUTTON_STYLE_SHARP_CORNER, 'Rounded Corner' := BUTTON_STYLE_ROUNDED_CORNER"}
	Protected Property NavigationBarButtonID 			As Long := 0 WithAttributes {PropertyGroup := "Behavior"}

	Protected Var		ButtonFont						As AddressOf _Font := GetButtonFont(GetPrimaryDisplay().GetWidth(),GetPrimaryDisplay().GetHeight()) 
	Protected Var		RectangleEdge					As Long := 2
	Protected Var		DownButtonColor					As Long := Namespace "CUE.GraphicCollection.MulticolorPalette.1".COLOR_ORANGE
	Protected Var		UpButtonColor					As Long := Namespace "CUE.GraphicCollection.MulticolorPalette.1".COLOR_ORANGE
	
	// Up Property Group
	Protected Property UpColor As Long := ColorUp() WithAttributes {PropertyGroup := "Up", EditMode := "color"}		
	
	Protected Var UpColorOpacity As Byte := 204 	
	Protected Property UpFont As AddressOf _Font := ButtonFont WithAttributes {PropertyGroup := "Up", EditMode := "font"}
	Protected Property UpFontColor As Long := FontColorUp() WithAttributes {PropertyGroup := "Up", EditMode := "color"}
	Protected Property UpIcon As AddressOf _Picture := Nothing WithAttributes {PropertyGroup := "Up"}
	Protected Property UpIconAlign As Long := ICON_ALIGNHCENTER BitOr ICON_ALIGNVCENTER WithAttributes {PropertyGroup := "Up", EditMode := "ENUM; 'Left-Top' := &H09, 'Left-Middle' := &H11, 'Left-Bottom' := &H21, 'Center-Top' := &H0A, 'Center-Middle' := &H12, 'Center-Bottom' := &H22, 'Right-Top' := &H0C, 'Right-Middle' := &H14, 'Right-Bottom' := &H24"}
	Protected Property UpIconOffsetX As Long := 0 WithAttributes {PropertyGroup := "Up"}
	Protected Property UpIconOffsetY As Long := 0 WithAttributes {PropertyGroup := "Up"}
	Protected Property UpLineSpacing As Double := 1.2 WithAttributes {PropertyGroup := "Up"}
	Protected Property UpText As AddressOf Text := txtCaption WithAttributes {PropertyGroup := "Up"}
	Protected Property UpTextAlign As Long := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNVCENTER WithAttributes {PropertyGroup := "Up", EditMode := "ENUM; 'Left-Top' := _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNTOP, 'Left-Middle' := _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNVCENTER, 'Left-Bottom' := _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNBOTTOM, 'Center-Top' := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNTOP, 'Center-Middle' := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNVCENTER, 'Center-Bottom' := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNBOTTOM, 'Right-Top' := _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNTOP, 'Right-Middle' := _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNVCENTER, 'Right-Bottom' := _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNBOTTOM"}
	Protected Property UpTextOffsetX As Long := 0 WithAttributes {PropertyGroup := "Up"}
	Protected Property UpTextOffsetY As Long := 0 WithAttributes {PropertyGroup := "Up"}

	// Down Property Group
	Protected Property DownColor As Long := ColorDown() WithAttributes {PropertyGroup := "Down", EditMode := "color"}

	Protected Var DownColorOpacity As Byte := UpColorOpacity
	Protected Property DownFont As AddressOf _Font := UpFont WithAttributes {PropertyGroup := "Down", EditMode := "font"}
	Protected Property DownFontColor As Long := _COLOR_BLACK WithAttributes {PropertyGroup := "Down", EditMode := "color"}
	Protected Property DownIcon As AddressOf _Picture := UpIcon WithAttributes {PropertyGroup := "Down"}
	Protected Property DownIconAlign As Long := UpIconAlign WithAttributes {PropertyGroup := "Down", EditMode := "ENUM; 'Left-Top' := &H09, 'Left-Middle' := &H11, 'Left-Bottom' := &H21, 'Center-Top' := &H0A, 'Center-Middle' := &H12, 'Center-Bottom' := &H22, 'Right-Top' := &H0C, 'Right-Middle' := &H14, 'Right-Bottom' := &H24"}
	Protected Property DownIconOffsetX As Long := UpIconOffsetX WithAttributes {PropertyGroup := "Down"}
	Protected Property DownIconOffsetY As Long := UpIconOffsetY WithAttributes {PropertyGroup := "Down"}
	Protected Property DownLineSpacing As Double := UpLineSpacing WithAttributes {PropertyGroup := "Down"}
	Protected Property DownText As AddressOf Text := UpText WithAttributes {PropertyGroup := "Down"}
	Protected Property DownTextAlign As Long := UpTextAlign WithAttributes {PropertyGroup := "Down", EditMode := "ENUM; 'Left-Top' := _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNTOP, 'Left-Middle' := _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNVCENTER, 'Left-Bottom' := _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNBOTTOM, 'Center-Top' := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNTOP, 'Center-Middle' := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNVCENTER, 'Center-Bottom' := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNBOTTOM, 'Right-Top' := _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNTOP, 'Right-Middle' := _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNVCENTER, 'Right-Bottom' := _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNBOTTOM"}
	Protected Property DownTextOffsetX As Long := UpTextOffsetX WithAttributes {PropertyGroup := "Down"}
	Protected Property DownTextOffsetY As Long := UpTextOffsetY WithAttributes {PropertyGroup := "Down"}

	Protected Var		Picture_Active_Up_Centre 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LUp 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RUp 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LDown 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RDown 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineDown 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineUp 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineRight 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineLeft 		As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Down_Centre	 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LUp			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RUp			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LDown		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RDown 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineDown 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineUp		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineRight 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineLeft	As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Up_Centre2 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LUp2 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RUp2 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LDown2 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RDown2 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineDown2 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineUp2 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineRight2 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineLeft2		As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Down_Centre2	 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LUp2		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RUp2		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LDown2		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RDown2 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineDown2 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineUp2		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineRight2 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineLeft2	As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Up_Centre3 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LUp3 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RUp3 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LDown3 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RDown3 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineDown3 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineUp3 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineRight3 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineLeft3		As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Down_Centre3	 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LUp3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RUp3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LDown3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RDown3 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineDown3 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineUp3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineRight3 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineLeft3	As AddressOf _Picture := Nothing

	Protected Var		Picture_Active_Color_Centre3	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LUp3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_RUp3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LDown3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_RDown3 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineDown3 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineUp3	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineRight3 As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineLeft3	As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Up_Centre4 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LUp4 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RUp4 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LDown4 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RDown4 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineDown4 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineUp4 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineRight4 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineLeft4		As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Down_Centre4	 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LUp4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RUp4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LDown4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RDown4 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineDown4 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineUp4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineRight4 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineLeft4	As AddressOf _Picture := Nothing

	Protected Var		Picture_Active_Color_Centre4	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LUp4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_RUp4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LDown4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_RDown4 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineDown4 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineUp4	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineRight4 As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineLeft4	As AddressOf _Picture := Nothing
	
	Protected Var		Up_Centre 		As AddressOf _Picture := Nothing
	Protected Var		Up_LUp 			As AddressOf _Picture := Nothing
	Protected Var		Up_RUp 			As AddressOf _Picture := Nothing
	Protected Var		Up_LDown 		As AddressOf _Picture := Nothing
	Protected Var		Up_RDown 		As AddressOf _Picture := Nothing
	Protected Var		Up_LineDown 	As AddressOf _Picture := Nothing
	Protected Var		Up_LineUp 		As AddressOf _Picture := Nothing
	Protected Var		Up_LineRight 	As AddressOf _Picture := Nothing
	Protected Var		Up_LineLeft 	As AddressOf _Picture := Nothing
	
	Protected Var		Down_Centre	 	As AddressOf _Picture := Nothing
	Protected Var		Down_LUp		As AddressOf _Picture := Nothing
	Protected Var		Down_RUp		As AddressOf _Picture := Nothing
	Protected Var		Down_LDown		As AddressOf _Picture := Nothing
	Protected Var		Down_RDown 		As AddressOf _Picture := Nothing
	Protected Var		Down_LineDown 	As AddressOf _Picture := Nothing
	Protected Var		Down_LineUp		As AddressOf _Picture := Nothing
	Protected Var		Down_LineRight 	As AddressOf _Picture := Nothing
	Protected Var		Down_LineLeft	As AddressOf _Picture := Nothing

	Protected Var		Centre 			As AddressOf _Picture := Nothing
	Protected Var		LUp   			As AddressOf _Picture := Nothing 		
	Protected Var		RUp 			As AddressOf _Picture := Nothing 	 	
	Protected Var		LDown  	 		As AddressOf _Picture := Nothing		
	Protected Var		RDown 	 		As AddressOf _Picture := Nothing		
	Protected Var		LineDown 		As AddressOf _Picture := Nothing	
	Protected Var		LineUp  		As AddressOf _Picture := Nothing 		
	Protected Var		LineRight  		As AddressOf _Picture := Nothing	
	Protected Var		LineLeft 		As AddressOf _Picture := Nothing	


	Protected Function InitObject()
		Picture_Active_Up_Centre			:= Nothing
		Picture_Active_Up_LUp 				:= picButton_LeftUp_Corner
		Picture_Active_Up_RUp 				:= picButton_RightUp_Corner
		Picture_Active_Up_LDown 			:= picButton_LeftDown_Corner
		Picture_Active_Up_RDown 			:= picButton_RightDown_Corner
		Picture_Active_Up_LineDown 			:= picButton_Down_Line
		Picture_Active_Up_LineUp 			:= picButton_Up_Line
		Picture_Active_Up_LineRight 		:= picButton_Right_Line
		Picture_Active_Up_LineLeft 			:= picButton_Left_Line
	
		Picture_Active_Down_LUp				:= picButton_LeftUp_Corner
		Picture_Active_Down_RUp				:= picButton_RightUp_Corner
		Picture_Active_Down_LDown			:= picButton_LeftDown_Corner
		Picture_Active_Down_RDown 			:= picButton_RightDown_Corner
		Picture_Active_Down_LineDown 		:= picButton_Down_Line
		Picture_Active_Down_LineUp			:= picButton_Up_Line
		Picture_Active_Down_LineRight 		:= picButton_Right_Line
		Picture_Active_Down_LineLeft		:= picButton_Left_Line
		
		Picture_Active_Up_Centre2			:= Nothing		
		Picture_Active_Up_LUp2 				:= picButton_LeftUp_Corner1
		Picture_Active_Up_RUp2 				:= picButton_RightUp_Corner1
		Picture_Active_Up_LDown2 			:= picButton_LeftDown_Corner1
		Picture_Active_Up_RDown2 			:= picButton_RightDown_Corner1
		Picture_Active_Up_LineDown2 		:= picButton_Down_Line1
		Picture_Active_Up_LineUp2 			:= picButton_Up_Line1
		Picture_Active_Up_LineRight2 		:= picButton_Right_Line1
		Picture_Active_Up_LineLeft2 		:= picButton_Left_Line1
	
		Picture_Active_Down_LUp2			:= picButton_LeftUp_Corner1
		Picture_Active_Down_RUp2			:= picButton_RightUp_Corner1
		Picture_Active_Down_LDown2			:= picButton_LeftDown_Corner1
		Picture_Active_Down_RDown2 			:= picButton_RightDown_Corner1
		Picture_Active_Down_LineDown2 		:= picButton_Down_Line1
		Picture_Active_Down_LineUp2			:= picButton_Up_Line1
		Picture_Active_Down_LineRight2 		:= picButton_Right_Line1
		Picture_Active_Down_LineLeft2		:= picButton_Left_Line1	
		
		Picture_Active_Up_Centre3			:= picButton_Centre3
		Picture_Active_Up_LUp3 				:= picButton_LeftUp_Corner3
		Picture_Active_Up_RUp3 				:= picButton_RightUp_Corner3
		Picture_Active_Up_LDown3 			:= picButton_LeftDown_Corner3
		Picture_Active_Up_RDown3 			:= picButton_RightDown_Corner3
		Picture_Active_Up_LineDown3 		:= picButton_Down_Line3
		Picture_Active_Up_LineUp3 			:= picButton_Up_Line3
		Picture_Active_Up_LineRight3 		:= picButton_Right_Line3
		Picture_Active_Up_LineLeft3 		:= picButton_Left_Line3

		Picture_Active_Down_Centre3			:= picButton_Centre_down3	
		Picture_Active_Down_LUp3			:= picButton_LeftUp_Corner_down3
		Picture_Active_Down_RUp3			:= picButton_RightUp_Corner_down3
		Picture_Active_Down_LDown3			:= picButton_LeftDown_Corner_down3
		Picture_Active_Down_RDown3 			:= picButton_RightDown_Corner_down3
		Picture_Active_Down_LineDown3 		:= picButton_Down_Line_down3
		Picture_Active_Down_LineUp3			:= picButton_Up_Line_down3
		Picture_Active_Down_LineRight3 		:= picButton_Right_Line_down3
		Picture_Active_Down_LineLeft3		:= picButton_Left_Line_down3
		
		Picture_Active_Color_Centre3		:= picButton_Centre_color3
		Picture_Active_Color_LUp3			:= picButton_LeftUp_Corner_color3
		Picture_Active_Color_RUp3			:= picButton_RightUp_Corner_color3
		Picture_Active_Color_LDown3			:= picButton_LeftDown_Corner_color3
		Picture_Active_Color_RDown3 		:= picButton_RightDown_Corner_color3
		Picture_Active_Color_LineDown3 		:= picButton_Down_Line_color3
		Picture_Active_Color_LineUp3		:= picButton_Up_Line_color3
		Picture_Active_Color_LineRight3 	:= picButton_Right_Line_color3
		Picture_Active_Color_LineLeft3		:= picButton_Left_Line_color3
		
		Picture_Active_Up_Centre4			:= picButton_Centre2
		Picture_Active_Up_LUp4 				:= picButton_LeftUp_Corner2
		Picture_Active_Up_RUp4 				:= picButton_RightUp_Corner2
		Picture_Active_Up_LDown4 			:= picButton_LeftDown_Corner2
		Picture_Active_Up_RDown4 			:= picButton_RightDown_Corner2
		Picture_Active_Up_LineDown4 		:= picButton_Down_Line2
		Picture_Active_Up_LineUp4 			:= picButton_Up_Line2
		Picture_Active_Up_LineRight4 		:= picButton_Right_Line2
		Picture_Active_Up_LineLeft4 		:= picButton_Left_Line2

		Picture_Active_Down_Centre4			:= picButton_Centre_down2	
		Picture_Active_Down_LUp4			:= picButton_LeftUp_Corner_down2
		Picture_Active_Down_RUp4			:= picButton_RightUp_Corner_down2
		Picture_Active_Down_LDown4			:= picButton_LeftDown_Corner_down2
		Picture_Active_Down_RDown4 			:= picButton_RightDown_Corner_down2
		Picture_Active_Down_LineDown4 		:= picButton_Down_Line_down2
		Picture_Active_Down_LineUp4			:= picButton_Up_Line_down2
		Picture_Active_Down_LineRight4 		:= picButton_Right_Line_down2
		Picture_Active_Down_LineLeft4		:= picButton_Left_Line_down2
		
		Picture_Active_Color_Centre4		:= picButton_Centre_color2
		Picture_Active_Color_LUp4			:= picButton_LeftUp_Corner_color2
		Picture_Active_Color_RUp4			:= picButton_RightUp_Corner_color2
		Picture_Active_Color_LDown4			:= picButton_LeftDown_Corner_color2
		Picture_Active_Color_RDown4 		:= picButton_RightDown_Corner_color2
		Picture_Active_Color_LineDown4 		:= picButton_Down_Line_color2
		Picture_Active_Color_LineUp4		:= picButton_Up_Line_color2
		Picture_Active_Color_LineRight4 	:= picButton_Right_Line_color2
		Picture_Active_Color_LineLeft4		:= picButton_Left_Line_color2	
	End Function

	Protected Function Init()
		GetProperty()
		InitObject()
		SetComponentColorUp(UpColor)
		SetComponentColorDown(DownColor)
		IsPressed := DefaultState
		SelButtonPic(GetPrimaryDisplay().GetWidth(),GetPrimaryDisplay().GetHeight(),ButtonCorner)
		UpFormatFlags := MUpTextAlign BitOr _TEXT_WORDWRAP
		DownFormatFlags := MDownTextAlign BitOr _TEXT_WORDWRAP
		UpdateDimensions()
		UpdateDrawColors()
		If ButtonCorner = BUTTON_STYLE_ROUNDED_CORNER Then
			DownOffset := 1
		Else
			DownOffset := 0
		End If
		RedrawCompoundObject()
	End Function
	
	Protected Function ColorUp()As Long
		If ButtonCorner = BUTTON_STYLE_ROUNDED_CORNER Then
			Return Value COLOR_ORANGE
		Else
			Return Value COLOR_GREYDARK
		End If
	End Function
	
	Protected Function ColorDown()As Long
		If ButtonCorner = BUTTON_STYLE_ROUNDED_CORNER Then
			Return Value COLOR_ORANGE
		Else
			Return Value COLOR_WHITE
		End If
	End Function
	
	Protected Function FontColorUp() As Long
		If ButtonCorner = BUTTON_STYLE_ROUNDED_CORNER Then
			Return Value _COLOR_BLACK
		Else
			Return Value _COLOR_WHITE
		End If	
	End Function
		
	Protected Function GetProperty()
	// Předání hodnot proměnným v bázové třídě
		MDefaultState			:= DefaultState	
		MNavigationBarButtonID	:= NavigationBarButtonID
		MEnabled				:= Enabled
		MUpFont					:= UpFont
		MUpFontColor			:= UpFontColor
		MUpIcon					:= UpIcon
		MUpIconAlign			:= UpIconAlign
		MUpIconOffsetX			:= UpIconOffsetX
		MUpIconOffsetY			:= UpIconOffsetY
		MUpLineSpacing			:= UpLineSpacing
		MUpText					:= UpText
		MUpTextAlign			:= UpTextAlign
		MUpTextOffsetX			:= UpTextOffsetX
		MUpTextOffsetY			:= UpTextOffsetY
		MDownFont				:= DownFont
		MDownFontColor			:= DownFontColor
		MDownIcon				:= DownIcon
		MDownIconAlign			:= DownIconAlign
		MDownIconOffsetX		:= DownIconOffsetX
		MDownIconOffsetY		:= DownIconOffsetY
		MDownLineSpacing		:= DownLineSpacing
		MDownText				:= DownText
		MDownTextAlign			:= DownTextAlign
		MDownTextOffsetX		:= DownTextOffsetX
		MDownTextOffsetY		:= DownTextOffsetY
	End Function
	
	Protected Function GetButtonFont(DisplayWidth As Long,DisplayHeight As Long) As AddressOf _Font
//	 přednastavený font podle rozlišení
		If DisplayWidth >= 1500 And DisplayHeight >= 900 Then
			Return Value fntSegoeUI50
		Else
			Return Value fntSegoeUI23 
		End If
	End Function
	
	Protected Function SelButtonPic(DisplayWidth As Long,DisplayHeight As Long, Corner As Long)
	// výběr vhodné velikosti obrázku tlačítka podle rozlišení
		Var i As Long := 1
		
		If Corner = BUTTON_STYLE_ROUNDED_CORNER Then
			If DisplayWidth >= 1500 And DisplayHeight >= 900 Then
				Up_Centre 		:= Picture_Active_Up_Centre4
				Up_LUp   	 	:= Picture_Active_Up_LUp4	
				Up_RUp 	 	 	:= Picture_Active_Up_RUp4	
				Up_LDown  	 	:= Picture_Active_Up_LDown4	
				Up_RDown 	 	:= Picture_Active_Up_RDown4		
				Up_LineDown 	:= Picture_Active_Up_LineDown4	
				Up_LineUp  	 	:= Picture_Active_Up_LineUp4	
				Up_LineRight  	:= Picture_Active_Up_LineRight4
				Up_LineLeft 	:= Picture_Active_Up_LineLeft4	
				
				Down_Centre	 	:= Picture_Active_Down_Centre4 
				Down_LUp 	 	:= Picture_Active_Down_LUp4	
				Down_RUp 	 	:= Picture_Active_Down_RUp4
				Down_LDown 	 	:= Picture_Active_Down_LDown4
				Down_RDown 	 	:= Picture_Active_Down_RDown4
				Down_LineDown 	:= Picture_Active_Down_LineDown4
				Down_LineUp 	:= Picture_Active_Down_LineUp4
				Down_LineRight 	:= Picture_Active_Down_LineRight4
				Down_LineLeft 	:= Picture_Active_Down_LineLeft4
				
				Centre 			:= Picture_Active_Color_Centre4
				LUp   	 		:= Picture_Active_Color_LUp4	
				RUp 	 	 	:= Picture_Active_Color_RUp4	
				LDown  	 		:= Picture_Active_Color_LDown4	
				RDown 	 		:= Picture_Active_Color_RDown4		
				LineDown 		:= Picture_Active_Color_LineDown4	
				LineUp  	 	:= Picture_Active_Color_LineUp4	
				LineRight  		:= Picture_Active_Color_LineRight4
				LineLeft 		:= Picture_Active_Color_LineLeft4						
			Else
				Up_Centre 		:= Picture_Active_Up_Centre3
				Up_LUp   	 	:= Picture_Active_Up_LUp3	
				Up_RUp 	 	 	:= Picture_Active_Up_RUp3	
				Up_LDown  	 	:= Picture_Active_Up_LDown3	
				Up_RDown 	 	:= Picture_Active_Up_RDown3		
				Up_LineDown 	:= Picture_Active_Up_LineDown3	
				Up_LineUp  	 	:= Picture_Active_Up_LineUp3	
				Up_LineRight  	:= Picture_Active_Up_LineRight3
				Up_LineLeft 	:= Picture_Active_Up_LineLeft3	
				
				Down_Centre	 	:= Picture_Active_Down_Centre3 
				Down_LUp 	 	:= Picture_Active_Down_LUp3	
				Down_RUp 	 	:= Picture_Active_Down_RUp3
				Down_LDown 	 	:= Picture_Active_Down_LDown3
				Down_RDown 	 	:= Picture_Active_Down_RDown3
				Down_LineDown 	:= Picture_Active_Down_LineDown3
				Down_LineUp 	:= Picture_Active_Down_LineUp3
				Down_LineRight 	:= Picture_Active_Down_LineRight3
				Down_LineLeft 	:= Picture_Active_Down_LineLeft3
				
				Centre 			:= Picture_Active_Color_Centre3
				LUp   	 		:= Picture_Active_Color_LUp3	
				RUp 	 	 	:= Picture_Active_Color_RUp3	
				LDown  	 		:= Picture_Active_Color_LDown3	
				RDown 	 		:= Picture_Active_Color_RDown3		
				LineDown 		:= Picture_Active_Color_LineDown3	
				LineUp  	 	:= Picture_Active_Color_LineUp3	
				LineRight  		:= Picture_Active_Color_LineRight3
				LineLeft 		:= Picture_Active_Color_LineLeft3
			End If
		
		Else

			If DisplayWidth >= 1500 And DisplayHeight >= 900 Then
				RectangleEdge	:= 3
				Up_Centre 		:= Picture_Active_Up_Centre2
				Up_LUp   	 	:= Picture_Active_Up_LUp2	
				Up_RUp 	 	 	:= Picture_Active_Up_RUp2	
				Up_LDown  	 	:= Picture_Active_Up_LDown2	
				Up_RDown 	 	:= Picture_Active_Up_RDown2		
				Up_LineDown 	:= Picture_Active_Up_LineDown2	
				Up_LineUp  	 	:= Picture_Active_Up_LineUp2	
				Up_LineRight  	:= Picture_Active_Up_LineRight2
				Up_LineLeft 	:= Picture_Active_Up_LineLeft2	
				
				Down_Centre	 	:= Picture_Active_Down_Centre2 
				Down_LUp 	 	:= Picture_Active_Down_LUp2	
				Down_RUp 	 	:= Picture_Active_Down_RUp2
				Down_LDown 	 	:= Picture_Active_Down_LDown2
				Down_RDown 	 	:= Picture_Active_Down_RDown2
				Down_LineDown 	:= Picture_Active_Down_LineDown2
				Down_LineUp 	:= Picture_Active_Down_LineUp2
				Down_LineRight 	:= Picture_Active_Down_LineRight2
				Down_LineLeft 	:= Picture_Active_Down_LineLeft2
				
			Else
				RectangleEdge	:= 2
				Up_Centre 		:= Picture_Active_Up_Centre
				Up_LUp   	 	:= Picture_Active_Up_LUp	
				Up_RUp 	 	 	:= Picture_Active_Up_RUp	
				Up_LDown  	 	:= Picture_Active_Up_LDown	
				Up_RDown 	 	:= Picture_Active_Up_RDown		
				Up_LineDown 	:= Picture_Active_Up_LineDown	
				Up_LineUp  	 	:= Picture_Active_Up_LineUp	
				Up_LineRight  	:= Picture_Active_Up_LineRight
				Up_LineLeft 	:= Picture_Active_Up_LineLeft	
				
				Down_Centre	 	:= Picture_Active_Down_Centre 
				Down_LUp 	 	:= Picture_Active_Down_LUp	
				Down_RUp 	 	:= Picture_Active_Down_RUp
				Down_LDown 	 	:= Picture_Active_Down_LDown
				Down_RDown 	 	:= Picture_Active_Down_RDown
				Down_LineDown 	:= Picture_Active_Down_LineDown
				Down_LineUp 	:= Picture_Active_Down_LineUp
				Down_LineRight 	:= Picture_Active_Down_LineRight
				Down_LineLeft 	:= Picture_Active_Down_LineLeft	
						
			End If
		End If
	End Function
	
	Protected Function SetComponentColorUp(Upcolor As Long)
		UpColorOpacity := GetColorComponentOpacity(Upcolor)	
		UpButtonColor := SetColorComponentOpacity(Upcolor,255)
	End Function
	
	Protected Function SetComponentColorDown(downColor As Long)
		DownColorOpacity := GetColorComponentOpacity(downColor)	
		DownButtonColor := SetColorComponentOpacity(downColor,255)
	End Function
		
	Protected Function RedrawCompoundObject()
	
		LockRedraw()
	
		If IsPressed Then
			PictureLayer1.Hide()
			PictureLayer2.Hide()
			Redraw()
	
			PictureLayer3.SetPicture(MDownIcon)
			PictureLayer3.SetOpacity(DrawOpacity)
			PictureLayer3.SetFitting(FITTING_FIT_OBJECT_TO_CONTENT)
			PictureLayer3.SetObjectPosition(DownIconX + DownOffset, DownIconY + DownOffset)
	
			TextLayer.SetFont(MDownFont)
			TextLayer.SetText(MDownText)
			TextLayer.SetColor(DownDrawFontColor)
			TextLayer.SetAlign(DownFormatFlags)
			TextLayer.SetTextOffsetX(MDownTextOffsetX+ DownOffset)
			TextLayer.SetTextOffsetY(MDownTextOffsetY+ DownOffset)
			TextLayer.SetLineSpacing(MDownLineSpacing)
			TextLayer.SetObjectPosition(0, 0)
			TextLayer.SetObjectDimensions(ObjectWidth, ObjectHeight)
			
		Else
			PictureLayer1.Hide()
			PictureLayer2.Hide()
			Redraw()
			
			PictureLayer3.SetPicture(MUpIcon)
			PictureLayer3.SetOpacity(DrawOpacity)
			PictureLayer3.SetFitting(FITTING_FIT_OBJECT_TO_CONTENT)
			PictureLayer3.SetObjectPosition(UpIconX , UpIconY )
			
			TextLayer.SetFont(MUpFont)
			TextLayer.SetText(MUpText)
			TextLayer.SetColor(UpDrawFontColor)
			TextLayer.SetAlign(UpFormatFlags)
			TextLayer.SetTextOffsetX(MUpTextOffsetX)
			TextLayer.SetTextOffsetY(MUpTextOffsetY)
			TextLayer.SetLineSpacing(MUpLineSpacing)
			TextLayer.SetObjectPosition(0, 0)
			TextLayer.SetObjectDimensions(ObjectWidth, ObjectHeight)
		End If

		UnlockRedraw()
	
	End Function
	
	Private Function Draw3DButton(state As Boolean)
		Var Width As Long
		Var Height As Long

		Me.GetSize(Width,Height)
		If ButtonCorner = BUTTON_STYLE_ROUNDED_CORNER Then
			If 	state Then
				DrawStretchedTintedPicture(LineUp,DownButtonColor,Down_RUp.GetWidth(),0,Width-2*Down_RUp.GetWidth(),Down_RUp.GetHeight(),0,0,-1,-1,DownColorOpacity)
				DrawStretchedTintedPicture(LineRight,DownButtonColor,Width-Down_RUp.GetWidth(),Down_RUp.GetHeight(),Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight(),0,0,-1,-1,DownColorOpacity)
				DrawStretchedTintedPicture(LineDown,DownButtonColor,Down_RUp.GetWidth(),Height-Down_RUp.GetHeight(),Width-2*Down_RUp.GetWidth(),Down_RUp.GetHeight(),0,0,-1,-1,DownColorOpacity)
				DrawStretchedTintedPicture(LineLeft,DownButtonColor,0,Down_RUp.GetHeight(),Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight(),0,0,-1,-1,DownColorOpacity)			
				DrawStretchedTintedPicture(Centre,DownButtonColor,Down_RUp.GetWidth(),Down_RUp.GetHeight(),Width-2*Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight(),0,0,-1,-1,DownColorOpacity)

				DrawTintedPicture(LUp,DownButtonColor,0,0,-1,-1,0,0,DownColorOpacity)
				DrawTintedPicture(RUp,DownButtonColor,Width-Down_RUp.GetWidth(),0,-1,-1,0,0,DownColorOpacity)
				DrawTintedPicture(LDown,DownButtonColor,0,Height-Down_RUp.GetHeight(),-1,-1,0,0,DownColorOpacity)
				DrawTintedPicture(RDown,DownButtonColor,Width-Down_RUp.GetWidth(),Height-Down_RUp.GetHeight(),-1,-1,0,0,DownColorOpacity)	
			Else
				DrawStretchedTintedPicture(LineUp,UpButtonColor,Down_RUp.GetWidth(),0,Width-2*Down_RUp.GetWidth(),Down_RUp.GetHeight(),0,0,-1,-1,UpColorOpacity)
				DrawStretchedTintedPicture(LineRight,UpButtonColor,Width-Down_RUp.GetWidth(),Down_RUp.GetHeight(),Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight(),0,0,-1,-1,UpColorOpacity)
				DrawStretchedTintedPicture(LineDown,UpButtonColor,Down_RUp.GetWidth(),Height-Down_RUp.GetHeight(),Width-2*Down_RUp.GetWidth(),Down_RUp.GetHeight(),0,0,-1,-1,UpColorOpacity)
				DrawStretchedTintedPicture(LineLeft,UpButtonColor,0,Down_RUp.GetHeight(),Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight(),0,0,-1,-1,UpColorOpacity)			
				DrawStretchedTintedPicture(Centre,UpButtonColor,Down_RUp.GetWidth(),Down_RUp.GetHeight(),Width-2*Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight(),0,0,-1,-1,UpColorOpacity)
			
				DrawTintedPicture(LUp,UpButtonColor,0,0,-1,-1,0,0,UpColorOpacity)
				DrawTintedPicture(RUp,UpButtonColor,Width-Down_RUp.GetWidth(),0,-1,-1,0,0,UpColorOpacity)
				DrawTintedPicture(LDown,UpButtonColor,0,Height-Down_RUp.GetHeight(),-1,-1,0,0,UpColorOpacity)
				DrawTintedPicture(RDown,UpButtonColor,Width-Down_RUp.GetWidth(),Height-Down_RUp.GetHeight(),-1,-1,0,0,UpColorOpacity)
			End If	
		Else	
			If 	state Then
				DrawRectangle(DownColor,RectangleEdge,RectangleEdge,Width-2*RectangleEdge,Height-2*RectangleEdge)
			Else
				DrawRectangle(UpColor,RectangleEdge,RectangleEdge,Width-2*RectangleEdge,Height-2*RectangleEdge)
			End If
		End If
		
			If 	state Then
				DrawStretchedPicture(Down_LineUp,Down_RUp.GetWidth(),0,Width-2*Down_RUp.GetWidth(),Down_RUp.GetHeight())
				DrawStretchedPicture(Down_LineRight,Width-Down_RUp.GetWidth(),Down_RUp.GetHeight(),Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight())
				DrawStretchedPicture(Down_LineDown,Down_RUp.GetWidth(),Height-Down_RUp.GetHeight(),Width-2*Down_RUp.GetWidth(),Down_RUp.GetHeight())
				DrawStretchedPicture(Down_LineLeft,0,Down_RUp.GetHeight(),Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight())			
				DrawStretchedPicture(Down_Centre,Down_RUp.GetWidth(),Down_RUp.GetHeight(),Width-2*Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight())
			
				DrawPicture(Down_LUp,0,0)
				DrawPicture(Down_RUp,Width-Down_RUp.GetWidth(),0)
				DrawPicture(Down_LDown,0,Height-Down_RUp.GetHeight())
				DrawPicture(Down_RDown,Width-Down_RUp.GetWidth(),Height-Down_RUp.GetHeight())			
			Else						
				DrawStretchedPicture(Up_LineUp,Up_RUp.GetWidth(),0,Width-2*Up_RUp.GetWidth(),Up_RUp.GetHeight())
				DrawStretchedPicture(Up_LineRight,Width-Up_RUp.GetWidth(),Up_RUp.GetHeight(),Up_RUp.GetWidth(),Height-2*Up_RUp.GetHeight())
				DrawStretchedPicture(Up_LineDown,Up_RUp.GetWidth(),Height-Up_RUp.GetHeight(),Width-2*Up_RUp.GetWidth(),Up_RUp.GetHeight())
				DrawStretchedPicture(Up_LineLeft,0,Up_RUp.GetHeight(),Up_RUp.GetWidth(),Height-2*Up_RUp.GetHeight())
				DrawStretchedPicture(Up_Centre,Up_RUp.GetWidth(),Up_RUp.GetHeight(),Width-2*Up_RUp.GetWidth(),Height-2*Up_RUp.GetHeight())
			
				DrawPicture(Up_LUp,0,0)
				DrawPicture(Up_RUp,Width-Up_RUp.GetWidth(),0)
				DrawPicture(Up_LDown,0,Height-Up_RUp.GetHeight())
				DrawPicture(Up_RDown,Width-Up_RUp.GetWidth(),Height-Up_RUp.GetHeight())
			End If
		
	End Function	

	Public Function SetButtonStyle(newbuttonstyle As Long) As Boolean
		If newbuttonstyle  = BUTTON_STYLE_ROUNDED_CORNER Then
			DownOffset := 1
		Else
			DownOffset := 0
		End If
		ButtonCorner := newbuttonstyle
		SelButtonPic(GetPrimaryDisplay().GetWidth(),GetPrimaryDisplay().GetHeight(),ButtonCorner)
		UpdateDimensions()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetButtonStyle() As Long
		Return Value ButtonCorner
	End Function
	
//colors button
	Public Function SetDownColor(newdowncolor As Long) As Boolean
		DownColor := newdowncolor
		SetComponentColorDown(newdowncolor)
		RedrawCompoundObject()
		Return Value True
	End Function
	
	Public Function SetUpColor(newupcolor As Long) As Boolean
		UpColor := newupcolor
		SetComponentColorUp(newupcolor)
		RedrawCompoundObject()
		Return Value True	
	End Function
		
	Public Function GetDownColor() As Long
		Return Value DownColor
	End Function
	
	Public Function GetUpColor() As Long
		Return Value UpColor
	End Function
	
// text
//up
	Public Function SetUpFont(newupfont As AddressOf _Font) As Boolean
		MUpFont := newupfont
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpFont() As AddressOf _Font
		Return Value MUpFont	
	End Function
		
	Public Function SetUpFontColor(newupfontcolor As Long) As Boolean
		MUpFontColor := newupfontcolor
		UpdateDrawColors()
		RedrawCompoundObject()
		Return Value True	
	End Function
		
	Public Function GetUpFontColor() As Long
		Return Value MUpFontColor
	End Function

	Public Function SetUpLineSpacing(newuplinespacing As Double) As Boolean	
		If newuplinespacing >= 0 Then
			MUpLineSpacing := newuplinespacing
			RedrawCompoundObject()
			Return Value True
		Else
			Return Value False
		End If
	End Function
	
	Public Function GetUpLineSpacing() As Double
		Return Value MUpLineSpacing	
	End Function
	
	Public Function SetUpText(newuptext As Text) As Boolean
		If GetMemorySegment(newuptext) = _MSEG_RESOURCEDATA Then
			MUpText := newuptext
		Else
			TextBuffer := newuptext
			MUpText := TextBuffer
		End If
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpText() As AddressOf Text
		Return Value MUpText	
	End Function
	
	Public Function SetUpTextAlign(newuptextalign As Long) As Boolean
		Select newuptextalign
			Case _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNTOP, _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNVCENTER, _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNBOTTOM, _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNTOP, _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNVCENTER, _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNBOTTOM, _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNTOP, _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNVCENTER, _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNBOTTOM
				MUpTextAlign := newuptextalign
				UpFormatFlags := MUpTextAlign BitOr _TEXT_WORDWRAP
				RedrawCompoundObject()
				Return Value True
	
			Case Else
				Return Value False
		End Select
	End Function
	
	Public Function GetUpTextAlign() As Long
		Return Value MUpTextAlign
	End Function
	
	Public Function SetUpTextOffsetX(newuptextoffsetx As Long) As Boolean	
		MUpTextOffsetX := newuptextoffsetx 
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpTextOffsetX() As Long
		Return Value MUpTextOffsetX	
	End Function
	
	Public Function SetUpTextOffsetY(newuptextoffsety As Long) As Boolean
		MUpTextOffsetY := newuptextoffsety 
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpTextOffsetY() As Long
		Return Value MUpTextOffsetY	
	End Function
//down	
	Public Function SetDownFont(newdownfont As AddressOf _Font) As Boolean
		MDownFont := newdownfont
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownFont() As AddressOf _Font
		Return Value MDownFont	
	End Function
		
	Public Function SetDownFontColor(newdownfontcolor As Long) As Boolean
		MDownFontColor := newdownfontcolor
		UpdateDrawColors()
		RedrawCompoundObject()
		Return Value True	
	End Function
		
	Public Function GetDownFontColor() As Long
		Return Value MDownFontColor
	End Function

	Public Function SetDownLineSpacing(newdownlinespacing As Double) As Boolean	
		If newdownlinespacing >= 0 Then
			MDownLineSpacing := newdownlinespacing
			RedrawCompoundObject()
			Return Value True
		Else
			Return Value False
		End If
	End Function
	
	Public Function GetDownLineSpacing() As Double
		Return Value MDownLineSpacing	
	End Function
	
	Public Function SetDownText(newdowntext As Text) As Boolean
		If GetMemorySegment(newdowntext) = _MSEG_RESOURCEDATA Then
			MDownText := newdowntext
		Else
			TextBuffer := newdowntext
			MDownText := TextBuffer
		End If
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownText() As AddressOf Text
		Return Value MDownText	
	End Function
	
	Public Function SetDownTextAlign(newdowntextalign As Long) As Boolean
		Select newdowntextalign
			Case _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNTOP, _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNVCENTER, _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNBOTTOM, _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNTOP, _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNVCENTER, _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNBOTTOM, _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNTOP, _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNVCENTER, _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNBOTTOM
				MDownTextAlign := newdowntextalign
				DownFormatFlags := MDownTextAlign BitOr _TEXT_WORDWRAP
				RedrawCompoundObject()
				Return Value True
	
			Case Else
				Return Value False
		End Select
	End Function
	
	Public Function GetDownTextAlign() As Long
		Return Value MDownTextAlign
	End Function
	
	Public Function SetDownTextOffsetX(newdowntextoffsetx As Long) As Boolean	
		MDownTextOffsetX := newdowntextoffsetx 
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownTextOffsetX() As Long
		Return Value MDownTextOffsetX	
	End Function
	
	Public Function SetDownTextOffsetY(newdowntextoffsety As Long) As Boolean
		MDownTextOffsetY := newdowntextoffsety 
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownTextOffsetY() As Long
		Return Value MDownTextOffsetY	
	End Function
// icon
// up 
	Public Function SetUpIcon(newupicon As AddressOf _Picture) As Boolean
		MUpIcon := newupicon
		UpdateIconPosition()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpIcon() As AddressOf _Picture
		Return Value MUpIcon	
	End Function
	
	Public Function SetUpIconAlign(newupiconalign As Long) As Boolean
		Select newupiconalign
			Case ICON_ALIGNLEFT BitOr ICON_ALIGNTOP, ICON_ALIGNLEFT BitOr ICON_ALIGNVCENTER, ICON_ALIGNLEFT BitOr ICON_ALIGNBOTTOM, ICON_ALIGNHCENTER BitOr ICON_ALIGNTOP, ICON_ALIGNHCENTER BitOr ICON_ALIGNVCENTER, ICON_ALIGNHCENTER BitOr ICON_ALIGNBOTTOM, ICON_ALIGNRIGHT BitOr ICON_ALIGNTOP, ICON_ALIGNRIGHT BitOr ICON_ALIGNVCENTER, ICON_ALIGNRIGHT BitOr ICON_ALIGNBOTTOM
				MUpIconAlign := newupiconalign
				UpdateIconPosition()
				RedrawCompoundObject()
				Return Value True
	
			Case Else
				Return Value False
		End Select
	End Function
	
	Public Function GetUpIconAlign() As Long
		Return Value MUpIconAlign
	End Function
	
	Public Function SetUpIconOffsetX(newupiconoffsetx As Long) As Boolean	
		MUpIconOffsetX := newupiconoffsetx 
		UpdateIconPosition()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpIconOffsetX() As Long
		Return Value MUpIconOffsetX	
	End Function
	
	Public Function SetUpIconOffsetY(newupiconoffsety As Long) As Boolean	
		MUpIconOffsetY := newupiconoffsety 
		UpdateIconPosition()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpIconOffsetY() As Long
		Return Value MUpIconOffsetY	
	End Function
// down
	Public Function SetDownIcon(newdownicon As AddressOf _Picture) As Boolean
		MDownIcon := newdownicon
		UpdateIconPosition()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownIcon() As AddressOf _Picture
		Return Value MDownIcon	
	End Function
	
	Public Function SetDownIconAlign(newdowniconalign As Long) As Boolean
		Select newdowniconalign
			Case ICON_ALIGNLEFT BitOr ICON_ALIGNTOP, ICON_ALIGNLEFT BitOr ICON_ALIGNVCENTER, ICON_ALIGNLEFT BitOr ICON_ALIGNBOTTOM, ICON_ALIGNHCENTER BitOr ICON_ALIGNTOP, ICON_ALIGNHCENTER BitOr ICON_ALIGNVCENTER, ICON_ALIGNHCENTER BitOr ICON_ALIGNBOTTOM, ICON_ALIGNRIGHT BitOr ICON_ALIGNTOP, ICON_ALIGNRIGHT BitOr ICON_ALIGNVCENTER, ICON_ALIGNRIGHT BitOr ICON_ALIGNBOTTOM
				MDownIconAlign := newdowniconalign
				UpdateIconPosition()
				RedrawCompoundObject()
				Return Value True
	
			Case Else
				Return Value False
		End Select
	End Function
	
	Public Function GetDownIconAlign() As Long
		Return Value MDownIconAlign
	End Function
	
	Public Function SetDownIconOffsetX(newdowniconoffsetx As Long) As Boolean	
		MDownIconOffsetX := newdowniconoffsetx 
		UpdateIconPosition()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownIconOffsetX() As Long
		Return Value MDownIconOffsetX	
	End Function
	
	Public Function SetDownIconOffsetY(newdowniconoffsety As Long) As Boolean	
		MDownIconOffsetY := newdowniconoffsety 
		UpdateIconPosition()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownIconOffsetY() As Long
		Return Value MDownIconOffsetY	
	End Function

	Public Function SetObjectDimensions(newwidth As Long, newheight As Long) As Boolean
		SetSize(newwidth, newheight)
		UpdateDimensions()
		RedrawCompoundObject()
		Return Value True
	End Function

	Public Function GetObjectDimensions(ByRef currentwidth As Long, ByRef currentheight As Long)
		GetSize(currentwidth, currentheight)
	End Function

	Public Function SetObjectPosition(newx As Long, newy As Long) As Boolean
		Var Response As Boolean
		Response := SetPosition(newx, newy)
		RedrawCompoundObject()
		Return Value Response
	End Function
	
	Public Function GetObjectPosition(ByRef currentx As Long, ByRef currenty As Long)
		GetPosition(currentx, currenty)
	End Function
	
End GraphicClass

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

Global GraphicClass RepeatButton Inherits Namespace "CUE.GraphicCollection.GenericObjectsBase.3".BaseRepeatButton WithAttributes {defaultwidth := 120, defaultheight := 80,ObjectCode := "OB0079-001", DesignName := "Multicolor", GroupName := "Buttons"}
	Public Const BUTTON_STYLE_ROUNDED_CORNER				As Long	:= 1	
	Public Const BUTTON_STYLE_SHARP_CORNER				As Long	:= 2
	
	Global Const ICON_ALIGNLEFT As Long := &H00000001	// Horizontal align left
	Global Const ICON_ALIGNHCENTER As Long := &H00000002	// Horizontal align center
	Global Const ICON_ALIGNRIGHT As Long :=	&H00000004	// Horizontal align right
	Global Const ICON_ALIGNTOP As Long := &H00000008	// Vertical align top
	Global Const ICON_ALIGNVCENTER As Long := &H00000010	// Vertical align center
	Global Const ICON_ALIGNBOTTOM As Long := &H00000020	// Vertical align bottom

	
	// Behavior Property Group
	Protected Property Enabled 							As Boolean := True WithAttributes {PropertyGroup := "Behavior", EditMode := "Boolean; 'Yes' := True, 'No' := False"}
	Protected Property ButtonCorner						As Long := BUTTON_STYLE_ROUNDED_CORNER WithAttributes {PropertyGroup := "Appearance",DisplayName := "ButtonStyle", EditMode:= "Enum; 'Sharp Corner' := BUTTON_STYLE_SHARP_CORNER, 'Rounded Corner' := BUTTON_STYLE_ROUNDED_CORNER"}
	Protected Property RepeatInterval 					As Time := :.4 WithAttributes {PropertyGroup := "Behavior", EditMode := "TimeInterval"}

	Protected Var		ButtonFont						As AddressOf _Font := GetButtonFont(GetPrimaryDisplay().GetWidth(),GetPrimaryDisplay().GetHeight()) 
	Protected Var		RectangleEdge					As Long := 2
	Protected Var		DownButtonColor					As Long := Namespace "CUE.GraphicCollection.MulticolorPalette.1".COLOR_ORANGE
	Protected Var		UpButtonColor					As Long := Namespace "CUE.GraphicCollection.MulticolorPalette.1".COLOR_ORANGE
	
	// Up Property Group
	Protected Property UpColor As Long := ColorUp() WithAttributes {PropertyGroup := "Up", EditMode := "color"}		
	
	Protected Var UpColorOpacity As Byte := 204 
	Protected Property UpFont As AddressOf _Font := ButtonFont WithAttributes {PropertyGroup := "Up", EditMode := "font"}
	Protected Property UpFontColor As Long := FontColorUp() WithAttributes {PropertyGroup := "Up", EditMode := "color"}
	Protected Property UpIcon As AddressOf _Picture := Nothing WithAttributes {PropertyGroup := "Up"}
	Protected Property UpIconAlign As Long := ICON_ALIGNHCENTER BitOr ICON_ALIGNVCENTER WithAttributes {PropertyGroup := "Up", EditMode := "ENUM; 'Left-Top' := &H09, 'Left-Middle' := &H11, 'Left-Bottom' := &H21, 'Center-Top' := &H0A, 'Center-Middle' := &H12, 'Center-Bottom' := &H22, 'Right-Top' := &H0C, 'Right-Middle' := &H14, 'Right-Bottom' := &H24"}
	Protected Property UpIconOffsetX As Long := 0 WithAttributes {PropertyGroup := "Up"}
	Protected Property UpIconOffsetY As Long := 0 WithAttributes {PropertyGroup := "Up"}
	Protected Property UpLineSpacing As Double := 1.2 WithAttributes {PropertyGroup := "Up"}
	Protected Property UpText As AddressOf Text := txtCaption WithAttributes {PropertyGroup := "Up"}
	Protected Property UpTextAlign As Long := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNVCENTER WithAttributes {PropertyGroup := "Up", EditMode := "ENUM; 'Left-Top' := _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNTOP, 'Left-Middle' := _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNVCENTER, 'Left-Bottom' := _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNBOTTOM, 'Center-Top' := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNTOP, 'Center-Middle' := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNVCENTER, 'Center-Bottom' := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNBOTTOM, 'Right-Top' := _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNTOP, 'Right-Middle' := _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNVCENTER, 'Right-Bottom' := _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNBOTTOM"}
	Protected Property UpTextOffsetX As Long := 0 WithAttributes {PropertyGroup := "Up"}
	Protected Property UpTextOffsetY As Long := 0 WithAttributes {PropertyGroup := "Up"}

	// Down Property Group
	Protected Property DownColor As Long := ColorDown() WithAttributes {PropertyGroup := "Down", EditMode := "color"}

	Protected Var DownColorOpacity As Byte := UpColorOpacity
	Protected Property DownFont As AddressOf _Font := UpFont WithAttributes {PropertyGroup := "Down", EditMode := "font"}
	Protected Property DownFontColor As Long := _COLOR_BLACK WithAttributes {PropertyGroup := "Down", EditMode := "color"}
	Protected Property DownIcon As AddressOf _Picture := UpIcon WithAttributes {PropertyGroup := "Down"}
	Protected Property DownIconAlign As Long := UpIconAlign WithAttributes {PropertyGroup := "Down", EditMode := "ENUM; 'Left-Top' := &H09, 'Left-Middle' := &H11, 'Left-Bottom' := &H21, 'Center-Top' := &H0A, 'Center-Middle' := &H12, 'Center-Bottom' := &H22, 'Right-Top' := &H0C, 'Right-Middle' := &H14, 'Right-Bottom' := &H24"}
	Protected Property DownIconOffsetX As Long := UpIconOffsetX WithAttributes {PropertyGroup := "Down"}
	Protected Property DownIconOffsetY As Long := UpIconOffsetY WithAttributes {PropertyGroup := "Down"}
	Protected Property DownLineSpacing As Double := UpLineSpacing WithAttributes {PropertyGroup := "Down"}
	Protected Property DownText As AddressOf Text := UpText WithAttributes {PropertyGroup := "Down"}
	Protected Property DownTextAlign As Long := UpTextAlign WithAttributes {PropertyGroup := "Down", EditMode := "ENUM; 'Left-Top' := _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNTOP, 'Left-Middle' := _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNVCENTER, 'Left-Bottom' := _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNBOTTOM, 'Center-Top' := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNTOP, 'Center-Middle' := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNVCENTER, 'Center-Bottom' := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNBOTTOM, 'Right-Top' := _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNTOP, 'Right-Middle' := _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNVCENTER, 'Right-Bottom' := _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNBOTTOM"}
	Protected Property DownTextOffsetX As Long := UpTextOffsetX WithAttributes {PropertyGroup := "Down"}
	Protected Property DownTextOffsetY As Long := UpTextOffsetY WithAttributes {PropertyGroup := "Down"}

	Protected Var		Picture_Active_Up_Centre 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LUp 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RUp 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LDown 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RDown 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineDown 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineUp 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineRight 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineLeft 		As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Down_Centre	 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LUp			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RUp			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LDown		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RDown 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineDown 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineUp		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineRight 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineLeft	As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Up_Centre2 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LUp2 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RUp2 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LDown2 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RDown2 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineDown2 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineUp2 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineRight2 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineLeft2		As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Down_Centre2	 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LUp2		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RUp2		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LDown2		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RDown2 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineDown2 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineUp2		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineRight2 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineLeft2	As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Up_Centre3 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LUp3 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RUp3 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LDown3 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RDown3 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineDown3 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineUp3 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineRight3 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineLeft3		As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Down_Centre3	 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LUp3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RUp3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LDown3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RDown3 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineDown3 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineUp3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineRight3 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineLeft3	As AddressOf _Picture := Nothing

	Protected Var		Picture_Active_Color_Centre3	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LUp3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_RUp3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LDown3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_RDown3 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineDown3 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineUp3	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineRight3 As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineLeft3	As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Up_Centre4 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LUp4 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RUp4 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LDown4 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RDown4 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineDown4 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineUp4 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineRight4 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineLeft4		As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Down_Centre4	 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LUp4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RUp4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LDown4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RDown4 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineDown4 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineUp4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineRight4 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineLeft4	As AddressOf _Picture := Nothing

	Protected Var		Picture_Active_Color_Centre4	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LUp4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_RUp4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LDown4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_RDown4 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineDown4 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineUp4	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineRight4 As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineLeft4	As AddressOf _Picture := Nothing
	
	Protected Var		Up_Centre 		As AddressOf _Picture := Nothing
	Protected Var		Up_LUp 			As AddressOf _Picture := Nothing
	Protected Var		Up_RUp 			As AddressOf _Picture := Nothing
	Protected Var		Up_LDown 		As AddressOf _Picture := Nothing
	Protected Var		Up_RDown 		As AddressOf _Picture := Nothing
	Protected Var		Up_LineDown 	As AddressOf _Picture := Nothing
	Protected Var		Up_LineUp 		As AddressOf _Picture := Nothing
	Protected Var		Up_LineRight 	As AddressOf _Picture := Nothing
	Protected Var		Up_LineLeft 	As AddressOf _Picture := Nothing
	
	Protected Var		Down_Centre	 	As AddressOf _Picture := Nothing
	Protected Var		Down_LUp		As AddressOf _Picture := Nothing
	Protected Var		Down_RUp		As AddressOf _Picture := Nothing
	Protected Var		Down_LDown		As AddressOf _Picture := Nothing
	Protected Var		Down_RDown 		As AddressOf _Picture := Nothing
	Protected Var		Down_LineDown 	As AddressOf _Picture := Nothing
	Protected Var		Down_LineUp		As AddressOf _Picture := Nothing
	Protected Var		Down_LineRight 	As AddressOf _Picture := Nothing
	Protected Var		Down_LineLeft	As AddressOf _Picture := Nothing

	Protected Var		Centre 			As AddressOf _Picture := Nothing
	Protected Var		LUp   			As AddressOf _Picture := Nothing 		
	Protected Var		RUp 			As AddressOf _Picture := Nothing 	 	
	Protected Var		LDown  	 		As AddressOf _Picture := Nothing		
	Protected Var		RDown 	 		As AddressOf _Picture := Nothing		
	Protected Var		LineDown 		As AddressOf _Picture := Nothing	
	Protected Var		LineUp  		As AddressOf _Picture := Nothing 		
	Protected Var		LineRight  		As AddressOf _Picture := Nothing	
	Protected Var		LineLeft 		As AddressOf _Picture := Nothing	


	Protected Function InitObject()
		Picture_Active_Up_Centre			:= Nothing
		Picture_Active_Up_LUp 				:= picButton_LeftUp_Corner
		Picture_Active_Up_RUp 				:= picButton_RightUp_Corner
		Picture_Active_Up_LDown 			:= picButton_LeftDown_Corner
		Picture_Active_Up_RDown 			:= picButton_RightDown_Corner
		Picture_Active_Up_LineDown 			:= picButton_Down_Line
		Picture_Active_Up_LineUp 			:= picButton_Up_Line
		Picture_Active_Up_LineRight 		:= picButton_Right_Line
		Picture_Active_Up_LineLeft 			:= picButton_Left_Line
	
		Picture_Active_Down_LUp				:= picButton_LeftUp_Corner
		Picture_Active_Down_RUp				:= picButton_RightUp_Corner
		Picture_Active_Down_LDown			:= picButton_LeftDown_Corner
		Picture_Active_Down_RDown 			:= picButton_RightDown_Corner
		Picture_Active_Down_LineDown 		:= picButton_Down_Line
		Picture_Active_Down_LineUp			:= picButton_Up_Line
		Picture_Active_Down_LineRight 		:= picButton_Right_Line
		Picture_Active_Down_LineLeft		:= picButton_Left_Line
		
		Picture_Active_Up_Centre2			:= Nothing		
		Picture_Active_Up_LUp2 				:= picButton_LeftUp_Corner1
		Picture_Active_Up_RUp2 				:= picButton_RightUp_Corner1
		Picture_Active_Up_LDown2 			:= picButton_LeftDown_Corner1
		Picture_Active_Up_RDown2 			:= picButton_RightDown_Corner1
		Picture_Active_Up_LineDown2 		:= picButton_Down_Line1
		Picture_Active_Up_LineUp2 			:= picButton_Up_Line1
		Picture_Active_Up_LineRight2 		:= picButton_Right_Line1
		Picture_Active_Up_LineLeft2 		:= picButton_Left_Line1
	
		Picture_Active_Down_LUp2			:= picButton_LeftUp_Corner1
		Picture_Active_Down_RUp2			:= picButton_RightUp_Corner1
		Picture_Active_Down_LDown2			:= picButton_LeftDown_Corner1
		Picture_Active_Down_RDown2 			:= picButton_RightDown_Corner1
		Picture_Active_Down_LineDown2 		:= picButton_Down_Line1
		Picture_Active_Down_LineUp2			:= picButton_Up_Line1
		Picture_Active_Down_LineRight2 		:= picButton_Right_Line1
		Picture_Active_Down_LineLeft2		:= picButton_Left_Line1	
		
		Picture_Active_Up_Centre3			:= picButton_Centre3
		Picture_Active_Up_LUp3 				:= picButton_LeftUp_Corner3
		Picture_Active_Up_RUp3 				:= picButton_RightUp_Corner3
		Picture_Active_Up_LDown3 			:= picButton_LeftDown_Corner3
		Picture_Active_Up_RDown3 			:= picButton_RightDown_Corner3
		Picture_Active_Up_LineDown3 		:= picButton_Down_Line3
		Picture_Active_Up_LineUp3 			:= picButton_Up_Line3
		Picture_Active_Up_LineRight3 		:= picButton_Right_Line3
		Picture_Active_Up_LineLeft3 		:= picButton_Left_Line3

		Picture_Active_Down_Centre3			:= picButton_Centre_down3	
		Picture_Active_Down_LUp3			:= picButton_LeftUp_Corner_down3
		Picture_Active_Down_RUp3			:= picButton_RightUp_Corner_down3
		Picture_Active_Down_LDown3			:= picButton_LeftDown_Corner_down3
		Picture_Active_Down_RDown3 			:= picButton_RightDown_Corner_down3
		Picture_Active_Down_LineDown3 		:= picButton_Down_Line_down3
		Picture_Active_Down_LineUp3			:= picButton_Up_Line_down3
		Picture_Active_Down_LineRight3 		:= picButton_Right_Line_down3
		Picture_Active_Down_LineLeft3		:= picButton_Left_Line_down3
		
		Picture_Active_Color_Centre3		:= picButton_Centre_color3
		Picture_Active_Color_LUp3			:= picButton_LeftUp_Corner_color3
		Picture_Active_Color_RUp3			:= picButton_RightUp_Corner_color3
		Picture_Active_Color_LDown3			:= picButton_LeftDown_Corner_color3
		Picture_Active_Color_RDown3 		:= picButton_RightDown_Corner_color3
		Picture_Active_Color_LineDown3 		:= picButton_Down_Line_color3
		Picture_Active_Color_LineUp3		:= picButton_Up_Line_color3
		Picture_Active_Color_LineRight3 	:= picButton_Right_Line_color3
		Picture_Active_Color_LineLeft3		:= picButton_Left_Line_color3
		
		Picture_Active_Up_Centre4			:= picButton_Centre2
		Picture_Active_Up_LUp4 				:= picButton_LeftUp_Corner2
		Picture_Active_Up_RUp4 				:= picButton_RightUp_Corner2
		Picture_Active_Up_LDown4 			:= picButton_LeftDown_Corner2
		Picture_Active_Up_RDown4 			:= picButton_RightDown_Corner2
		Picture_Active_Up_LineDown4 		:= picButton_Down_Line2
		Picture_Active_Up_LineUp4 			:= picButton_Up_Line2
		Picture_Active_Up_LineRight4 		:= picButton_Right_Line2
		Picture_Active_Up_LineLeft4 		:= picButton_Left_Line2

		Picture_Active_Down_Centre4			:= picButton_Centre_down2	
		Picture_Active_Down_LUp4			:= picButton_LeftUp_Corner_down2
		Picture_Active_Down_RUp4			:= picButton_RightUp_Corner_down2
		Picture_Active_Down_LDown4			:= picButton_LeftDown_Corner_down2
		Picture_Active_Down_RDown4 			:= picButton_RightDown_Corner_down2
		Picture_Active_Down_LineDown4 		:= picButton_Down_Line_down2
		Picture_Active_Down_LineUp4			:= picButton_Up_Line_down2
		Picture_Active_Down_LineRight4 		:= picButton_Right_Line_down2
		Picture_Active_Down_LineLeft4		:= picButton_Left_Line_down2
		
		Picture_Active_Color_Centre4		:= picButton_Centre_color2
		Picture_Active_Color_LUp4			:= picButton_LeftUp_Corner_color2
		Picture_Active_Color_RUp4			:= picButton_RightUp_Corner_color2
		Picture_Active_Color_LDown4			:= picButton_LeftDown_Corner_color2
		Picture_Active_Color_RDown4 		:= picButton_RightDown_Corner_color2
		Picture_Active_Color_LineDown4 		:= picButton_Down_Line_color2
		Picture_Active_Color_LineUp4		:= picButton_Up_Line_color2
		Picture_Active_Color_LineRight4 	:= picButton_Right_Line_color2
		Picture_Active_Color_LineLeft4		:= picButton_Left_Line_color2	
	End Function

	Protected Function Init()
		GetProperty()
		InitObject()
		SetComponentColorUp(UpColor)
		SetComponentColorDown(DownColor)
		SelButtonPic(GetPrimaryDisplay().GetWidth(),GetPrimaryDisplay().GetHeight(),ButtonCorner)
		UpFormatFlags := MUpTextAlign BitOr _TEXT_WORDWRAP
		DownFormatFlags := MDownTextAlign BitOr _TEXT_WORDWRAP
		UpdateDimensions()
		UpdateDrawColors()
		If ButtonCorner = BUTTON_STYLE_ROUNDED_CORNER Then
			DownOffset := 1
		Else
			DownOffset := 0
		End If
		RedrawCompoundObject()
	End Function
	
	Protected Function ColorUp()As Long
		If ButtonCorner = BUTTON_STYLE_ROUNDED_CORNER Then
			Return Value COLOR_ORANGE
		Else
			Return Value COLOR_GREYDARK
		End If
	End Function
	
	Protected Function ColorDown()As Long
		If ButtonCorner = BUTTON_STYLE_ROUNDED_CORNER Then
			Return Value COLOR_ORANGE
		Else
			Return Value COLOR_WHITE
		End If
	End Function
	
	Protected Function FontColorUp() As Long
		If ButtonCorner = BUTTON_STYLE_ROUNDED_CORNER Then
			Return Value _COLOR_BLACK
		Else
			Return Value _COLOR_WHITE
		End If	
	End Function
		
	Protected Function GetProperty()
	// Předání hodnot proměnným v bázové třídě
		MEnabled				:= Enabled
		MRepeatInterval			:= RepeatInterval
		MUpFont					:= UpFont
		MUpFontColor			:= UpFontColor
		MUpIcon					:= UpIcon
		MUpIconAlign			:= UpIconAlign
		MUpIconOffsetX			:= UpIconOffsetX
		MUpIconOffsetY			:= UpIconOffsetY
		MUpLineSpacing			:= UpLineSpacing
		MUpText					:= UpText
		MUpTextAlign			:= UpTextAlign
		MUpTextOffsetX			:= UpTextOffsetX
		MUpTextOffsetY			:= UpTextOffsetY
		MDownFont				:= DownFont
		MDownFontColor			:= DownFontColor
		MDownIcon				:= DownIcon
		MDownIconAlign			:= DownIconAlign
		MDownIconOffsetX		:= DownIconOffsetX
		MDownIconOffsetY		:= DownIconOffsetY
		MDownLineSpacing		:= DownLineSpacing
		MDownText				:= DownText
		MDownTextAlign			:= DownTextAlign
		MDownTextOffsetX		:= DownTextOffsetX
		MDownTextOffsetY		:= DownTextOffsetY
	End Function
	
	Protected Function GetButtonFont(DisplayWidth As Long,DisplayHeight As Long) As AddressOf _Font
//	 přednastavený font podle rozlišení
		If DisplayWidth >= 1500 And DisplayHeight >= 900 Then
			Return Value fntSegoeUI50
		Else
			Return Value fntSegoeUI23 
		End If
	End Function
	
	Protected Function SelButtonPic(DisplayWidth As Long,DisplayHeight As Long, Corner As Long)
	// výběr vhodné velikosti obrázku tlačítka podle rozlišení
		Var i As Long := 1
		
		If Corner = BUTTON_STYLE_ROUNDED_CORNER Then
			If DisplayWidth >= 1500 And DisplayHeight >= 900 Then
				Up_Centre 		:= Picture_Active_Up_Centre4
				Up_LUp   	 	:= Picture_Active_Up_LUp4	
				Up_RUp 	 	 	:= Picture_Active_Up_RUp4	
				Up_LDown  	 	:= Picture_Active_Up_LDown4	
				Up_RDown 	 	:= Picture_Active_Up_RDown4		
				Up_LineDown 	:= Picture_Active_Up_LineDown4	
				Up_LineUp  	 	:= Picture_Active_Up_LineUp4	
				Up_LineRight  	:= Picture_Active_Up_LineRight4
				Up_LineLeft 	:= Picture_Active_Up_LineLeft4	
				
				Down_Centre	 	:= Picture_Active_Down_Centre4 
				Down_LUp 	 	:= Picture_Active_Down_LUp4	
				Down_RUp 	 	:= Picture_Active_Down_RUp4
				Down_LDown 	 	:= Picture_Active_Down_LDown4
				Down_RDown 	 	:= Picture_Active_Down_RDown4
				Down_LineDown 	:= Picture_Active_Down_LineDown4
				Down_LineUp 	:= Picture_Active_Down_LineUp4
				Down_LineRight 	:= Picture_Active_Down_LineRight4
				Down_LineLeft 	:= Picture_Active_Down_LineLeft4
				
				Centre 			:= Picture_Active_Color_Centre4
				LUp   	 		:= Picture_Active_Color_LUp4	
				RUp 	 	 	:= Picture_Active_Color_RUp4	
				LDown  	 		:= Picture_Active_Color_LDown4	
				RDown 	 		:= Picture_Active_Color_RDown4		
				LineDown 		:= Picture_Active_Color_LineDown4	
				LineUp  	 	:= Picture_Active_Color_LineUp4	
				LineRight  		:= Picture_Active_Color_LineRight4
				LineLeft 		:= Picture_Active_Color_LineLeft4						
			Else
				Up_Centre 		:= Picture_Active_Up_Centre3
				Up_LUp   	 	:= Picture_Active_Up_LUp3	
				Up_RUp 	 	 	:= Picture_Active_Up_RUp3	
				Up_LDown  	 	:= Picture_Active_Up_LDown3	
				Up_RDown 	 	:= Picture_Active_Up_RDown3		
				Up_LineDown 	:= Picture_Active_Up_LineDown3	
				Up_LineUp  	 	:= Picture_Active_Up_LineUp3	
				Up_LineRight  	:= Picture_Active_Up_LineRight3
				Up_LineLeft 	:= Picture_Active_Up_LineLeft3	
				
				Down_Centre	 	:= Picture_Active_Down_Centre3 
				Down_LUp 	 	:= Picture_Active_Down_LUp3	
				Down_RUp 	 	:= Picture_Active_Down_RUp3
				Down_LDown 	 	:= Picture_Active_Down_LDown3
				Down_RDown 	 	:= Picture_Active_Down_RDown3
				Down_LineDown 	:= Picture_Active_Down_LineDown3
				Down_LineUp 	:= Picture_Active_Down_LineUp3
				Down_LineRight 	:= Picture_Active_Down_LineRight3
				Down_LineLeft 	:= Picture_Active_Down_LineLeft3
				
				Centre 			:= Picture_Active_Color_Centre3
				LUp   	 		:= Picture_Active_Color_LUp3	
				RUp 	 	 	:= Picture_Active_Color_RUp3	
				LDown  	 		:= Picture_Active_Color_LDown3	
				RDown 	 		:= Picture_Active_Color_RDown3		
				LineDown 		:= Picture_Active_Color_LineDown3	
				LineUp  	 	:= Picture_Active_Color_LineUp3	
				LineRight  		:= Picture_Active_Color_LineRight3
				LineLeft 		:= Picture_Active_Color_LineLeft3
			End If
		
		Else

			If DisplayWidth >= 1500 And DisplayHeight >= 900 Then
				RectangleEdge	:= 3
				Up_Centre 		:= Picture_Active_Up_Centre2
				Up_LUp   	 	:= Picture_Active_Up_LUp2	
				Up_RUp 	 	 	:= Picture_Active_Up_RUp2	
				Up_LDown  	 	:= Picture_Active_Up_LDown2	
				Up_RDown 	 	:= Picture_Active_Up_RDown2		
				Up_LineDown 	:= Picture_Active_Up_LineDown2	
				Up_LineUp  	 	:= Picture_Active_Up_LineUp2	
				Up_LineRight  	:= Picture_Active_Up_LineRight2
				Up_LineLeft 	:= Picture_Active_Up_LineLeft2	
				
				Down_Centre	 	:= Picture_Active_Down_Centre2 
				Down_LUp 	 	:= Picture_Active_Down_LUp2	
				Down_RUp 	 	:= Picture_Active_Down_RUp2
				Down_LDown 	 	:= Picture_Active_Down_LDown2
				Down_RDown 	 	:= Picture_Active_Down_RDown2
				Down_LineDown 	:= Picture_Active_Down_LineDown2
				Down_LineUp 	:= Picture_Active_Down_LineUp2
				Down_LineRight 	:= Picture_Active_Down_LineRight2
				Down_LineLeft 	:= Picture_Active_Down_LineLeft2
				
			Else
				RectangleEdge	:= 2
				Up_Centre 		:= Picture_Active_Up_Centre
				Up_LUp   	 	:= Picture_Active_Up_LUp	
				Up_RUp 	 	 	:= Picture_Active_Up_RUp	
				Up_LDown  	 	:= Picture_Active_Up_LDown	
				Up_RDown 	 	:= Picture_Active_Up_RDown		
				Up_LineDown 	:= Picture_Active_Up_LineDown	
				Up_LineUp  	 	:= Picture_Active_Up_LineUp	
				Up_LineRight  	:= Picture_Active_Up_LineRight
				Up_LineLeft 	:= Picture_Active_Up_LineLeft	
				
				Down_Centre	 	:= Picture_Active_Down_Centre 
				Down_LUp 	 	:= Picture_Active_Down_LUp	
				Down_RUp 	 	:= Picture_Active_Down_RUp
				Down_LDown 	 	:= Picture_Active_Down_LDown
				Down_RDown 	 	:= Picture_Active_Down_RDown
				Down_LineDown 	:= Picture_Active_Down_LineDown
				Down_LineUp 	:= Picture_Active_Down_LineUp
				Down_LineRight 	:= Picture_Active_Down_LineRight
				Down_LineLeft 	:= Picture_Active_Down_LineLeft	
						
			End If
		End If
	End Function
	
	Protected Function SetComponentColorUp(Upcolor As Long)
		UpColorOpacity := GetColorComponentOpacity(Upcolor)	
		UpButtonColor := SetColorComponentOpacity(Upcolor,255)
	End Function
	
	Protected Function SetComponentColorDown(downColor As Long)
		DownColorOpacity := GetColorComponentOpacity(downColor)	
		DownButtonColor := SetColorComponentOpacity(downColor,255)
	End Function
	
	Protected Function RedrawCompoundObject()
	
		LockRedraw()
	
		If IsPressed Then
			PictureLayer1.Hide()
			PictureLayer2.Hide()
			Redraw()
	
			PictureLayer3.SetPicture(MDownIcon)
			PictureLayer3.SetOpacity(DrawOpacity)
			PictureLayer3.SetFitting(FITTING_FIT_OBJECT_TO_CONTENT)
			PictureLayer3.SetObjectPosition(DownIconX + DownOffset, DownIconY + DownOffset)
	
			TextLayer.SetFont(MDownFont)
			TextLayer.SetText(MDownText)
			TextLayer.SetColor(DownDrawFontColor)
			TextLayer.SetAlign(DownFormatFlags)
			TextLayer.SetTextOffsetX(MDownTextOffsetX+ DownOffset)
			TextLayer.SetTextOffsetY(MDownTextOffsetY+ DownOffset)
			TextLayer.SetLineSpacing(MDownLineSpacing)
			TextLayer.SetObjectPosition(0, 0)
			TextLayer.SetObjectDimensions(ObjectWidth, ObjectHeight)
			
		Else
			PictureLayer1.Hide()
			PictureLayer2.Hide()
			Redraw()
			
			PictureLayer3.SetPicture(MUpIcon)
			PictureLayer3.SetOpacity(DrawOpacity)
			PictureLayer3.SetFitting(FITTING_FIT_OBJECT_TO_CONTENT)
			PictureLayer3.SetObjectPosition(UpIconX , UpIconY )
			
			TextLayer.SetFont(MUpFont)
			TextLayer.SetText(MUpText)
			TextLayer.SetColor(UpDrawFontColor)
			TextLayer.SetAlign(UpFormatFlags)
			TextLayer.SetTextOffsetX(MUpTextOffsetX)
			TextLayer.SetTextOffsetY(MUpTextOffsetY)
			TextLayer.SetLineSpacing(MUpLineSpacing)
			TextLayer.SetObjectPosition(0, 0)
			TextLayer.SetObjectDimensions(ObjectWidth, ObjectHeight)
		End If

		UnlockRedraw()
	
	End Function
	
	Private Function Draw3DButton(state As Boolean)
		Var Width As Long
		Var Height As Long

		Me.GetSize(Width,Height)
		If ButtonCorner = BUTTON_STYLE_ROUNDED_CORNER Then
			If 	state Then
				DrawStretchedTintedPicture(LineUp,DownButtonColor,Down_RUp.GetWidth(),0,Width-2*Down_RUp.GetWidth(),Down_RUp.GetHeight(),0,0,-1,-1,DownColorOpacity)
				DrawStretchedTintedPicture(LineRight,DownButtonColor,Width-Down_RUp.GetWidth(),Down_RUp.GetHeight(),Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight(),0,0,-1,-1,DownColorOpacity)
				DrawStretchedTintedPicture(LineDown,DownButtonColor,Down_RUp.GetWidth(),Height-Down_RUp.GetHeight(),Width-2*Down_RUp.GetWidth(),Down_RUp.GetHeight(),0,0,-1,-1,DownColorOpacity)
				DrawStretchedTintedPicture(LineLeft,DownButtonColor,0,Down_RUp.GetHeight(),Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight(),0,0,-1,-1,DownColorOpacity)			
				DrawStretchedTintedPicture(Centre,DownButtonColor,Down_RUp.GetWidth(),Down_RUp.GetHeight(),Width-2*Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight(),0,0,-1,-1,DownColorOpacity)

				DrawTintedPicture(LUp,DownButtonColor,0,0,-1,-1,0,0,DownColorOpacity)
				DrawTintedPicture(RUp,DownButtonColor,Width-Down_RUp.GetWidth(),0,-1,-1,0,0,DownColorOpacity)
				DrawTintedPicture(LDown,DownButtonColor,0,Height-Down_RUp.GetHeight(),-1,-1,0,0,DownColorOpacity)
				DrawTintedPicture(RDown,DownButtonColor,Width-Down_RUp.GetWidth(),Height-Down_RUp.GetHeight(),-1,-1,0,0,DownColorOpacity)	
			Else
				DrawStretchedTintedPicture(LineUp,UpButtonColor,Down_RUp.GetWidth(),0,Width-2*Down_RUp.GetWidth(),Down_RUp.GetHeight(),0,0,-1,-1,UpColorOpacity)
				DrawStretchedTintedPicture(LineRight,UpButtonColor,Width-Down_RUp.GetWidth(),Down_RUp.GetHeight(),Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight(),0,0,-1,-1,UpColorOpacity)
				DrawStretchedTintedPicture(LineDown,UpButtonColor,Down_RUp.GetWidth(),Height-Down_RUp.GetHeight(),Width-2*Down_RUp.GetWidth(),Down_RUp.GetHeight(),0,0,-1,-1,UpColorOpacity)
				DrawStretchedTintedPicture(LineLeft,UpButtonColor,0,Down_RUp.GetHeight(),Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight(),0,0,-1,-1,UpColorOpacity)			
				DrawStretchedTintedPicture(Centre,UpButtonColor,Down_RUp.GetWidth(),Down_RUp.GetHeight(),Width-2*Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight(),0,0,-1,-1,UpColorOpacity)
			
				DrawTintedPicture(LUp,UpButtonColor,0,0,-1,-1,0,0,UpColorOpacity)
				DrawTintedPicture(RUp,UpButtonColor,Width-Down_RUp.GetWidth(),0,-1,-1,0,0,UpColorOpacity)
				DrawTintedPicture(LDown,UpButtonColor,0,Height-Down_RUp.GetHeight(),-1,-1,0,0,UpColorOpacity)
				DrawTintedPicture(RDown,UpButtonColor,Width-Down_RUp.GetWidth(),Height-Down_RUp.GetHeight(),-1,-1,0,0,UpColorOpacity)
			End If	
		Else	
			If 	state Then
				DrawRectangle(DownColor,RectangleEdge,RectangleEdge,Width-2*RectangleEdge,Height-2*RectangleEdge)
			Else
				DrawRectangle(UpColor,RectangleEdge,RectangleEdge,Width-2*RectangleEdge,Height-2*RectangleEdge)
			End If
		End If
		
			If 	state Then
				DrawStretchedPicture(Down_LineUp,Down_RUp.GetWidth(),0,Width-2*Down_RUp.GetWidth(),Down_RUp.GetHeight())
				DrawStretchedPicture(Down_LineRight,Width-Down_RUp.GetWidth(),Down_RUp.GetHeight(),Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight())
				DrawStretchedPicture(Down_LineDown,Down_RUp.GetWidth(),Height-Down_RUp.GetHeight(),Width-2*Down_RUp.GetWidth(),Down_RUp.GetHeight())
				DrawStretchedPicture(Down_LineLeft,0,Down_RUp.GetHeight(),Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight())			
				DrawStretchedPicture(Down_Centre,Down_RUp.GetWidth(),Down_RUp.GetHeight(),Width-2*Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight())
			
				DrawPicture(Down_LUp,0,0)
				DrawPicture(Down_RUp,Width-Down_RUp.GetWidth(),0)
				DrawPicture(Down_LDown,0,Height-Down_RUp.GetHeight())
				DrawPicture(Down_RDown,Width-Down_RUp.GetWidth(),Height-Down_RUp.GetHeight())			
			Else						
				DrawStretchedPicture(Up_LineUp,Up_RUp.GetWidth(),0,Width-2*Up_RUp.GetWidth(),Up_RUp.GetHeight())
				DrawStretchedPicture(Up_LineRight,Width-Up_RUp.GetWidth(),Up_RUp.GetHeight(),Up_RUp.GetWidth(),Height-2*Up_RUp.GetHeight())
				DrawStretchedPicture(Up_LineDown,Up_RUp.GetWidth(),Height-Up_RUp.GetHeight(),Width-2*Up_RUp.GetWidth(),Up_RUp.GetHeight())
				DrawStretchedPicture(Up_LineLeft,0,Up_RUp.GetHeight(),Up_RUp.GetWidth(),Height-2*Up_RUp.GetHeight())
				DrawStretchedPicture(Up_Centre,Up_RUp.GetWidth(),Up_RUp.GetHeight(),Width-2*Up_RUp.GetWidth(),Height-2*Up_RUp.GetHeight())
			
				DrawPicture(Up_LUp,0,0)
				DrawPicture(Up_RUp,Width-Up_RUp.GetWidth(),0)
				DrawPicture(Up_LDown,0,Height-Up_RUp.GetHeight())
				DrawPicture(Up_RDown,Width-Up_RUp.GetWidth(),Height-Up_RUp.GetHeight())
			End If
		
	End Function	

	Public Function SetButtonStyle(newbuttonstyle As Long) As Boolean
		If newbuttonstyle  = BUTTON_STYLE_ROUNDED_CORNER Then
			DownOffset := 1
		Else
			DownOffset := 0
		End If
		ButtonCorner := newbuttonstyle
		SelButtonPic(GetPrimaryDisplay().GetWidth(),GetPrimaryDisplay().GetHeight(),ButtonCorner)
		UpdateDimensions()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetButtonStyle() As Long
		Return Value ButtonCorner
	End Function
	
//colors button
	Public Function SetDownColor(newdowncolor As Long) As Boolean
		DownColor := newdowncolor
		SetComponentColorDown(newdowncolor)
		RedrawCompoundObject()
		Return Value True
	End Function
	
	Public Function SetUpColor(newupcolor As Long) As Boolean
		UpColor := newupcolor
		SetComponentColorUp(newupcolor)
		RedrawCompoundObject()
		Return Value True	
	End Function
		
	Public Function GetDownColor() As Long
		Return Value DownColor
	End Function
	
	Public Function GetUpColor() As Long
		Return Value UpColor
	End Function
	
// text
//up
	Public Function SetUpFont(newupfont As AddressOf _Font) As Boolean
		MUpFont := newupfont
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpFont() As AddressOf _Font
		Return Value MUpFont	
	End Function
		
	Public Function SetUpFontColor(newupfontcolor As Long) As Boolean
		MUpFontColor := newupfontcolor
		UpdateDrawColors()
		RedrawCompoundObject()
		Return Value True	
	End Function
		
	Public Function GetUpFontColor() As Long
		Return Value MUpFontColor
	End Function

	Public Function SetUpLineSpacing(newuplinespacing As Double) As Boolean	
		If newuplinespacing >= 0 Then
			MUpLineSpacing := newuplinespacing
			RedrawCompoundObject()
			Return Value True
		Else
			Return Value False
		End If
	End Function
	
	Public Function GetUpLineSpacing() As Double
		Return Value MUpLineSpacing	
	End Function
	
	Public Function SetUpText(newuptext As Text) As Boolean
		If GetMemorySegment(newuptext) = _MSEG_RESOURCEDATA Then
			MUpText := newuptext
		Else
			TextBuffer := newuptext
			MUpText := TextBuffer
		End If
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpText() As AddressOf Text
		Return Value MUpText	
	End Function
	
	Public Function SetUpTextAlign(newuptextalign As Long) As Boolean
		Select newuptextalign
			Case _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNTOP, _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNVCENTER, _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNBOTTOM, _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNTOP, _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNVCENTER, _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNBOTTOM, _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNTOP, _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNVCENTER, _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNBOTTOM
				MUpTextAlign := newuptextalign
				UpFormatFlags := MUpTextAlign BitOr _TEXT_WORDWRAP
				RedrawCompoundObject()
				Return Value True
	
			Case Else
				Return Value False
		End Select
	End Function
	
	Public Function GetUpTextAlign() As Long
		Return Value MUpTextAlign
	End Function
	
	Public Function SetUpTextOffsetX(newuptextoffsetx As Long) As Boolean	
		MUpTextOffsetX := newuptextoffsetx 
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpTextOffsetX() As Long
		Return Value MUpTextOffsetX	
	End Function
	
	Public Function SetUpTextOffsetY(newuptextoffsety As Long) As Boolean
		MUpTextOffsetY := newuptextoffsety 
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpTextOffsetY() As Long
		Return Value MUpTextOffsetY	
	End Function
//down	
	Public Function SetDownFont(newdownfont As AddressOf _Font) As Boolean
		MDownFont := newdownfont
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownFont() As AddressOf _Font
		Return Value MDownFont	
	End Function
		
	Public Function SetDownFontColor(newdownfontcolor As Long) As Boolean
		MDownFontColor := newdownfontcolor
		UpdateDrawColors()
		RedrawCompoundObject()
		Return Value True	
	End Function
		
	Public Function GetDownFontColor() As Long
		Return Value MDownFontColor
	End Function

	Public Function SetDownLineSpacing(newdownlinespacing As Double) As Boolean	
		If newdownlinespacing >= 0 Then
			MDownLineSpacing := newdownlinespacing
			RedrawCompoundObject()
			Return Value True
		Else
			Return Value False
		End If
	End Function
	
	Public Function GetDownLineSpacing() As Double
		Return Value MDownLineSpacing	
	End Function
	
	Public Function SetDownText(newdowntext As Text) As Boolean
		If GetMemorySegment(newdowntext) = _MSEG_RESOURCEDATA Then
			MDownText := newdowntext
		Else
			TextBuffer := newdowntext
			MDownText := TextBuffer
		End If
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownText() As AddressOf Text
		Return Value MDownText	
	End Function
	
	Public Function SetDownTextAlign(newdowntextalign As Long) As Boolean
		Select newdowntextalign
			Case _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNTOP, _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNVCENTER, _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNBOTTOM, _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNTOP, _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNVCENTER, _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNBOTTOM, _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNTOP, _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNVCENTER, _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNBOTTOM
				MDownTextAlign := newdowntextalign
				DownFormatFlags := MDownTextAlign BitOr _TEXT_WORDWRAP
				RedrawCompoundObject()
				Return Value True
	
			Case Else
				Return Value False
		End Select
	End Function
	
	Public Function GetDownTextAlign() As Long
		Return Value MDownTextAlign
	End Function
	
	Public Function SetDownTextOffsetX(newdowntextoffsetx As Long) As Boolean	
		MDownTextOffsetX := newdowntextoffsetx 
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownTextOffsetX() As Long
		Return Value MDownTextOffsetX	
	End Function
	
	Public Function SetDownTextOffsetY(newdowntextoffsety As Long) As Boolean
		MDownTextOffsetY := newdowntextoffsety 
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownTextOffsetY() As Long
		Return Value MDownTextOffsetY	
	End Function
// icon
// up 
	Public Function SetUpIcon(newupicon As AddressOf _Picture) As Boolean
		MUpIcon := newupicon
		UpdateIconPosition()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpIcon() As AddressOf _Picture
		Return Value MUpIcon	
	End Function
	
	Public Function SetUpIconAlign(newupiconalign As Long) As Boolean
		Select newupiconalign
			Case ICON_ALIGNLEFT BitOr ICON_ALIGNTOP, ICON_ALIGNLEFT BitOr ICON_ALIGNVCENTER, ICON_ALIGNLEFT BitOr ICON_ALIGNBOTTOM, ICON_ALIGNHCENTER BitOr ICON_ALIGNTOP, ICON_ALIGNHCENTER BitOr ICON_ALIGNVCENTER, ICON_ALIGNHCENTER BitOr ICON_ALIGNBOTTOM, ICON_ALIGNRIGHT BitOr ICON_ALIGNTOP, ICON_ALIGNRIGHT BitOr ICON_ALIGNVCENTER, ICON_ALIGNRIGHT BitOr ICON_ALIGNBOTTOM
				MUpIconAlign := newupiconalign
				UpdateIconPosition()
				RedrawCompoundObject()
				Return Value True
	
			Case Else
				Return Value False
		End Select
	End Function
	
	Public Function GetUpIconAlign() As Long
		Return Value MUpIconAlign
	End Function
	
	Public Function SetUpIconOffsetX(newupiconoffsetx As Long) As Boolean	
		MUpIconOffsetX := newupiconoffsetx 
		UpdateIconPosition()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpIconOffsetX() As Long
		Return Value MUpIconOffsetX	
	End Function
	
	Public Function SetUpIconOffsetY(newupiconoffsety As Long) As Boolean	
		MUpIconOffsetY := newupiconoffsety 
		UpdateIconPosition()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpIconOffsetY() As Long
		Return Value MUpIconOffsetY	
	End Function
// down
	Public Function SetDownIcon(newdownicon As AddressOf _Picture) As Boolean
		MDownIcon := newdownicon
		UpdateIconPosition()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownIcon() As AddressOf _Picture
		Return Value MDownIcon	
	End Function
	
	Public Function SetDownIconAlign(newdowniconalign As Long) As Boolean
		Select newdowniconalign
			Case ICON_ALIGNLEFT BitOr ICON_ALIGNTOP, ICON_ALIGNLEFT BitOr ICON_ALIGNVCENTER, ICON_ALIGNLEFT BitOr ICON_ALIGNBOTTOM, ICON_ALIGNHCENTER BitOr ICON_ALIGNTOP, ICON_ALIGNHCENTER BitOr ICON_ALIGNVCENTER, ICON_ALIGNHCENTER BitOr ICON_ALIGNBOTTOM, ICON_ALIGNRIGHT BitOr ICON_ALIGNTOP, ICON_ALIGNRIGHT BitOr ICON_ALIGNVCENTER, ICON_ALIGNRIGHT BitOr ICON_ALIGNBOTTOM
				MDownIconAlign := newdowniconalign
				UpdateIconPosition()
				RedrawCompoundObject()
				Return Value True
	
			Case Else
				Return Value False
		End Select
	End Function
	
	Public Function GetDownIconAlign() As Long
		Return Value MDownIconAlign
	End Function
	
	Public Function SetDownIconOffsetX(newdowniconoffsetx As Long) As Boolean	
		MDownIconOffsetX := newdowniconoffsetx 
		UpdateIconPosition()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownIconOffsetX() As Long
		Return Value MDownIconOffsetX	
	End Function
	
	Public Function SetDownIconOffsetY(newdowniconoffsety As Long) As Boolean	
		MDownIconOffsetY := newdowniconoffsety 
		UpdateIconPosition()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownIconOffsetY() As Long
		Return Value MDownIconOffsetY	
	End Function

	Public Function SetObjectDimensions(newwidth As Long, newheight As Long) As Boolean
		SetSize(newwidth, newheight)
		UpdateDimensions()
		RedrawCompoundObject()
		Return Value True
	End Function

	Public Function GetObjectDimensions(ByRef currentwidth As Long, ByRef currentheight As Long)
		GetSize(currentwidth, currentheight)
	End Function

	Public Function SetObjectPosition(newx As Long, newy As Long) As Boolean
		Var Response As Boolean
		Response := SetPosition(newx, newy)
		RedrawCompoundObject()
		Return Value Response
	End Function
	
	Public Function GetObjectPosition(ByRef currentx As Long, ByRef currenty As Long)
		GetPosition(currentx, currenty)
	End Function
	
End GraphicClass

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

Global GraphicClass ToggleButton Inherits Namespace "CUE.GraphicCollection.GenericObjectsBase.3".BaseToggleButton WithAttributes {defaultwidth := 120, defaultheight := 80,ObjectCode := "OB0077-001", DesignName := "Multicolor", GroupName := "Buttons"}
	Public Const BUTTON_STYLE_ROUNDED_CORNER				As Long	:= 1	
	Public Const BUTTON_STYLE_SHARP_CORNER				As Long	:= 2
	
	Global Const ICON_ALIGNLEFT As Long := &H00000001	// Horizontal align left
	Global Const ICON_ALIGNHCENTER As Long := &H00000002	// Horizontal align center
	Global Const ICON_ALIGNRIGHT As Long :=	&H00000004	// Horizontal align right
	Global Const ICON_ALIGNTOP As Long := &H00000008	// Vertical align top
	Global Const ICON_ALIGNVCENTER As Long := &H00000010	// Vertical align center
	Global Const ICON_ALIGNBOTTOM As Long := &H00000020	// Vertical align bottom

	
	// Behavior Property Group
	Protected Property Enabled 							As Boolean := True WithAttributes {PropertyGroup := "Behavior", EditMode := "Boolean; 'Yes' := True, 'No' := False"}
	Protected Property DefaultState 					As Boolean := False WithAttributes {PropertyGroup := "Behavior", EditMode := "Enum; 'Down' := True, 'Up' := False"}
	Protected Property ButtonCorner						As Long := BUTTON_STYLE_ROUNDED_CORNER WithAttributes {PropertyGroup := "Appearance",DisplayName := "ButtonStyle", EditMode:= "Enum; 'Sharp Corner' := BUTTON_STYLE_SHARP_CORNER, 'Rounded Corner' := BUTTON_STYLE_ROUNDED_CORNER"}
	Protected Property EventType 						As Long := EVENT_TYPE_ON_DOWN WithAttributes {PropertyGroup := "Behavior", EditMode := "Enum; 'OnDown' := EVENT_TYPE_ON_DOWN, 'OnUp' := EVENT_TYPE_ON_UP"}

	Protected Var		ButtonFont						As AddressOf _Font := GetButtonFont(GetPrimaryDisplay().GetWidth(),GetPrimaryDisplay().GetHeight()) 
	Protected Var		RectangleEdge					As Long := 2
	Protected Var		DownButtonColor					As Long := Namespace "CUE.GraphicCollection.MulticolorPalette.1".COLOR_ORANGE
	Protected Var		UpButtonColor					As Long := Namespace "CUE.GraphicCollection.MulticolorPalette.1".COLOR_ORANGE
	
	// Up Property Group
	Protected Property UpColor As Long := ColorUp() WithAttributes {PropertyGroup := "Up", EditMode := "color"}		
	
	Protected Var UpColorOpacity As Byte := 204 	
	Protected Property UpFont As AddressOf _Font := ButtonFont WithAttributes {PropertyGroup := "Up", EditMode := "font"}
	Protected Property UpFontColor As Long := FontColorUp() WithAttributes {PropertyGroup := "Up", EditMode := "color"}
	Protected Property UpIcon As AddressOf _Picture := Nothing WithAttributes {PropertyGroup := "Up"}
	Protected Property UpIconAlign As Long := ICON_ALIGNHCENTER BitOr ICON_ALIGNVCENTER WithAttributes {PropertyGroup := "Up", EditMode := "ENUM; 'Left-Top' := &H09, 'Left-Middle' := &H11, 'Left-Bottom' := &H21, 'Center-Top' := &H0A, 'Center-Middle' := &H12, 'Center-Bottom' := &H22, 'Right-Top' := &H0C, 'Right-Middle' := &H14, 'Right-Bottom' := &H24"}
	Protected Property UpIconOffsetX As Long := 0 WithAttributes {PropertyGroup := "Up"}
	Protected Property UpIconOffsetY As Long := 0 WithAttributes {PropertyGroup := "Up"}
	Protected Property UpLineSpacing As Double := 1.2 WithAttributes {PropertyGroup := "Up"}
	Protected Property UpText As AddressOf Text := txtCaption WithAttributes {PropertyGroup := "Up"}
	Protected Property UpTextAlign As Long := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNVCENTER WithAttributes {PropertyGroup := "Up", EditMode := "ENUM; 'Left-Top' := _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNTOP, 'Left-Middle' := _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNVCENTER, 'Left-Bottom' := _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNBOTTOM, 'Center-Top' := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNTOP, 'Center-Middle' := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNVCENTER, 'Center-Bottom' := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNBOTTOM, 'Right-Top' := _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNTOP, 'Right-Middle' := _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNVCENTER, 'Right-Bottom' := _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNBOTTOM"}
	Protected Property UpTextOffsetX As Long := 0 WithAttributes {PropertyGroup := "Up"}
	Protected Property UpTextOffsetY As Long := 0 WithAttributes {PropertyGroup := "Up"}

	// Down Property Group
	Protected Property DownColor As Long := ColorDown() WithAttributes {PropertyGroup := "Down", EditMode := "color"}

	Protected Var DownColorOpacity As Byte := UpColorOpacity
	Protected Property DownFont As AddressOf _Font := UpFont WithAttributes {PropertyGroup := "Down", EditMode := "font"}
	Protected Property DownFontColor As Long := _COLOR_BLACK WithAttributes {PropertyGroup := "Down", EditMode := "color"}
	Protected Property DownIcon As AddressOf _Picture := UpIcon WithAttributes {PropertyGroup := "Down"}
	Protected Property DownIconAlign As Long := UpIconAlign WithAttributes {PropertyGroup := "Down", EditMode := "ENUM; 'Left-Top' := &H09, 'Left-Middle' := &H11, 'Left-Bottom' := &H21, 'Center-Top' := &H0A, 'Center-Middle' := &H12, 'Center-Bottom' := &H22, 'Right-Top' := &H0C, 'Right-Middle' := &H14, 'Right-Bottom' := &H24"}
	Protected Property DownIconOffsetX As Long := UpIconOffsetX WithAttributes {PropertyGroup := "Down"}
	Protected Property DownIconOffsetY As Long := UpIconOffsetY WithAttributes {PropertyGroup := "Down"}
	Protected Property DownLineSpacing As Double := UpLineSpacing WithAttributes {PropertyGroup := "Down"}
	Protected Property DownText As AddressOf Text := UpText WithAttributes {PropertyGroup := "Down"}
	Protected Property DownTextAlign As Long := UpTextAlign WithAttributes {PropertyGroup := "Down", EditMode := "ENUM; 'Left-Top' := _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNTOP, 'Left-Middle' := _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNVCENTER, 'Left-Bottom' := _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNBOTTOM, 'Center-Top' := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNTOP, 'Center-Middle' := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNVCENTER, 'Center-Bottom' := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNBOTTOM, 'Right-Top' := _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNTOP, 'Right-Middle' := _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNVCENTER, 'Right-Bottom' := _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNBOTTOM"}
	Protected Property DownTextOffsetX As Long := UpTextOffsetX WithAttributes {PropertyGroup := "Down"}
	Protected Property DownTextOffsetY As Long := UpTextOffsetY WithAttributes {PropertyGroup := "Down"}

	Protected Var		Picture_Active_Up_Centre 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LUp 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RUp 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LDown 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RDown 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineDown 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineUp 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineRight 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineLeft 		As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Down_Centre	 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LUp			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RUp			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LDown		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RDown 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineDown 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineUp		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineRight 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineLeft	As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Up_Centre2 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LUp2 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RUp2 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LDown2 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RDown2 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineDown2 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineUp2 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineRight2 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineLeft2		As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Down_Centre2	 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LUp2		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RUp2		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LDown2		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RDown2 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineDown2 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineUp2		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineRight2 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineLeft2	As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Up_Centre3 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LUp3 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RUp3 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LDown3 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RDown3 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineDown3 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineUp3 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineRight3 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineLeft3		As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Down_Centre3	 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LUp3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RUp3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LDown3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RDown3 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineDown3 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineUp3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineRight3 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineLeft3	As AddressOf _Picture := Nothing

	Protected Var		Picture_Active_Color_Centre3	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LUp3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_RUp3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LDown3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_RDown3 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineDown3 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineUp3	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineRight3 As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineLeft3	As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Up_Centre4 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LUp4 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RUp4 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LDown4 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RDown4 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineDown4 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineUp4 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineRight4 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineLeft4		As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Down_Centre4	 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LUp4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RUp4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LDown4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RDown4 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineDown4 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineUp4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineRight4 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineLeft4	As AddressOf _Picture := Nothing

	Protected Var		Picture_Active_Color_Centre4	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LUp4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_RUp4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LDown4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_RDown4 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineDown4 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineUp4	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineRight4 As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineLeft4	As AddressOf _Picture := Nothing
	
	Protected Var		Up_Centre 		As AddressOf _Picture := Nothing
	Protected Var		Up_LUp 			As AddressOf _Picture := Nothing
	Protected Var		Up_RUp 			As AddressOf _Picture := Nothing
	Protected Var		Up_LDown 		As AddressOf _Picture := Nothing
	Protected Var		Up_RDown 		As AddressOf _Picture := Nothing
	Protected Var		Up_LineDown 	As AddressOf _Picture := Nothing
	Protected Var		Up_LineUp 		As AddressOf _Picture := Nothing
	Protected Var		Up_LineRight 	As AddressOf _Picture := Nothing
	Protected Var		Up_LineLeft 	As AddressOf _Picture := Nothing
	
	Protected Var		Down_Centre	 	As AddressOf _Picture := Nothing
	Protected Var		Down_LUp		As AddressOf _Picture := Nothing
	Protected Var		Down_RUp		As AddressOf _Picture := Nothing
	Protected Var		Down_LDown		As AddressOf _Picture := Nothing
	Protected Var		Down_RDown 		As AddressOf _Picture := Nothing
	Protected Var		Down_LineDown 	As AddressOf _Picture := Nothing
	Protected Var		Down_LineUp		As AddressOf _Picture := Nothing
	Protected Var		Down_LineRight 	As AddressOf _Picture := Nothing
	Protected Var		Down_LineLeft	As AddressOf _Picture := Nothing

	Protected Var		Centre 			As AddressOf _Picture := Nothing
	Protected Var		LUp   			As AddressOf _Picture := Nothing 		
	Protected Var		RUp 			As AddressOf _Picture := Nothing 	 	
	Protected Var		LDown  	 		As AddressOf _Picture := Nothing		
	Protected Var		RDown 	 		As AddressOf _Picture := Nothing		
	Protected Var		LineDown 		As AddressOf _Picture := Nothing	
	Protected Var		LineUp  		As AddressOf _Picture := Nothing 		
	Protected Var		LineRight  		As AddressOf _Picture := Nothing	
	Protected Var		LineLeft 		As AddressOf _Picture := Nothing	


	Protected Function InitObject()
		Picture_Active_Up_Centre			:= Nothing
		Picture_Active_Up_LUp 				:= picButton_LeftUp_Corner
		Picture_Active_Up_RUp 				:= picButton_RightUp_Corner
		Picture_Active_Up_LDown 			:= picButton_LeftDown_Corner
		Picture_Active_Up_RDown 			:= picButton_RightDown_Corner
		Picture_Active_Up_LineDown 			:= picButton_Down_Line
		Picture_Active_Up_LineUp 			:= picButton_Up_Line
		Picture_Active_Up_LineRight 		:= picButton_Right_Line
		Picture_Active_Up_LineLeft 			:= picButton_Left_Line
	
		Picture_Active_Down_LUp				:= picButton_LeftUp_Corner
		Picture_Active_Down_RUp				:= picButton_RightUp_Corner
		Picture_Active_Down_LDown			:= picButton_LeftDown_Corner
		Picture_Active_Down_RDown 			:= picButton_RightDown_Corner
		Picture_Active_Down_LineDown 		:= picButton_Down_Line
		Picture_Active_Down_LineUp			:= picButton_Up_Line
		Picture_Active_Down_LineRight 		:= picButton_Right_Line
		Picture_Active_Down_LineLeft		:= picButton_Left_Line
		
		Picture_Active_Up_Centre2			:= Nothing		
		Picture_Active_Up_LUp2 				:= picButton_LeftUp_Corner1
		Picture_Active_Up_RUp2 				:= picButton_RightUp_Corner1
		Picture_Active_Up_LDown2 			:= picButton_LeftDown_Corner1
		Picture_Active_Up_RDown2 			:= picButton_RightDown_Corner1
		Picture_Active_Up_LineDown2 		:= picButton_Down_Line1
		Picture_Active_Up_LineUp2 			:= picButton_Up_Line1
		Picture_Active_Up_LineRight2 		:= picButton_Right_Line1
		Picture_Active_Up_LineLeft2 		:= picButton_Left_Line1
	
		Picture_Active_Down_LUp2			:= picButton_LeftUp_Corner1
		Picture_Active_Down_RUp2			:= picButton_RightUp_Corner1
		Picture_Active_Down_LDown2			:= picButton_LeftDown_Corner1
		Picture_Active_Down_RDown2 			:= picButton_RightDown_Corner1
		Picture_Active_Down_LineDown2 		:= picButton_Down_Line1
		Picture_Active_Down_LineUp2			:= picButton_Up_Line1
		Picture_Active_Down_LineRight2 		:= picButton_Right_Line1
		Picture_Active_Down_LineLeft2		:= picButton_Left_Line1	
		
		Picture_Active_Up_Centre3			:= picButton_Centre3
		Picture_Active_Up_LUp3 				:= picButton_LeftUp_Corner3
		Picture_Active_Up_RUp3 				:= picButton_RightUp_Corner3
		Picture_Active_Up_LDown3 			:= picButton_LeftDown_Corner3
		Picture_Active_Up_RDown3 			:= picButton_RightDown_Corner3
		Picture_Active_Up_LineDown3 		:= picButton_Down_Line3
		Picture_Active_Up_LineUp3 			:= picButton_Up_Line3
		Picture_Active_Up_LineRight3 		:= picButton_Right_Line3
		Picture_Active_Up_LineLeft3 		:= picButton_Left_Line3

		Picture_Active_Down_Centre3			:= picButton_Centre_down3	
		Picture_Active_Down_LUp3			:= picButton_LeftUp_Corner_down3
		Picture_Active_Down_RUp3			:= picButton_RightUp_Corner_down3
		Picture_Active_Down_LDown3			:= picButton_LeftDown_Corner_down3
		Picture_Active_Down_RDown3 			:= picButton_RightDown_Corner_down3
		Picture_Active_Down_LineDown3 		:= picButton_Down_Line_down3
		Picture_Active_Down_LineUp3			:= picButton_Up_Line_down3
		Picture_Active_Down_LineRight3 		:= picButton_Right_Line_down3
		Picture_Active_Down_LineLeft3		:= picButton_Left_Line_down3
		
		Picture_Active_Color_Centre3		:= picButton_Centre_color3
		Picture_Active_Color_LUp3			:= picButton_LeftUp_Corner_color3
		Picture_Active_Color_RUp3			:= picButton_RightUp_Corner_color3
		Picture_Active_Color_LDown3			:= picButton_LeftDown_Corner_color3
		Picture_Active_Color_RDown3 		:= picButton_RightDown_Corner_color3
		Picture_Active_Color_LineDown3 		:= picButton_Down_Line_color3
		Picture_Active_Color_LineUp3		:= picButton_Up_Line_color3
		Picture_Active_Color_LineRight3 	:= picButton_Right_Line_color3
		Picture_Active_Color_LineLeft3		:= picButton_Left_Line_color3
		
		Picture_Active_Up_Centre4			:= picButton_Centre2
		Picture_Active_Up_LUp4 				:= picButton_LeftUp_Corner2
		Picture_Active_Up_RUp4 				:= picButton_RightUp_Corner2
		Picture_Active_Up_LDown4 			:= picButton_LeftDown_Corner2
		Picture_Active_Up_RDown4 			:= picButton_RightDown_Corner2
		Picture_Active_Up_LineDown4 		:= picButton_Down_Line2
		Picture_Active_Up_LineUp4 			:= picButton_Up_Line2
		Picture_Active_Up_LineRight4 		:= picButton_Right_Line2
		Picture_Active_Up_LineLeft4 		:= picButton_Left_Line2

		Picture_Active_Down_Centre4			:= picButton_Centre_down2	
		Picture_Active_Down_LUp4			:= picButton_LeftUp_Corner_down2
		Picture_Active_Down_RUp4			:= picButton_RightUp_Corner_down2
		Picture_Active_Down_LDown4			:= picButton_LeftDown_Corner_down2
		Picture_Active_Down_RDown4 			:= picButton_RightDown_Corner_down2
		Picture_Active_Down_LineDown4 		:= picButton_Down_Line_down2
		Picture_Active_Down_LineUp4			:= picButton_Up_Line_down2
		Picture_Active_Down_LineRight4 		:= picButton_Right_Line_down2
		Picture_Active_Down_LineLeft4		:= picButton_Left_Line_down2
		
		Picture_Active_Color_Centre4		:= picButton_Centre_color2
		Picture_Active_Color_LUp4			:= picButton_LeftUp_Corner_color2
		Picture_Active_Color_RUp4			:= picButton_RightUp_Corner_color2
		Picture_Active_Color_LDown4			:= picButton_LeftDown_Corner_color2
		Picture_Active_Color_RDown4 		:= picButton_RightDown_Corner_color2
		Picture_Active_Color_LineDown4 		:= picButton_Down_Line_color2
		Picture_Active_Color_LineUp4		:= picButton_Up_Line_color2
		Picture_Active_Color_LineRight4 	:= picButton_Right_Line_color2
		Picture_Active_Color_LineLeft4		:= picButton_Left_Line_color2	
	End Function

	Protected Function Init()
		GetProperty()
		InitObject()
		SetComponentColorUp(UpColor)
		SetComponentColorDown(DownColor)
		IsPressed := DefaultState
		SelButtonPic(GetPrimaryDisplay().GetWidth(),GetPrimaryDisplay().GetHeight(),ButtonCorner)
		UpFormatFlags := MUpTextAlign BitOr _TEXT_WORDWRAP
		DownFormatFlags := MDownTextAlign BitOr _TEXT_WORDWRAP
		UpdateDimensions()
		UpdateDrawColors()
		If ButtonCorner = BUTTON_STYLE_ROUNDED_CORNER Then
			DownOffset := 1
		Else
			DownOffset := 0
		End If
		RedrawCompoundObject()
	End Function
	
	Protected Function ColorUp()As Long
		If ButtonCorner = BUTTON_STYLE_ROUNDED_CORNER Then
			Return Value COLOR_ORANGE
		Else
			Return Value COLOR_GREYDARK
		End If
	End Function
	
	Protected Function ColorDown()As Long
		If ButtonCorner = BUTTON_STYLE_ROUNDED_CORNER Then
			Return Value COLOR_ORANGE
		Else
			Return Value COLOR_WHITE
		End If
	End Function
	
	Protected Function FontColorUp() As Long
		If ButtonCorner = BUTTON_STYLE_ROUNDED_CORNER Then
			Return Value _COLOR_BLACK
		Else
			Return Value _COLOR_WHITE
		End If	
	End Function
		
	Protected Function GetProperty()
	// Předání hodnot proměnným v bázové třídě
		MDefaultState			:= DefaultState	
		MEnabled				:= Enabled
		MEventType				:= EventType
		MUpFont					:= UpFont
		MUpFontColor			:= UpFontColor
		MUpIcon					:= UpIcon
		MUpIconAlign			:= UpIconAlign
		MUpIconOffsetX			:= UpIconOffsetX
		MUpIconOffsetY			:= UpIconOffsetY
		MUpLineSpacing			:= UpLineSpacing
		MUpText					:= UpText
		MUpTextAlign			:= UpTextAlign
		MUpTextOffsetX			:= UpTextOffsetX
		MUpTextOffsetY			:= UpTextOffsetY
		MDownFont				:= DownFont
		MDownFontColor			:= DownFontColor
		MDownIcon				:= DownIcon
		MDownIconAlign			:= DownIconAlign
		MDownIconOffsetX		:= DownIconOffsetX
		MDownIconOffsetY		:= DownIconOffsetY
		MDownLineSpacing		:= DownLineSpacing
		MDownText				:= DownText
		MDownTextAlign			:= DownTextAlign
		MDownTextOffsetX		:= DownTextOffsetX
		MDownTextOffsetY		:= DownTextOffsetY
	End Function
	
	Protected Function GetButtonFont(DisplayWidth As Long,DisplayHeight As Long) As AddressOf _Font
//	 přednastavený font podle rozlišení
		If DisplayWidth >= 1500 And DisplayHeight >= 900 Then
			Return Value fntSegoeUI50
		Else
			Return Value fntSegoeUI23 
		End If
	End Function
	
	Protected Function SelButtonPic(DisplayWidth As Long,DisplayHeight As Long, Corner As Long)
	// výběr vhodné velikosti obrázku tlačítka podle rozlišení
		Var i As Long := 1
		
		If Corner = BUTTON_STYLE_ROUNDED_CORNER Then
			If DisplayWidth >= 1500 And DisplayHeight >= 900 Then
				Up_Centre 		:= Picture_Active_Up_Centre4
				Up_LUp   	 	:= Picture_Active_Up_LUp4	
				Up_RUp 	 	 	:= Picture_Active_Up_RUp4	
				Up_LDown  	 	:= Picture_Active_Up_LDown4	
				Up_RDown 	 	:= Picture_Active_Up_RDown4		
				Up_LineDown 	:= Picture_Active_Up_LineDown4	
				Up_LineUp  	 	:= Picture_Active_Up_LineUp4	
				Up_LineRight  	:= Picture_Active_Up_LineRight4
				Up_LineLeft 	:= Picture_Active_Up_LineLeft4	
				
				Down_Centre	 	:= Picture_Active_Down_Centre4 
				Down_LUp 	 	:= Picture_Active_Down_LUp4	
				Down_RUp 	 	:= Picture_Active_Down_RUp4
				Down_LDown 	 	:= Picture_Active_Down_LDown4
				Down_RDown 	 	:= Picture_Active_Down_RDown4
				Down_LineDown 	:= Picture_Active_Down_LineDown4
				Down_LineUp 	:= Picture_Active_Down_LineUp4
				Down_LineRight 	:= Picture_Active_Down_LineRight4
				Down_LineLeft 	:= Picture_Active_Down_LineLeft4
				
				Centre 			:= Picture_Active_Color_Centre4
				LUp   	 		:= Picture_Active_Color_LUp4	
				RUp 	 	 	:= Picture_Active_Color_RUp4	
				LDown  	 		:= Picture_Active_Color_LDown4	
				RDown 	 		:= Picture_Active_Color_RDown4		
				LineDown 		:= Picture_Active_Color_LineDown4	
				LineUp  	 	:= Picture_Active_Color_LineUp4	
				LineRight  		:= Picture_Active_Color_LineRight4
				LineLeft 		:= Picture_Active_Color_LineLeft4						
			Else
				Up_Centre 		:= Picture_Active_Up_Centre3
				Up_LUp   	 	:= Picture_Active_Up_LUp3	
				Up_RUp 	 	 	:= Picture_Active_Up_RUp3	
				Up_LDown  	 	:= Picture_Active_Up_LDown3	
				Up_RDown 	 	:= Picture_Active_Up_RDown3		
				Up_LineDown 	:= Picture_Active_Up_LineDown3	
				Up_LineUp  	 	:= Picture_Active_Up_LineUp3	
				Up_LineRight  	:= Picture_Active_Up_LineRight3
				Up_LineLeft 	:= Picture_Active_Up_LineLeft3	
				
				Down_Centre	 	:= Picture_Active_Down_Centre3 
				Down_LUp 	 	:= Picture_Active_Down_LUp3	
				Down_RUp 	 	:= Picture_Active_Down_RUp3
				Down_LDown 	 	:= Picture_Active_Down_LDown3
				Down_RDown 	 	:= Picture_Active_Down_RDown3
				Down_LineDown 	:= Picture_Active_Down_LineDown3
				Down_LineUp 	:= Picture_Active_Down_LineUp3
				Down_LineRight 	:= Picture_Active_Down_LineRight3
				Down_LineLeft 	:= Picture_Active_Down_LineLeft3
				
				Centre 			:= Picture_Active_Color_Centre3
				LUp   	 		:= Picture_Active_Color_LUp3	
				RUp 	 	 	:= Picture_Active_Color_RUp3	
				LDown  	 		:= Picture_Active_Color_LDown3	
				RDown 	 		:= Picture_Active_Color_RDown3		
				LineDown 		:= Picture_Active_Color_LineDown3	
				LineUp  	 	:= Picture_Active_Color_LineUp3	
				LineRight  		:= Picture_Active_Color_LineRight3
				LineLeft 		:= Picture_Active_Color_LineLeft3
			End If
		
		Else

			If DisplayWidth >= 1500 And DisplayHeight >= 900 Then
				RectangleEdge	:= 3
				Up_Centre 		:= Picture_Active_Up_Centre2
				Up_LUp   	 	:= Picture_Active_Up_LUp2	
				Up_RUp 	 	 	:= Picture_Active_Up_RUp2	
				Up_LDown  	 	:= Picture_Active_Up_LDown2	
				Up_RDown 	 	:= Picture_Active_Up_RDown2		
				Up_LineDown 	:= Picture_Active_Up_LineDown2	
				Up_LineUp  	 	:= Picture_Active_Up_LineUp2	
				Up_LineRight  	:= Picture_Active_Up_LineRight2
				Up_LineLeft 	:= Picture_Active_Up_LineLeft2	
				
				Down_Centre	 	:= Picture_Active_Down_Centre2 
				Down_LUp 	 	:= Picture_Active_Down_LUp2	
				Down_RUp 	 	:= Picture_Active_Down_RUp2
				Down_LDown 	 	:= Picture_Active_Down_LDown2
				Down_RDown 	 	:= Picture_Active_Down_RDown2
				Down_LineDown 	:= Picture_Active_Down_LineDown2
				Down_LineUp 	:= Picture_Active_Down_LineUp2
				Down_LineRight 	:= Picture_Active_Down_LineRight2
				Down_LineLeft 	:= Picture_Active_Down_LineLeft2
				
			Else
				RectangleEdge	:= 2
				Up_Centre 		:= Picture_Active_Up_Centre
				Up_LUp   	 	:= Picture_Active_Up_LUp	
				Up_RUp 	 	 	:= Picture_Active_Up_RUp	
				Up_LDown  	 	:= Picture_Active_Up_LDown	
				Up_RDown 	 	:= Picture_Active_Up_RDown		
				Up_LineDown 	:= Picture_Active_Up_LineDown	
				Up_LineUp  	 	:= Picture_Active_Up_LineUp	
				Up_LineRight  	:= Picture_Active_Up_LineRight
				Up_LineLeft 	:= Picture_Active_Up_LineLeft	
				
				Down_Centre	 	:= Picture_Active_Down_Centre 
				Down_LUp 	 	:= Picture_Active_Down_LUp	
				Down_RUp 	 	:= Picture_Active_Down_RUp
				Down_LDown 	 	:= Picture_Active_Down_LDown
				Down_RDown 	 	:= Picture_Active_Down_RDown
				Down_LineDown 	:= Picture_Active_Down_LineDown
				Down_LineUp 	:= Picture_Active_Down_LineUp
				Down_LineRight 	:= Picture_Active_Down_LineRight
				Down_LineLeft 	:= Picture_Active_Down_LineLeft	
						
			End If
		End If
	End Function
	
	Protected Function SetComponentColorUp(Upcolor As Long)
		UpColorOpacity := GetColorComponentOpacity(Upcolor)	
		UpButtonColor := SetColorComponentOpacity(Upcolor,255)
	End Function
	
	Protected Function SetComponentColorDown(downColor As Long)
		DownColorOpacity := GetColorComponentOpacity(downColor)	
		DownButtonColor := SetColorComponentOpacity(downColor,255)
	End Function
	
	Protected Function RedrawCompoundObject()
	
		LockRedraw()
	
		If IsPressed Then
			PictureLayer1.Hide()
			PictureLayer2.Hide()
			Redraw()
	
			PictureLayer3.SetPicture(MDownIcon)
			PictureLayer3.SetOpacity(DrawOpacity)
			PictureLayer3.SetFitting(FITTING_FIT_OBJECT_TO_CONTENT)
			PictureLayer3.SetObjectPosition(DownIconX + DownOffset, DownIconY + DownOffset)
	
			TextLayer.SetFont(MDownFont)
			TextLayer.SetText(MDownText)
			TextLayer.SetColor(DownDrawFontColor)
			TextLayer.SetAlign(DownFormatFlags)
			TextLayer.SetTextOffsetX(MDownTextOffsetX+ DownOffset)
			TextLayer.SetTextOffsetY(MDownTextOffsetY+ DownOffset)
			TextLayer.SetLineSpacing(MDownLineSpacing)
			TextLayer.SetObjectPosition(0, 0)
			TextLayer.SetObjectDimensions(ObjectWidth, ObjectHeight)
			
		Else
			PictureLayer1.Hide()
			PictureLayer2.Hide()
			Redraw()
			
			PictureLayer3.SetPicture(MUpIcon)
			PictureLayer3.SetOpacity(DrawOpacity)
			PictureLayer3.SetFitting(FITTING_FIT_OBJECT_TO_CONTENT)
			PictureLayer3.SetObjectPosition(UpIconX , UpIconY )
			
			TextLayer.SetFont(MUpFont)
			TextLayer.SetText(MUpText)
			TextLayer.SetColor(UpDrawFontColor)
			TextLayer.SetAlign(UpFormatFlags)
			TextLayer.SetTextOffsetX(MUpTextOffsetX)
			TextLayer.SetTextOffsetY(MUpTextOffsetY)
			TextLayer.SetLineSpacing(MUpLineSpacing)
			TextLayer.SetObjectPosition(0, 0)
			TextLayer.SetObjectDimensions(ObjectWidth, ObjectHeight)
		End If

		UnlockRedraw()
	
	End Function
	
	Private Function Draw3DButton(state As Boolean)
		Var Width As Long
		Var Height As Long

		Me.GetSize(Width,Height)
		If ButtonCorner = BUTTON_STYLE_ROUNDED_CORNER Then
			If 	state Then
				DrawStretchedTintedPicture(LineUp,DownButtonColor,Down_RUp.GetWidth(),0,Width-2*Down_RUp.GetWidth(),Down_RUp.GetHeight(),0,0,-1,-1,DownColorOpacity)
				DrawStretchedTintedPicture(LineRight,DownButtonColor,Width-Down_RUp.GetWidth(),Down_RUp.GetHeight(),Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight(),0,0,-1,-1,DownColorOpacity)
				DrawStretchedTintedPicture(LineDown,DownButtonColor,Down_RUp.GetWidth(),Height-Down_RUp.GetHeight(),Width-2*Down_RUp.GetWidth(),Down_RUp.GetHeight(),0,0,-1,-1,DownColorOpacity)
				DrawStretchedTintedPicture(LineLeft,DownButtonColor,0,Down_RUp.GetHeight(),Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight(),0,0,-1,-1,DownColorOpacity)			
				DrawStretchedTintedPicture(Centre,DownButtonColor,Down_RUp.GetWidth(),Down_RUp.GetHeight(),Width-2*Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight(),0,0,-1,-1,DownColorOpacity)

				DrawTintedPicture(LUp,DownButtonColor,0,0,-1,-1,0,0,DownColorOpacity)
				DrawTintedPicture(RUp,DownButtonColor,Width-Down_RUp.GetWidth(),0,-1,-1,0,0,DownColorOpacity)
				DrawTintedPicture(LDown,DownButtonColor,0,Height-Down_RUp.GetHeight(),-1,-1,0,0,DownColorOpacity)
				DrawTintedPicture(RDown,DownButtonColor,Width-Down_RUp.GetWidth(),Height-Down_RUp.GetHeight(),-1,-1,0,0,DownColorOpacity)	
			Else
				DrawStretchedTintedPicture(LineUp,UpButtonColor,Down_RUp.GetWidth(),0,Width-2*Down_RUp.GetWidth(),Down_RUp.GetHeight(),0,0,-1,-1,UpColorOpacity)
				DrawStretchedTintedPicture(LineRight,UpButtonColor,Width-Down_RUp.GetWidth(),Down_RUp.GetHeight(),Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight(),0,0,-1,-1,UpColorOpacity)
				DrawStretchedTintedPicture(LineDown,UpButtonColor,Down_RUp.GetWidth(),Height-Down_RUp.GetHeight(),Width-2*Down_RUp.GetWidth(),Down_RUp.GetHeight(),0,0,-1,-1,UpColorOpacity)
				DrawStretchedTintedPicture(LineLeft,UpButtonColor,0,Down_RUp.GetHeight(),Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight(),0,0,-1,-1,UpColorOpacity)			
				DrawStretchedTintedPicture(Centre,UpButtonColor,Down_RUp.GetWidth(),Down_RUp.GetHeight(),Width-2*Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight(),0,0,-1,-1,UpColorOpacity)
			
				DrawTintedPicture(LUp,UpButtonColor,0,0,-1,-1,0,0,UpColorOpacity)
				DrawTintedPicture(RUp,UpButtonColor,Width-Down_RUp.GetWidth(),0,-1,-1,0,0,UpColorOpacity)
				DrawTintedPicture(LDown,UpButtonColor,0,Height-Down_RUp.GetHeight(),-1,-1,0,0,UpColorOpacity)
				DrawTintedPicture(RDown,UpButtonColor,Width-Down_RUp.GetWidth(),Height-Down_RUp.GetHeight(),-1,-1,0,0,UpColorOpacity)
			End If	
		Else	
			If 	state Then
				DrawRectangle(DownColor,RectangleEdge,RectangleEdge,Width-2*RectangleEdge,Height-2*RectangleEdge)
			Else
				DrawRectangle(UpColor,RectangleEdge,RectangleEdge,Width-2*RectangleEdge,Height-2*RectangleEdge)
			End If
		End If
		
			If 	state Then
				DrawStretchedPicture(Down_LineUp,Down_RUp.GetWidth(),0,Width-2*Down_RUp.GetWidth(),Down_RUp.GetHeight())
				DrawStretchedPicture(Down_LineRight,Width-Down_RUp.GetWidth(),Down_RUp.GetHeight(),Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight())
				DrawStretchedPicture(Down_LineDown,Down_RUp.GetWidth(),Height-Down_RUp.GetHeight(),Width-2*Down_RUp.GetWidth(),Down_RUp.GetHeight())
				DrawStretchedPicture(Down_LineLeft,0,Down_RUp.GetHeight(),Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight())			
				DrawStretchedPicture(Down_Centre,Down_RUp.GetWidth(),Down_RUp.GetHeight(),Width-2*Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight())
			
				DrawPicture(Down_LUp,0,0)
				DrawPicture(Down_RUp,Width-Down_RUp.GetWidth(),0)
				DrawPicture(Down_LDown,0,Height-Down_RUp.GetHeight())
				DrawPicture(Down_RDown,Width-Down_RUp.GetWidth(),Height-Down_RUp.GetHeight())			
			Else						
				DrawStretchedPicture(Up_LineUp,Up_RUp.GetWidth(),0,Width-2*Up_RUp.GetWidth(),Up_RUp.GetHeight())
				DrawStretchedPicture(Up_LineRight,Width-Up_RUp.GetWidth(),Up_RUp.GetHeight(),Up_RUp.GetWidth(),Height-2*Up_RUp.GetHeight())
				DrawStretchedPicture(Up_LineDown,Up_RUp.GetWidth(),Height-Up_RUp.GetHeight(),Width-2*Up_RUp.GetWidth(),Up_RUp.GetHeight())
				DrawStretchedPicture(Up_LineLeft,0,Up_RUp.GetHeight(),Up_RUp.GetWidth(),Height-2*Up_RUp.GetHeight())
				DrawStretchedPicture(Up_Centre,Up_RUp.GetWidth(),Up_RUp.GetHeight(),Width-2*Up_RUp.GetWidth(),Height-2*Up_RUp.GetHeight())
			
				DrawPicture(Up_LUp,0,0)
				DrawPicture(Up_RUp,Width-Up_RUp.GetWidth(),0)
				DrawPicture(Up_LDown,0,Height-Up_RUp.GetHeight())
				DrawPicture(Up_RDown,Width-Up_RUp.GetWidth(),Height-Up_RUp.GetHeight())
			End If
		
	End Function	


	Public Function SetButtonStyle(newbuttonstyle As Long) As Boolean
		If newbuttonstyle  = BUTTON_STYLE_ROUNDED_CORNER Then
			DownOffset := 1
		Else
			DownOffset := 0
		End If
		ButtonCorner := newbuttonstyle
		SelButtonPic(GetPrimaryDisplay().GetWidth(),GetPrimaryDisplay().GetHeight(),ButtonCorner)
		UpdateDimensions()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetButtonStyle() As Long
		Return Value ButtonCorner
	End Function
	
//colors button
	Public Function SetDownColor(newdowncolor As Long) As Boolean
		DownColor := newdowncolor
		SetComponentColorDown(newdowncolor)
		RedrawCompoundObject()
		Return Value True
	End Function
	
	Public Function SetUpColor(newupcolor As Long) As Boolean
		UpColor := newupcolor
		SetComponentColorUp(newupcolor)
		RedrawCompoundObject()
		Return Value True	
	End Function
		
	Public Function GetDownColor() As Long
		Return Value DownColor
	End Function
	
	Public Function GetUpColor() As Long
		Return Value UpColor
	End Function
	
// text
//up
	Public Function SetUpFont(newupfont As AddressOf _Font) As Boolean
		MUpFont := newupfont
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpFont() As AddressOf _Font
		Return Value MUpFont	
	End Function
		
	Public Function SetUpFontColor(newupfontcolor As Long) As Boolean
		MUpFontColor := newupfontcolor
		UpdateDrawColors()
		RedrawCompoundObject()
		Return Value True	
	End Function
		
	Public Function GetUpFontColor() As Long
		Return Value MUpFontColor
	End Function

	Public Function SetUpLineSpacing(newuplinespacing As Double) As Boolean	
		If newuplinespacing >= 0 Then
			MUpLineSpacing := newuplinespacing
			RedrawCompoundObject()
			Return Value True
		Else
			Return Value False
		End If
	End Function
	
	Public Function GetUpLineSpacing() As Double
		Return Value MUpLineSpacing	
	End Function
	
	Public Function SetUpText(newuptext As Text) As Boolean
		If GetMemorySegment(newuptext) = _MSEG_RESOURCEDATA Then
			MUpText := newuptext
		Else
			TextBuffer := newuptext
			MUpText := TextBuffer
		End If
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpText() As AddressOf Text
		Return Value MUpText	
	End Function
	
	Public Function SetUpTextAlign(newuptextalign As Long) As Boolean
		Select newuptextalign
			Case _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNTOP, _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNVCENTER, _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNBOTTOM, _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNTOP, _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNVCENTER, _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNBOTTOM, _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNTOP, _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNVCENTER, _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNBOTTOM
				MUpTextAlign := newuptextalign
				UpFormatFlags := MUpTextAlign BitOr _TEXT_WORDWRAP
				RedrawCompoundObject()
				Return Value True
	
			Case Else
				Return Value False
		End Select
	End Function
	
	Public Function GetUpTextAlign() As Long
		Return Value MUpTextAlign
	End Function
	
	Public Function SetUpTextOffsetX(newuptextoffsetx As Long) As Boolean	
		MUpTextOffsetX := newuptextoffsetx 
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpTextOffsetX() As Long
		Return Value MUpTextOffsetX	
	End Function
	
	Public Function SetUpTextOffsetY(newuptextoffsety As Long) As Boolean
		MUpTextOffsetY := newuptextoffsety 
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpTextOffsetY() As Long
		Return Value MUpTextOffsetY	
	End Function
//down	
	Public Function SetDownFont(newdownfont As AddressOf _Font) As Boolean
		MDownFont := newdownfont
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownFont() As AddressOf _Font
		Return Value MDownFont	
	End Function
		
	Public Function SetDownFontColor(newdownfontcolor As Long) As Boolean
		MDownFontColor := newdownfontcolor
		UpdateDrawColors()
		RedrawCompoundObject()
		Return Value True	
	End Function
		
	Public Function GetDownFontColor() As Long
		Return Value MDownFontColor
	End Function

	Public Function SetDownLineSpacing(newdownlinespacing As Double) As Boolean	
		If newdownlinespacing >= 0 Then
			MDownLineSpacing := newdownlinespacing
			RedrawCompoundObject()
			Return Value True
		Else
			Return Value False
		End If
	End Function
	
	Public Function GetDownLineSpacing() As Double
		Return Value MDownLineSpacing	
	End Function
	
	Public Function SetDownText(newdowntext As Text) As Boolean
		If GetMemorySegment(newdowntext) = _MSEG_RESOURCEDATA Then
			MDownText := newdowntext
		Else
			TextBuffer := newdowntext
			MDownText := TextBuffer
		End If
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownText() As AddressOf Text
		Return Value MDownText	
	End Function
	
	Public Function SetDownTextAlign(newdowntextalign As Long) As Boolean
		Select newdowntextalign
			Case _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNTOP, _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNVCENTER, _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNBOTTOM, _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNTOP, _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNVCENTER, _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNBOTTOM, _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNTOP, _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNVCENTER, _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNBOTTOM
				MDownTextAlign := newdowntextalign
				DownFormatFlags := MDownTextAlign BitOr _TEXT_WORDWRAP
				RedrawCompoundObject()
				Return Value True
	
			Case Else
				Return Value False
		End Select
	End Function
	
	Public Function GetDownTextAlign() As Long
		Return Value MDownTextAlign
	End Function
	
	Public Function SetDownTextOffsetX(newdowntextoffsetx As Long) As Boolean	
		MDownTextOffsetX := newdowntextoffsetx 
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownTextOffsetX() As Long
		Return Value MDownTextOffsetX	
	End Function
	
	Public Function SetDownTextOffsetY(newdowntextoffsety As Long) As Boolean
		MDownTextOffsetY := newdowntextoffsety 
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownTextOffsetY() As Long
		Return Value MDownTextOffsetY	
	End Function
// icon
// up 
	Public Function SetUpIcon(newupicon As AddressOf _Picture) As Boolean
		MUpIcon := newupicon
		UpdateIconPosition()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpIcon() As AddressOf _Picture
		Return Value MUpIcon	
	End Function
	
	Public Function SetUpIconAlign(newupiconalign As Long) As Boolean
		Select newupiconalign
			Case ICON_ALIGNLEFT BitOr ICON_ALIGNTOP, ICON_ALIGNLEFT BitOr ICON_ALIGNVCENTER, ICON_ALIGNLEFT BitOr ICON_ALIGNBOTTOM, ICON_ALIGNHCENTER BitOr ICON_ALIGNTOP, ICON_ALIGNHCENTER BitOr ICON_ALIGNVCENTER, ICON_ALIGNHCENTER BitOr ICON_ALIGNBOTTOM, ICON_ALIGNRIGHT BitOr ICON_ALIGNTOP, ICON_ALIGNRIGHT BitOr ICON_ALIGNVCENTER, ICON_ALIGNRIGHT BitOr ICON_ALIGNBOTTOM
				MUpIconAlign := newupiconalign
				UpdateIconPosition()
				RedrawCompoundObject()
				Return Value True
	
			Case Else
				Return Value False
		End Select
	End Function
	
	Public Function GetUpIconAlign() As Long
		Return Value MUpIconAlign
	End Function
	
	Public Function SetUpIconOffsetX(newupiconoffsetx As Long) As Boolean	
		MUpIconOffsetX := newupiconoffsetx 
		UpdateIconPosition()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpIconOffsetX() As Long
		Return Value MUpIconOffsetX	
	End Function
	
	Public Function SetUpIconOffsetY(newupiconoffsety As Long) As Boolean	
		MUpIconOffsetY := newupiconoffsety 
		UpdateIconPosition()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpIconOffsetY() As Long
		Return Value MUpIconOffsetY	
	End Function
// down
	Public Function SetDownIcon(newdownicon As AddressOf _Picture) As Boolean
		MDownIcon := newdownicon
		UpdateIconPosition()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownIcon() As AddressOf _Picture
		Return Value MDownIcon	
	End Function
	
	Public Function SetDownIconAlign(newdowniconalign As Long) As Boolean
		Select newdowniconalign
			Case ICON_ALIGNLEFT BitOr ICON_ALIGNTOP, ICON_ALIGNLEFT BitOr ICON_ALIGNVCENTER, ICON_ALIGNLEFT BitOr ICON_ALIGNBOTTOM, ICON_ALIGNHCENTER BitOr ICON_ALIGNTOP, ICON_ALIGNHCENTER BitOr ICON_ALIGNVCENTER, ICON_ALIGNHCENTER BitOr ICON_ALIGNBOTTOM, ICON_ALIGNRIGHT BitOr ICON_ALIGNTOP, ICON_ALIGNRIGHT BitOr ICON_ALIGNVCENTER, ICON_ALIGNRIGHT BitOr ICON_ALIGNBOTTOM
				MDownIconAlign := newdowniconalign
				UpdateIconPosition()
				RedrawCompoundObject()
				Return Value True
	
			Case Else
				Return Value False
		End Select
	End Function
	
	Public Function GetDownIconAlign() As Long
		Return Value MDownIconAlign
	End Function
	
	Public Function SetDownIconOffsetX(newdowniconoffsetx As Long) As Boolean	
		MDownIconOffsetX := newdowniconoffsetx
		UpdateIconPosition() 
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownIconOffsetX() As Long
		Return Value MDownIconOffsetX	
	End Function
	
	Public Function SetDownIconOffsetY(newdowniconoffsety As Long) As Boolean	
		MDownIconOffsetY := newdowniconoffsety 
		UpdateIconPosition()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownIconOffsetY() As Long
		Return Value MDownIconOffsetY	
	End Function
	
	Public Function SetObjectDimensions(newwidth As Long, newheight As Long) As Boolean
		SetSize(newwidth, newheight)
		UpdateDimensions()
		RedrawCompoundObject()
		Return Value True
	End Function

	Public Function GetObjectDimensions(ByRef currentwidth As Long, ByRef currentheight As Long)
		GetSize(currentwidth, currentheight)
	End Function

	Public Function SetObjectPosition(newx As Long, newy As Long) As Boolean
		Var Response As Boolean
		Response := SetPosition(newx, newy)
		RedrawCompoundObject()
		Return Value Response
	End Function
	
	Public Function GetObjectPosition(ByRef currentx As Long, ByRef currenty As Long)
		GetPosition(currentx, currenty)
	End Function
	
End GraphicClass

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

Global GraphicClass TwoStatePushButton Inherits Namespace "CUE.GraphicCollection.GenericObjectsBase.3".BaseTwoStatePushButton WithAttributes {defaultwidth := 120, defaultheight := 80,ObjectCode := "OB0081-001", DesignName := "Multicolor", GroupName := "Buttons"}
	Public Const BUTTON_STYLE_ROUNDED_CORNER				As Long	:= 1	
	Public Const BUTTON_STYLE_SHARP_CORNER				As Long	:= 2
	
	Global Const ICON_ALIGNLEFT As Long := &H00000001	// Horizontal align left
	Global Const ICON_ALIGNHCENTER As Long := &H00000002	// Horizontal align center
	Global Const ICON_ALIGNRIGHT As Long :=	&H00000004	// Horizontal align right
	Global Const ICON_ALIGNTOP As Long := &H00000008	// Vertical align top
	Global Const ICON_ALIGNVCENTER As Long := &H00000010	// Vertical align center
	Global Const ICON_ALIGNBOTTOM As Long := &H00000020	// Vertical align bottom

	
	// Behavior Property Group
	Protected Property Enabled 							As Boolean := True WithAttributes {PropertyGroup := "Behavior", EditMode := "Boolean; 'Yes' := True, 'No' := False"}
	Protected Property DefaultState 					As Boolean := False WithAttributes {PropertyGroup := "Behavior", EditMode := "Enum; 'Down' := True, 'Up' := False"}
	Protected Property ButtonCorner						As Long := BUTTON_STYLE_ROUNDED_CORNER WithAttributes {PropertyGroup := "Appearance",DisplayName := "ButtonStyle", EditMode:= "Enum; 'Sharp Corner' := BUTTON_STYLE_SHARP_CORNER, 'Rounded Corner' := BUTTON_STYLE_ROUNDED_CORNER"}
	
	Protected Var		ButtonFont						As AddressOf _Font := GetButtonFont(GetPrimaryDisplay().GetWidth(),GetPrimaryDisplay().GetHeight()) 
	Protected Var		RectangleEdge					As Long := 2
	Protected Var		DownButtonColor					As Long := Namespace "CUE.GraphicCollection.MulticolorPalette.1".COLOR_ORANGE
	Protected Var		UpButtonColor					As Long := Namespace "CUE.GraphicCollection.MulticolorPalette.1".COLOR_ORANGE
	
	// Up Property Group
	Protected Property UpColor As Long := ColorUp() WithAttributes {PropertyGroup := "Up", EditMode := "color"}		
	
	Protected Var UpColorOpacity As Byte := 204 
	Protected Property UpFont As AddressOf _Font := ButtonFont WithAttributes {PropertyGroup := "Up", EditMode := "font"}
	Protected Property UpFontColor As Long := FontColorUp() WithAttributes {PropertyGroup := "Up", EditMode := "color"}
	Protected Property UpIcon As AddressOf _Picture := Nothing WithAttributes {PropertyGroup := "Up"}
	Protected Property UpIconAlign As Long := ICON_ALIGNHCENTER BitOr ICON_ALIGNVCENTER WithAttributes {PropertyGroup := "Up", EditMode := "ENUM; 'Left-Top' := &H09, 'Left-Middle' := &H11, 'Left-Bottom' := &H21, 'Center-Top' := &H0A, 'Center-Middle' := &H12, 'Center-Bottom' := &H22, 'Right-Top' := &H0C, 'Right-Middle' := &H14, 'Right-Bottom' := &H24"}
	Protected Property UpIconOffsetX As Long := 0 WithAttributes {PropertyGroup := "Up"}
	Protected Property UpIconOffsetY As Long := 0 WithAttributes {PropertyGroup := "Up"}
	Protected Property UpLineSpacing As Double := 1.2 WithAttributes {PropertyGroup := "Up"}
	Protected Property UpText As AddressOf Text := txtCaption WithAttributes {PropertyGroup := "Up"}
	Protected Property UpTextAlign As Long := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNVCENTER WithAttributes {PropertyGroup := "Up", EditMode := "ENUM; 'Left-Top' := _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNTOP, 'Left-Middle' := _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNVCENTER, 'Left-Bottom' := _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNBOTTOM, 'Center-Top' := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNTOP, 'Center-Middle' := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNVCENTER, 'Center-Bottom' := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNBOTTOM, 'Right-Top' := _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNTOP, 'Right-Middle' := _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNVCENTER, 'Right-Bottom' := _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNBOTTOM"}
	Protected Property UpTextOffsetX As Long := 0 WithAttributes {PropertyGroup := "Up"}
	Protected Property UpTextOffsetY As Long := 0 WithAttributes {PropertyGroup := "Up"}

	// Down Property Group
	Protected Property DownColor As Long := ColorDown() WithAttributes {PropertyGroup := "Down", EditMode := "color"}

	Protected Var DownColorOpacity As Byte := UpColorOpacity
	Protected Property DownFont As AddressOf _Font := UpFont WithAttributes {PropertyGroup := "Down", EditMode := "font"}
	Protected Property DownFontColor As Long := _COLOR_BLACK WithAttributes {PropertyGroup := "Down", EditMode := "color"}
	Protected Property DownIcon As AddressOf _Picture := UpIcon WithAttributes {PropertyGroup := "Down"}
	Protected Property DownIconAlign As Long := UpIconAlign WithAttributes {PropertyGroup := "Down", EditMode := "ENUM; 'Left-Top' := &H09, 'Left-Middle' := &H11, 'Left-Bottom' := &H21, 'Center-Top' := &H0A, 'Center-Middle' := &H12, 'Center-Bottom' := &H22, 'Right-Top' := &H0C, 'Right-Middle' := &H14, 'Right-Bottom' := &H24"}
	Protected Property DownIconOffsetX As Long := UpIconOffsetX WithAttributes {PropertyGroup := "Down"}
	Protected Property DownIconOffsetY As Long := UpIconOffsetY WithAttributes {PropertyGroup := "Down"}
	Protected Property DownLineSpacing As Double := UpLineSpacing WithAttributes {PropertyGroup := "Down"}
	Protected Property DownText As AddressOf Text := UpText WithAttributes {PropertyGroup := "Down"}
	Protected Property DownTextAlign As Long := UpTextAlign WithAttributes {PropertyGroup := "Down", EditMode := "ENUM; 'Left-Top' := _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNTOP, 'Left-Middle' := _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNVCENTER, 'Left-Bottom' := _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNBOTTOM, 'Center-Top' := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNTOP, 'Center-Middle' := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNVCENTER, 'Center-Bottom' := _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNBOTTOM, 'Right-Top' := _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNTOP, 'Right-Middle' := _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNVCENTER, 'Right-Bottom' := _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNBOTTOM"}
	Protected Property DownTextOffsetX As Long := UpTextOffsetX WithAttributes {PropertyGroup := "Down"}
	Protected Property DownTextOffsetY As Long := UpTextOffsetY WithAttributes {PropertyGroup := "Down"}

	Protected Var		Picture_Active_Up_Centre 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LUp 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RUp 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LDown 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RDown 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineDown 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineUp 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineRight 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineLeft 		As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Down_Centre	 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LUp			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RUp			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LDown		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RDown 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineDown 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineUp		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineRight 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineLeft	As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Up_Centre2 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LUp2 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RUp2 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LDown2 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RDown2 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineDown2 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineUp2 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineRight2 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineLeft2		As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Down_Centre2	 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LUp2		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RUp2		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LDown2		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RDown2 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineDown2 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineUp2		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineRight2 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineLeft2	As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Up_Centre3 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LUp3 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RUp3 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LDown3 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RDown3 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineDown3 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineUp3 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineRight3 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineLeft3		As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Down_Centre3	 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LUp3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RUp3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LDown3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RDown3 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineDown3 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineUp3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineRight3 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineLeft3	As AddressOf _Picture := Nothing

	Protected Var		Picture_Active_Color_Centre3	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LUp3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_RUp3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LDown3		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_RDown3 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineDown3 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineUp3	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineRight3 As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineLeft3	As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Up_Centre4 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LUp4 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RUp4 			As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LDown4 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_RDown4 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineDown4 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineUp4 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineRight4 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Up_LineLeft4		As AddressOf _Picture := Nothing
	
	Protected Var		Picture_Active_Down_Centre4	 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LUp4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RUp4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LDown4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_RDown4 		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineDown4 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineUp4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineRight4 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Down_LineLeft4	As AddressOf _Picture := Nothing

	Protected Var		Picture_Active_Color_Centre4	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LUp4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_RUp4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LDown4		As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_RDown4 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineDown4 	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineUp4	As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineRight4 As AddressOf _Picture := Nothing
	Protected Var		Picture_Active_Color_LineLeft4	As AddressOf _Picture := Nothing
	
	Protected Var		Up_Centre 		As AddressOf _Picture := Nothing
	Protected Var		Up_LUp 			As AddressOf _Picture := Nothing
	Protected Var		Up_RUp 			As AddressOf _Picture := Nothing
	Protected Var		Up_LDown 		As AddressOf _Picture := Nothing
	Protected Var		Up_RDown 		As AddressOf _Picture := Nothing
	Protected Var		Up_LineDown 	As AddressOf _Picture := Nothing
	Protected Var		Up_LineUp 		As AddressOf _Picture := Nothing
	Protected Var		Up_LineRight 	As AddressOf _Picture := Nothing
	Protected Var		Up_LineLeft 	As AddressOf _Picture := Nothing
	
	Protected Var		Down_Centre	 	As AddressOf _Picture := Nothing
	Protected Var		Down_LUp		As AddressOf _Picture := Nothing
	Protected Var		Down_RUp		As AddressOf _Picture := Nothing
	Protected Var		Down_LDown		As AddressOf _Picture := Nothing
	Protected Var		Down_RDown 		As AddressOf _Picture := Nothing
	Protected Var		Down_LineDown 	As AddressOf _Picture := Nothing
	Protected Var		Down_LineUp		As AddressOf _Picture := Nothing
	Protected Var		Down_LineRight 	As AddressOf _Picture := Nothing
	Protected Var		Down_LineLeft	As AddressOf _Picture := Nothing

	Protected Var		Centre 			As AddressOf _Picture := Nothing
	Protected Var		LUp   			As AddressOf _Picture := Nothing 		
	Protected Var		RUp 			As AddressOf _Picture := Nothing 	 	
	Protected Var		LDown  	 		As AddressOf _Picture := Nothing		
	Protected Var		RDown 	 		As AddressOf _Picture := Nothing		
	Protected Var		LineDown 		As AddressOf _Picture := Nothing	
	Protected Var		LineUp  		As AddressOf _Picture := Nothing 		
	Protected Var		LineRight  		As AddressOf _Picture := Nothing	
	Protected Var		LineLeft 		As AddressOf _Picture := Nothing	


	Protected Function InitObject()
		Picture_Active_Up_Centre			:= Nothing
		Picture_Active_Up_LUp 				:= picButton_LeftUp_Corner
		Picture_Active_Up_RUp 				:= picButton_RightUp_Corner
		Picture_Active_Up_LDown 			:= picButton_LeftDown_Corner
		Picture_Active_Up_RDown 			:= picButton_RightDown_Corner
		Picture_Active_Up_LineDown 			:= picButton_Down_Line
		Picture_Active_Up_LineUp 			:= picButton_Up_Line
		Picture_Active_Up_LineRight 		:= picButton_Right_Line
		Picture_Active_Up_LineLeft 			:= picButton_Left_Line
	
		Picture_Active_Down_LUp				:= picButton_LeftUp_Corner
		Picture_Active_Down_RUp				:= picButton_RightUp_Corner
		Picture_Active_Down_LDown			:= picButton_LeftDown_Corner
		Picture_Active_Down_RDown 			:= picButton_RightDown_Corner
		Picture_Active_Down_LineDown 		:= picButton_Down_Line
		Picture_Active_Down_LineUp			:= picButton_Up_Line
		Picture_Active_Down_LineRight 		:= picButton_Right_Line
		Picture_Active_Down_LineLeft		:= picButton_Left_Line
		
		Picture_Active_Up_Centre2			:= Nothing		
		Picture_Active_Up_LUp2 				:= picButton_LeftUp_Corner1
		Picture_Active_Up_RUp2 				:= picButton_RightUp_Corner1
		Picture_Active_Up_LDown2 			:= picButton_LeftDown_Corner1
		Picture_Active_Up_RDown2 			:= picButton_RightDown_Corner1
		Picture_Active_Up_LineDown2 		:= picButton_Down_Line1
		Picture_Active_Up_LineUp2 			:= picButton_Up_Line1
		Picture_Active_Up_LineRight2 		:= picButton_Right_Line1
		Picture_Active_Up_LineLeft2 		:= picButton_Left_Line1
	
		Picture_Active_Down_LUp2			:= picButton_LeftUp_Corner1
		Picture_Active_Down_RUp2			:= picButton_RightUp_Corner1
		Picture_Active_Down_LDown2			:= picButton_LeftDown_Corner1
		Picture_Active_Down_RDown2 			:= picButton_RightDown_Corner1
		Picture_Active_Down_LineDown2 		:= picButton_Down_Line1
		Picture_Active_Down_LineUp2			:= picButton_Up_Line1
		Picture_Active_Down_LineRight2 		:= picButton_Right_Line1
		Picture_Active_Down_LineLeft2		:= picButton_Left_Line1	
		
		Picture_Active_Up_Centre3			:= picButton_Centre3
		Picture_Active_Up_LUp3 				:= picButton_LeftUp_Corner3
		Picture_Active_Up_RUp3 				:= picButton_RightUp_Corner3
		Picture_Active_Up_LDown3 			:= picButton_LeftDown_Corner3
		Picture_Active_Up_RDown3 			:= picButton_RightDown_Corner3
		Picture_Active_Up_LineDown3 		:= picButton_Down_Line3
		Picture_Active_Up_LineUp3 			:= picButton_Up_Line3
		Picture_Active_Up_LineRight3 		:= picButton_Right_Line3
		Picture_Active_Up_LineLeft3 		:= picButton_Left_Line3

		Picture_Active_Down_Centre3			:= picButton_Centre_down3	
		Picture_Active_Down_LUp3			:= picButton_LeftUp_Corner_down3
		Picture_Active_Down_RUp3			:= picButton_RightUp_Corner_down3
		Picture_Active_Down_LDown3			:= picButton_LeftDown_Corner_down3
		Picture_Active_Down_RDown3 			:= picButton_RightDown_Corner_down3
		Picture_Active_Down_LineDown3 		:= picButton_Down_Line_down3
		Picture_Active_Down_LineUp3			:= picButton_Up_Line_down3
		Picture_Active_Down_LineRight3 		:= picButton_Right_Line_down3
		Picture_Active_Down_LineLeft3		:= picButton_Left_Line_down3
		
		Picture_Active_Color_Centre3		:= picButton_Centre_color3
		Picture_Active_Color_LUp3			:= picButton_LeftUp_Corner_color3
		Picture_Active_Color_RUp3			:= picButton_RightUp_Corner_color3
		Picture_Active_Color_LDown3			:= picButton_LeftDown_Corner_color3
		Picture_Active_Color_RDown3 		:= picButton_RightDown_Corner_color3
		Picture_Active_Color_LineDown3 		:= picButton_Down_Line_color3
		Picture_Active_Color_LineUp3		:= picButton_Up_Line_color3
		Picture_Active_Color_LineRight3 	:= picButton_Right_Line_color3
		Picture_Active_Color_LineLeft3		:= picButton_Left_Line_color3
		
		Picture_Active_Up_Centre4			:= picButton_Centre2
		Picture_Active_Up_LUp4 				:= picButton_LeftUp_Corner2
		Picture_Active_Up_RUp4 				:= picButton_RightUp_Corner2
		Picture_Active_Up_LDown4 			:= picButton_LeftDown_Corner2
		Picture_Active_Up_RDown4 			:= picButton_RightDown_Corner2
		Picture_Active_Up_LineDown4 		:= picButton_Down_Line2
		Picture_Active_Up_LineUp4 			:= picButton_Up_Line2
		Picture_Active_Up_LineRight4 		:= picButton_Right_Line2
		Picture_Active_Up_LineLeft4 		:= picButton_Left_Line2

		Picture_Active_Down_Centre4			:= picButton_Centre_down2	
		Picture_Active_Down_LUp4			:= picButton_LeftUp_Corner_down2
		Picture_Active_Down_RUp4			:= picButton_RightUp_Corner_down2
		Picture_Active_Down_LDown4			:= picButton_LeftDown_Corner_down2
		Picture_Active_Down_RDown4 			:= picButton_RightDown_Corner_down2
		Picture_Active_Down_LineDown4 		:= picButton_Down_Line_down2
		Picture_Active_Down_LineUp4			:= picButton_Up_Line_down2
		Picture_Active_Down_LineRight4 		:= picButton_Right_Line_down2
		Picture_Active_Down_LineLeft4		:= picButton_Left_Line_down2
		
		Picture_Active_Color_Centre4		:= picButton_Centre_color2
		Picture_Active_Color_LUp4			:= picButton_LeftUp_Corner_color2
		Picture_Active_Color_RUp4			:= picButton_RightUp_Corner_color2
		Picture_Active_Color_LDown4			:= picButton_LeftDown_Corner_color2
		Picture_Active_Color_RDown4 		:= picButton_RightDown_Corner_color2
		Picture_Active_Color_LineDown4 		:= picButton_Down_Line_color2
		Picture_Active_Color_LineUp4		:= picButton_Up_Line_color2
		Picture_Active_Color_LineRight4 	:= picButton_Right_Line_color2
		Picture_Active_Color_LineLeft4		:= picButton_Left_Line_color2	
	End Function

	Protected Function Init()
		GetProperty()
		InitObject()
		SetComponentColorUp(UpColor)
		SetComponentColorDown(DownColor)
		IsPressed := DefaultState
		SelButtonPic(GetPrimaryDisplay().GetWidth(),GetPrimaryDisplay().GetHeight(),ButtonCorner)
		UpFormatFlags := MUpTextAlign BitOr _TEXT_WORDWRAP
		DownFormatFlags := MDownTextAlign BitOr _TEXT_WORDWRAP
		UpdateDimensions()
		UpdateDrawColors()
		If ButtonCorner = BUTTON_STYLE_ROUNDED_CORNER Then
			DownOffset := 1
		Else
			DownOffset := 0
		End If
		RedrawCompoundObject()
	End Function
	
	Protected Function ColorUp()As Long
		If ButtonCorner = BUTTON_STYLE_ROUNDED_CORNER Then
			Return Value COLOR_ORANGE
		Else
			Return Value COLOR_GREYDARK
		End If
	End Function
	
	Protected Function ColorDown()As Long
		If ButtonCorner = BUTTON_STYLE_ROUNDED_CORNER Then
			Return Value COLOR_ORANGE
		Else
			Return Value COLOR_WHITE
		End If
	End Function
	
	Protected Function FontColorUp() As Long
		If ButtonCorner = BUTTON_STYLE_ROUNDED_CORNER Then
			Return Value _COLOR_BLACK
		Else
			Return Value _COLOR_WHITE
		End If	
	End Function
		
	Protected Function GetProperty()
	// Předání hodnot proměnným v bázové třídě
		MDefaultState			:= DefaultState	
		MEnabled				:= Enabled
		MUpFont					:= UpFont
		MUpFontColor			:= UpFontColor
		MUpIcon					:= UpIcon
		MUpIconAlign			:= UpIconAlign
		MUpIconOffsetX			:= UpIconOffsetX
		MUpIconOffsetY			:= UpIconOffsetY
		MUpLineSpacing			:= UpLineSpacing
		MUpText					:= UpText
		MUpTextAlign			:= UpTextAlign
		MUpTextOffsetX			:= UpTextOffsetX
		MUpTextOffsetY			:= UpTextOffsetY
		MDownFont				:= DownFont
		MDownFontColor			:= DownFontColor
		MDownIcon				:= DownIcon
		MDownIconAlign			:= DownIconAlign
		MDownIconOffsetX		:= DownIconOffsetX
		MDownIconOffsetY		:= DownIconOffsetY
		MDownLineSpacing		:= DownLineSpacing
		MDownText				:= DownText
		MDownTextAlign			:= DownTextAlign
		MDownTextOffsetX		:= DownTextOffsetX
		MDownTextOffsetY		:= DownTextOffsetY
	End Function
	
	Protected Function GetButtonFont(DisplayWidth As Long,DisplayHeight As Long) As AddressOf _Font
//	 přednastavený font podle rozlišení
		If DisplayWidth >= 1500 And DisplayHeight >= 900 Then
			Return Value fntSegoeUI50
		Else
			Return Value fntSegoeUI23 
		End If
	End Function
	
	Protected Function SelButtonPic(DisplayWidth As Long,DisplayHeight As Long, Corner As Long)
	// výběr vhodné velikosti obrázku tlačítka podle rozlišení
		Var i As Long := 1
		
		If Corner = BUTTON_STYLE_ROUNDED_CORNER Then
			If DisplayWidth >= 1500 And DisplayHeight >= 900 Then
				Up_Centre 		:= Picture_Active_Up_Centre4
				Up_LUp   	 	:= Picture_Active_Up_LUp4	
				Up_RUp 	 	 	:= Picture_Active_Up_RUp4	
				Up_LDown  	 	:= Picture_Active_Up_LDown4	
				Up_RDown 	 	:= Picture_Active_Up_RDown4		
				Up_LineDown 	:= Picture_Active_Up_LineDown4	
				Up_LineUp  	 	:= Picture_Active_Up_LineUp4	
				Up_LineRight  	:= Picture_Active_Up_LineRight4
				Up_LineLeft 	:= Picture_Active_Up_LineLeft4	
				
				Down_Centre	 	:= Picture_Active_Down_Centre4 
				Down_LUp 	 	:= Picture_Active_Down_LUp4	
				Down_RUp 	 	:= Picture_Active_Down_RUp4
				Down_LDown 	 	:= Picture_Active_Down_LDown4
				Down_RDown 	 	:= Picture_Active_Down_RDown4
				Down_LineDown 	:= Picture_Active_Down_LineDown4
				Down_LineUp 	:= Picture_Active_Down_LineUp4
				Down_LineRight 	:= Picture_Active_Down_LineRight4
				Down_LineLeft 	:= Picture_Active_Down_LineLeft4
				
				Centre 			:= Picture_Active_Color_Centre4
				LUp   	 		:= Picture_Active_Color_LUp4	
				RUp 	 	 	:= Picture_Active_Color_RUp4	
				LDown  	 		:= Picture_Active_Color_LDown4	
				RDown 	 		:= Picture_Active_Color_RDown4		
				LineDown 		:= Picture_Active_Color_LineDown4	
				LineUp  	 	:= Picture_Active_Color_LineUp4	
				LineRight  		:= Picture_Active_Color_LineRight4
				LineLeft 		:= Picture_Active_Color_LineLeft4						
			Else
				Up_Centre 		:= Picture_Active_Up_Centre3
				Up_LUp   	 	:= Picture_Active_Up_LUp3	
				Up_RUp 	 	 	:= Picture_Active_Up_RUp3	
				Up_LDown  	 	:= Picture_Active_Up_LDown3	
				Up_RDown 	 	:= Picture_Active_Up_RDown3		
				Up_LineDown 	:= Picture_Active_Up_LineDown3	
				Up_LineUp  	 	:= Picture_Active_Up_LineUp3	
				Up_LineRight  	:= Picture_Active_Up_LineRight3
				Up_LineLeft 	:= Picture_Active_Up_LineLeft3	
				
				Down_Centre	 	:= Picture_Active_Down_Centre3 
				Down_LUp 	 	:= Picture_Active_Down_LUp3	
				Down_RUp 	 	:= Picture_Active_Down_RUp3
				Down_LDown 	 	:= Picture_Active_Down_LDown3
				Down_RDown 	 	:= Picture_Active_Down_RDown3
				Down_LineDown 	:= Picture_Active_Down_LineDown3
				Down_LineUp 	:= Picture_Active_Down_LineUp3
				Down_LineRight 	:= Picture_Active_Down_LineRight3
				Down_LineLeft 	:= Picture_Active_Down_LineLeft3
				
				Centre 			:= Picture_Active_Color_Centre3
				LUp   	 		:= Picture_Active_Color_LUp3	
				RUp 	 	 	:= Picture_Active_Color_RUp3	
				LDown  	 		:= Picture_Active_Color_LDown3	
				RDown 	 		:= Picture_Active_Color_RDown3		
				LineDown 		:= Picture_Active_Color_LineDown3	
				LineUp  	 	:= Picture_Active_Color_LineUp3	
				LineRight  		:= Picture_Active_Color_LineRight3
				LineLeft 		:= Picture_Active_Color_LineLeft3
			End If
		
		Else

			If DisplayWidth >= 1500 And DisplayHeight >= 900 Then
				RectangleEdge	:= 3
				Up_Centre 		:= Picture_Active_Up_Centre2
				Up_LUp   	 	:= Picture_Active_Up_LUp2	
				Up_RUp 	 	 	:= Picture_Active_Up_RUp2	
				Up_LDown  	 	:= Picture_Active_Up_LDown2	
				Up_RDown 	 	:= Picture_Active_Up_RDown2		
				Up_LineDown 	:= Picture_Active_Up_LineDown2	
				Up_LineUp  	 	:= Picture_Active_Up_LineUp2	
				Up_LineRight  	:= Picture_Active_Up_LineRight2
				Up_LineLeft 	:= Picture_Active_Up_LineLeft2	
				
				Down_Centre	 	:= Picture_Active_Down_Centre2 
				Down_LUp 	 	:= Picture_Active_Down_LUp2	
				Down_RUp 	 	:= Picture_Active_Down_RUp2
				Down_LDown 	 	:= Picture_Active_Down_LDown2
				Down_RDown 	 	:= Picture_Active_Down_RDown2
				Down_LineDown 	:= Picture_Active_Down_LineDown2
				Down_LineUp 	:= Picture_Active_Down_LineUp2
				Down_LineRight 	:= Picture_Active_Down_LineRight2
				Down_LineLeft 	:= Picture_Active_Down_LineLeft2
				
			Else
				RectangleEdge	:= 2
				Up_Centre 		:= Picture_Active_Up_Centre
				Up_LUp   	 	:= Picture_Active_Up_LUp	
				Up_RUp 	 	 	:= Picture_Active_Up_RUp	
				Up_LDown  	 	:= Picture_Active_Up_LDown	
				Up_RDown 	 	:= Picture_Active_Up_RDown		
				Up_LineDown 	:= Picture_Active_Up_LineDown	
				Up_LineUp  	 	:= Picture_Active_Up_LineUp	
				Up_LineRight  	:= Picture_Active_Up_LineRight
				Up_LineLeft 	:= Picture_Active_Up_LineLeft	
				
				Down_Centre	 	:= Picture_Active_Down_Centre 
				Down_LUp 	 	:= Picture_Active_Down_LUp	
				Down_RUp 	 	:= Picture_Active_Down_RUp
				Down_LDown 	 	:= Picture_Active_Down_LDown
				Down_RDown 	 	:= Picture_Active_Down_RDown
				Down_LineDown 	:= Picture_Active_Down_LineDown
				Down_LineUp 	:= Picture_Active_Down_LineUp
				Down_LineRight 	:= Picture_Active_Down_LineRight
				Down_LineLeft 	:= Picture_Active_Down_LineLeft	
						
			End If
		End If
	End Function
	
	Protected Function SetComponentColorUp(Upcolor As Long)
		UpColorOpacity := GetColorComponentOpacity(Upcolor)	
		UpButtonColor := SetColorComponentOpacity(Upcolor,255)
	End Function
	
	Protected Function SetComponentColorDown(downColor As Long)
		DownColorOpacity := GetColorComponentOpacity(downColor)	
		DownButtonColor := SetColorComponentOpacity(downColor,255)
	End Function
			
	Protected Function RedrawCompoundObject()
	
		LockRedraw()
	
		If IsPressed Then
			PictureLayer1.Hide()
			PictureLayer2.Hide()
			Redraw()
	
			PictureLayer3.SetPicture(MDownIcon)
			PictureLayer3.SetOpacity(DrawOpacity)
			PictureLayer3.SetFitting(FITTING_FIT_OBJECT_TO_CONTENT)
			PictureLayer3.SetObjectPosition(DownIconX + DownOffset, DownIconY + DownOffset)
	
			TextLayer.SetFont(MDownFont)
			TextLayer.SetText(MDownText)
			TextLayer.SetColor(DownDrawFontColor)
			TextLayer.SetAlign(DownFormatFlags)
			TextLayer.SetTextOffsetX(MDownTextOffsetX+ DownOffset)
			TextLayer.SetTextOffsetY(MDownTextOffsetY+ DownOffset)
			TextLayer.SetLineSpacing(MDownLineSpacing)
			TextLayer.SetObjectPosition(0, 0)
			TextLayer.SetObjectDimensions(ObjectWidth, ObjectHeight)
			
		Else
			PictureLayer1.Hide()
			PictureLayer2.Hide()
			Redraw()
			
			PictureLayer3.SetPicture(MUpIcon)
			PictureLayer3.SetOpacity(DrawOpacity)
			PictureLayer3.SetFitting(FITTING_FIT_OBJECT_TO_CONTENT)
			PictureLayer3.SetObjectPosition(UpIconX , UpIconY )
			
			TextLayer.SetFont(MUpFont)
			TextLayer.SetText(MUpText)
			TextLayer.SetColor(UpDrawFontColor)
			TextLayer.SetAlign(UpFormatFlags)
			TextLayer.SetTextOffsetX(MUpTextOffsetX)
			TextLayer.SetTextOffsetY(MUpTextOffsetY)
			TextLayer.SetLineSpacing(MUpLineSpacing)
			TextLayer.SetObjectPosition(0, 0)
			TextLayer.SetObjectDimensions(ObjectWidth, ObjectHeight)
		End If

		UnlockRedraw()
	
	End Function
	
	Private Function Draw3DButton(state As Boolean)
		Var Width As Long
		Var Height As Long

		Me.GetSize(Width,Height)
		If ButtonCorner = BUTTON_STYLE_ROUNDED_CORNER Then
			If 	state Then
				DrawStretchedTintedPicture(LineUp,DownButtonColor,Down_RUp.GetWidth(),0,Width-2*Down_RUp.GetWidth(),Down_RUp.GetHeight(),0,0,-1,-1,DownColorOpacity)
				DrawStretchedTintedPicture(LineRight,DownButtonColor,Width-Down_RUp.GetWidth(),Down_RUp.GetHeight(),Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight(),0,0,-1,-1,DownColorOpacity)
				DrawStretchedTintedPicture(LineDown,DownButtonColor,Down_RUp.GetWidth(),Height-Down_RUp.GetHeight(),Width-2*Down_RUp.GetWidth(),Down_RUp.GetHeight(),0,0,-1,-1,DownColorOpacity)
				DrawStretchedTintedPicture(LineLeft,DownButtonColor,0,Down_RUp.GetHeight(),Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight(),0,0,-1,-1,DownColorOpacity)			
				DrawStretchedTintedPicture(Centre,DownButtonColor,Down_RUp.GetWidth(),Down_RUp.GetHeight(),Width-2*Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight(),0,0,-1,-1,DownColorOpacity)

				DrawTintedPicture(LUp,DownButtonColor,0,0,-1,-1,0,0,DownColorOpacity)
				DrawTintedPicture(RUp,DownButtonColor,Width-Down_RUp.GetWidth(),0,-1,-1,0,0,DownColorOpacity)
				DrawTintedPicture(LDown,DownButtonColor,0,Height-Down_RUp.GetHeight(),-1,-1,0,0,DownColorOpacity)
				DrawTintedPicture(RDown,DownButtonColor,Width-Down_RUp.GetWidth(),Height-Down_RUp.GetHeight(),-1,-1,0,0,DownColorOpacity)	
			Else
				DrawStretchedTintedPicture(LineUp,UpButtonColor,Down_RUp.GetWidth(),0,Width-2*Down_RUp.GetWidth(),Down_RUp.GetHeight(),0,0,-1,-1,UpColorOpacity)
				DrawStretchedTintedPicture(LineRight,UpButtonColor,Width-Down_RUp.GetWidth(),Down_RUp.GetHeight(),Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight(),0,0,-1,-1,UpColorOpacity)
				DrawStretchedTintedPicture(LineDown,UpButtonColor,Down_RUp.GetWidth(),Height-Down_RUp.GetHeight(),Width-2*Down_RUp.GetWidth(),Down_RUp.GetHeight(),0,0,-1,-1,UpColorOpacity)
				DrawStretchedTintedPicture(LineLeft,UpButtonColor,0,Down_RUp.GetHeight(),Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight(),0,0,-1,-1,UpColorOpacity)			
				DrawStretchedTintedPicture(Centre,UpButtonColor,Down_RUp.GetWidth(),Down_RUp.GetHeight(),Width-2*Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight(),0,0,-1,-1,UpColorOpacity)
			
				DrawTintedPicture(LUp,UpButtonColor,0,0,-1,-1,0,0,UpColorOpacity)
				DrawTintedPicture(RUp,UpButtonColor,Width-Down_RUp.GetWidth(),0,-1,-1,0,0,UpColorOpacity)
				DrawTintedPicture(LDown,UpButtonColor,0,Height-Down_RUp.GetHeight(),-1,-1,0,0,UpColorOpacity)
				DrawTintedPicture(RDown,UpButtonColor,Width-Down_RUp.GetWidth(),Height-Down_RUp.GetHeight(),-1,-1,0,0,UpColorOpacity)
			End If	
		Else	
			If 	state Then
				DrawRectangle(DownColor,RectangleEdge,RectangleEdge,Width-2*RectangleEdge,Height-2*RectangleEdge)
			Else
				DrawRectangle(UpColor,RectangleEdge,RectangleEdge,Width-2*RectangleEdge,Height-2*RectangleEdge)
			End If
		End If
		
			If 	state Then
				DrawStretchedPicture(Down_LineUp,Down_RUp.GetWidth(),0,Width-2*Down_RUp.GetWidth(),Down_RUp.GetHeight())
				DrawStretchedPicture(Down_LineRight,Width-Down_RUp.GetWidth(),Down_RUp.GetHeight(),Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight())
				DrawStretchedPicture(Down_LineDown,Down_RUp.GetWidth(),Height-Down_RUp.GetHeight(),Width-2*Down_RUp.GetWidth(),Down_RUp.GetHeight())
				DrawStretchedPicture(Down_LineLeft,0,Down_RUp.GetHeight(),Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight())			
				DrawStretchedPicture(Down_Centre,Down_RUp.GetWidth(),Down_RUp.GetHeight(),Width-2*Down_RUp.GetWidth(),Height-2*Down_RUp.GetHeight())
			
				DrawPicture(Down_LUp,0,0)
				DrawPicture(Down_RUp,Width-Down_RUp.GetWidth(),0)
				DrawPicture(Down_LDown,0,Height-Down_RUp.GetHeight())
				DrawPicture(Down_RDown,Width-Down_RUp.GetWidth(),Height-Down_RUp.GetHeight())			
			Else						
				DrawStretchedPicture(Up_LineUp,Up_RUp.GetWidth(),0,Width-2*Up_RUp.GetWidth(),Up_RUp.GetHeight())
				DrawStretchedPicture(Up_LineRight,Width-Up_RUp.GetWidth(),Up_RUp.GetHeight(),Up_RUp.GetWidth(),Height-2*Up_RUp.GetHeight())
				DrawStretchedPicture(Up_LineDown,Up_RUp.GetWidth(),Height-Up_RUp.GetHeight(),Width-2*Up_RUp.GetWidth(),Up_RUp.GetHeight())
				DrawStretchedPicture(Up_LineLeft,0,Up_RUp.GetHeight(),Up_RUp.GetWidth(),Height-2*Up_RUp.GetHeight())
				DrawStretchedPicture(Up_Centre,Up_RUp.GetWidth(),Up_RUp.GetHeight(),Width-2*Up_RUp.GetWidth(),Height-2*Up_RUp.GetHeight())
			
				DrawPicture(Up_LUp,0,0)
				DrawPicture(Up_RUp,Width-Up_RUp.GetWidth(),0)
				DrawPicture(Up_LDown,0,Height-Up_RUp.GetHeight())
				DrawPicture(Up_RDown,Width-Up_RUp.GetWidth(),Height-Up_RUp.GetHeight())
			End If
		
	End Function
		
	Public Function SetButtonStyle(newbuttonstyle As Long) As Boolean
		If newbuttonstyle  = BUTTON_STYLE_ROUNDED_CORNER Then
			DownOffset := 1
		Else
			DownOffset := 0
		End If
		ButtonCorner := newbuttonstyle
		SelButtonPic(GetPrimaryDisplay().GetWidth(),GetPrimaryDisplay().GetHeight(),ButtonCorner)
		UpdateDimensions()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetButtonStyle() As Long
		Return Value ButtonCorner
	End Function
	
//colors button
	Public Function SetDownColor(newdowncolor As Long) As Boolean
		DownColor := newdowncolor
		SetComponentColorDown(newdowncolor)
		RedrawCompoundObject()
		Return Value True
	End Function
	
	Public Function SetUpColor(newupcolor As Long) As Boolean
		UpColor := newupcolor
		SetComponentColorUp(newupcolor)
		RedrawCompoundObject()
		Return Value True	
	End Function
		
	Public Function GetDownColor() As Long
		Return Value DownColor
	End Function
	
	Public Function GetUpColor() As Long
		Return Value UpColor
	End Function
	
// text
//up
	Public Function SetUpFont(newupfont As AddressOf _Font) As Boolean
		MUpFont := newupfont
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpFont() As AddressOf _Font
		Return Value MUpFont	
	End Function
		
	Public Function SetUpFontColor(newupfontcolor As Long) As Boolean
		MUpFontColor := newupfontcolor
		UpdateDrawColors()
		RedrawCompoundObject()
		Return Value True	
	End Function
		
	Public Function GetUpFontColor() As Long
		Return Value MUpFontColor
	End Function

	Public Function SetUpLineSpacing(newuplinespacing As Double) As Boolean	
		If newuplinespacing >= 0 Then
			MUpLineSpacing := newuplinespacing
			RedrawCompoundObject()
			Return Value True
		Else
			Return Value False
		End If
	End Function
	
	Public Function GetUpLineSpacing() As Double
		Return Value MUpLineSpacing	
	End Function
	
	Public Function SetUpText(newuptext As Text) As Boolean
		If GetMemorySegment(newuptext) = _MSEG_RESOURCEDATA Then
			MUpText := newuptext
		Else
			TextBuffer := newuptext
			MUpText := TextBuffer
		End If
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpText() As AddressOf Text
		Return Value MUpText	
	End Function
	
	Public Function SetUpTextAlign(newuptextalign As Long) As Boolean
		Select newuptextalign
			Case _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNTOP, _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNVCENTER, _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNBOTTOM, _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNTOP, _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNVCENTER, _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNBOTTOM, _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNTOP, _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNVCENTER, _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNBOTTOM
				MUpTextAlign := newuptextalign
				UpFormatFlags := MUpTextAlign BitOr _TEXT_WORDWRAP
				RedrawCompoundObject()
				Return Value True
	
			Case Else
				Return Value False
		End Select
	End Function
	
	Public Function GetUpTextAlign() As Long
		Return Value MUpTextAlign
	End Function
	
	Public Function SetUpTextOffsetX(newuptextoffsetx As Long) As Boolean	
		MUpTextOffsetX := newuptextoffsetx 
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpTextOffsetX() As Long
		Return Value MUpTextOffsetX	
	End Function
	
	Public Function SetUpTextOffsetY(newuptextoffsety As Long) As Boolean
		MUpTextOffsetY := newuptextoffsety 
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpTextOffsetY() As Long
		Return Value MUpTextOffsetY	
	End Function
//down	
	Public Function SetDownFont(newdownfont As AddressOf _Font) As Boolean
		MDownFont := newdownfont
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownFont() As AddressOf _Font
		Return Value MDownFont	
	End Function
		
	Public Function SetDownFontColor(newdownfontcolor As Long) As Boolean
		MDownFontColor := newdownfontcolor
		UpdateDrawColors()
		RedrawCompoundObject()
		Return Value True	
	End Function
		
	Public Function GetDownFontColor() As Long
		Return Value MDownFontColor
	End Function

	Public Function SetDownLineSpacing(newdownlinespacing As Double) As Boolean	
		If newdownlinespacing >= 0 Then
			MDownLineSpacing := newdownlinespacing
			RedrawCompoundObject()
			Return Value True
		Else
			Return Value False
		End If
	End Function
	
	Public Function GetDownLineSpacing() As Double
		Return Value MDownLineSpacing	
	End Function
	
	Public Function SetDownText(newdowntext As Text) As Boolean
		If GetMemorySegment(newdowntext) = _MSEG_RESOURCEDATA Then
			MDownText := newdowntext
		Else
			TextBuffer := newdowntext
			MDownText := TextBuffer
		End If
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownText() As AddressOf Text
		Return Value MDownText	
	End Function
	
	Public Function SetDownTextAlign(newdowntextalign As Long) As Boolean
		Select newdowntextalign
			Case _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNTOP, _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNVCENTER, _TEXT_ALIGNLEFT BitOr _TEXT_ALIGNBOTTOM, _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNTOP, _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNVCENTER, _TEXT_ALIGNHCENTER BitOr _TEXT_ALIGNBOTTOM, _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNTOP, _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNVCENTER, _TEXT_ALIGNRIGHT BitOr _TEXT_ALIGNBOTTOM
				MDownTextAlign := newdowntextalign
				DownFormatFlags := MDownTextAlign BitOr _TEXT_WORDWRAP
				RedrawCompoundObject()
				Return Value True
	
			Case Else
				Return Value False
		End Select
	End Function
	
	Public Function GetDownTextAlign() As Long
		Return Value MDownTextAlign
	End Function
	
	Public Function SetDownTextOffsetX(newdowntextoffsetx As Long) As Boolean	
		MDownTextOffsetX := newdowntextoffsetx 
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownTextOffsetX() As Long
		Return Value MDownTextOffsetX	
	End Function
	
	Public Function SetDownTextOffsetY(newdowntextoffsety As Long) As Boolean
		MDownTextOffsetY := newdowntextoffsety 
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownTextOffsetY() As Long
		Return Value MDownTextOffsetY	
	End Function
// icon
// up 
	Public Function SetUpIcon(newupicon As AddressOf _Picture) As Boolean
		MUpIcon := newupicon
		UpdateIconPosition()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpIcon() As AddressOf _Picture
		Return Value MUpIcon	
	End Function
	
	Public Function SetUpIconAlign(newupiconalign As Long) As Boolean
		Select newupiconalign
			Case ICON_ALIGNLEFT BitOr ICON_ALIGNTOP, ICON_ALIGNLEFT BitOr ICON_ALIGNVCENTER, ICON_ALIGNLEFT BitOr ICON_ALIGNBOTTOM, ICON_ALIGNHCENTER BitOr ICON_ALIGNTOP, ICON_ALIGNHCENTER BitOr ICON_ALIGNVCENTER, ICON_ALIGNHCENTER BitOr ICON_ALIGNBOTTOM, ICON_ALIGNRIGHT BitOr ICON_ALIGNTOP, ICON_ALIGNRIGHT BitOr ICON_ALIGNVCENTER, ICON_ALIGNRIGHT BitOr ICON_ALIGNBOTTOM
				MUpIconAlign := newupiconalign
				UpdateIconPosition()
				RedrawCompoundObject()
				Return Value True
	
			Case Else
				Return Value False
		End Select
	End Function
	
	Public Function GetUpIconAlign() As Long
		Return Value MUpIconAlign
	End Function
	
	Public Function SetUpIconOffsetX(newupiconoffsetx As Long) As Boolean	
		MUpIconOffsetX := newupiconoffsetx 
		UpdateIconPosition()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpIconOffsetX() As Long
		Return Value MUpIconOffsetX	
	End Function
	
	Public Function SetUpIconOffsetY(newupiconoffsety As Long) As Boolean	
		MUpIconOffsetY := newupiconoffsety 
		UpdateIconPosition()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetUpIconOffsetY() As Long
		Return Value MUpIconOffsetY	
	End Function
// down
	Public Function SetDownIcon(newdownicon As AddressOf _Picture) As Boolean
		MDownIcon := newdownicon
		UpdateIconPosition()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownIcon() As AddressOf _Picture
		Return Value MDownIcon	
	End Function
	
	Public Function SetDownIconAlign(newdowniconalign As Long) As Boolean
		Select newdowniconalign
			Case ICON_ALIGNLEFT BitOr ICON_ALIGNTOP, ICON_ALIGNLEFT BitOr ICON_ALIGNVCENTER, ICON_ALIGNLEFT BitOr ICON_ALIGNBOTTOM, ICON_ALIGNHCENTER BitOr ICON_ALIGNTOP, ICON_ALIGNHCENTER BitOr ICON_ALIGNVCENTER, ICON_ALIGNHCENTER BitOr ICON_ALIGNBOTTOM, ICON_ALIGNRIGHT BitOr ICON_ALIGNTOP, ICON_ALIGNRIGHT BitOr ICON_ALIGNVCENTER, ICON_ALIGNRIGHT BitOr ICON_ALIGNBOTTOM
				MDownIconAlign := newdowniconalign
				UpdateIconPosition()
				RedrawCompoundObject()
				Return Value True
	
			Case Else
				Return Value False
		End Select
	End Function
	
	Public Function GetDownIconAlign() As Long
		Return Value MDownIconAlign
	End Function
	
	Public Function SetDownIconOffsetX(newdowniconoffsetx As Long) As Boolean	
		MDownIconOffsetX := newdowniconoffsetx 
		UpdateIconPosition()
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownIconOffsetX() As Long
		Return Value MDownIconOffsetX	
	End Function
	
	Public Function SetDownIconOffsetY(newdowniconoffsety As Long) As Boolean	
		MDownIconOffsetY := newdowniconoffsety
		UpdateIconPosition() 
		RedrawCompoundObject()
		Return Value True	
	End Function
	
	Public Function GetDownIconOffsetY() As Long
		Return Value MDownIconOffsetY	
	End Function

	Public Function SetObjectDimensions(newwidth As Long, newheight As Long) As Boolean
		SetSize(newwidth, newheight)
		UpdateDimensions()
		RedrawCompoundObject()
		Return Value True
	End Function

	Public Function GetObjectDimensions(ByRef currentwidth As Long, ByRef currentheight As Long)
		GetSize(currentwidth, currentheight)
	End Function

	Public Function SetObjectPosition(newx As Long, newy As Long) As Boolean
		Var Response As Boolean
		Response := SetPosition(newx, newy)
		RedrawCompoundObject()
		Return Value Response
	End Function
	
	Public Function GetObjectPosition(ByRef currentx As Long, ByRef currenty As Long)
		GetPosition(currentx, currenty)
	End Function
	
End GraphicClass

